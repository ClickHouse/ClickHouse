0
1
6
7
-- IN --
0
1
6
7
-- MORE CASES --
-- { echoOn }

SELECT (1, 2) in [number % 3, number % 5] FROM numbers(2); -- { serverError NO_COMMON_TYPE }
SELECT (1, 2) in (SELECT [0, 0] UNION ALL SELECT [1, 1]); -- { serverError TYPE_MISMATCH }
SELECT (1, 2) in [(number % 3, number % 5)] FROM numbers(2);
0
0
SELECT (1, 2) in (SELECT (0, 0)), (1, 2) in (SELECT (1, 1));
0	0
SELECT (1, 1) in [(number % 3, number % 5)] FROM numbers(2);
0
1
SELECT (1, 1) in (SELECT (0, 0)), (1, 1) in (SELECT (1, 1));
0	1
SELECT (1, null) in [(number % 3, number % 5)] FROM numbers(2);
0
0
SELECT (1, null) in (SELECT (0, 0::Nullable(Int))), (1, null) in (SELECT (1, 1::Nullable(Int)));
0	0
SELECT (1, null) in [(number % 3, number % 5), (1, null)] FROM numbers(2);
1
1
SELECT (1, null) in (SELECT (0, 0::Nullable(Int)) UNION ALL SELECT (1, null)), (1, null) in (SELECT (1, 1::Nullable(Int)) UNION ALL SELECT (1, null));
1	1
SELECT 'ANOTHER SETTING';
ANOTHER SETTING
set transform_null_in = 1;
SELECT (1, 2) in [number % 3, number % 5] FROM numbers(2); -- { serverError NO_COMMON_TYPE }
SELECT (1, 2) in (SELECT [0, 0] UNION ALL SELECT [1, 1]); -- { serverError TYPE_MISMATCH }
SELECT (1, 2) in [(number % 3, number % 5)] FROM numbers(2);
0
0
SELECT (1, 2) in (SELECT (0, 0)), (1, 2) in (SELECT (1, 1));
0	0
SELECT (1, 1) in [(number % 3, number % 5)] FROM numbers(2);
0
1
SELECT (1, 1) in (SELECT (0, 0)), (1, 1) in (SELECT (1, 1));
0	1
SELECT (1, null) in [(number % 3, number % 5)] FROM numbers(2);
0
0
SELECT (1, null) in (SELECT (0, 0::Nullable(Int))), (1, null) in (SELECT (1, 1::Nullable(Int)));
0	0
SELECT (1, null) in [(number % 3, number % 5), (1, null)] FROM numbers(2);
1
1
SELECT (1, null) in (SELECT (0, 0::Nullable(Int)) UNION ALL SELECT (1, null)), (1, null) in (SELECT (1, 1::Nullable(Int)) UNION ALL SELECT (1, null));
1	1
--- with tuple rewritten into array
SELECT *
FROM numbers(1000)
WHERE number IN (123, 10 - number, 456);
5
123
456
-- Consistency of transform_null_in to non-const arguments
SELECT  
    NULL IN (1, number),  
    NULL IN (1, number, NULL),  
    NULL IN (1, 2),  
    NULL IN (1, NULL)  
FROM numbers(1)  
SETTINGS transform_null_in = 1;
0	1	1	1
SELECT  
    NULL IN (1, number),  
    NULL IN (1, number, NULL),  
    NULL IN (1, 2),  
    NULL IN (1, NULL)  
FROM numbers(1)  
SETTINGS transform_null_in = 0;
\N	\N	\N	\N
-- Consistency for arrays/tuples
SELECT toNullable(1) IN [1, number]  
FROM numbers(2);
1
1
SELECT toNullable(1) IN (1, number)  
FROM numbers(2);
1
1
-- Common type consistency
SELECT 'a' IN (5, number, 'a')  
FROM numbers(2);
1
1
