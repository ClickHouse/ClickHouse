-- { echoOn }

{% for flag in [1, 0] -%}

SET transform_null_in = {{ flag }};

SELECT CAST(NULL, 'Nullable(Int32)') IN [NULL, 1];

SELECT CAST(NULL, 'Nullable(Int32)') IN (NULL, 1);

SELECT CAST('a', 'String') IN [NULL, 'a'];

SELECT 2 IN (1, 2, 3);

SELECT CAST(tuple(), 'Tuple()') IN (tuple());

SELECT CAST((200, 3), 'Tuple(Int32, Int64)') IN [(200, 3), (200, 4)];

SELECT CAST((200, 3), 'Tuple(Int32, Int64)') IN ((200, 3), (200, 4));

SELECT CAST(tuple(tuple(10)), 'Tuple(Tuple(Int32))') IN (tuple(tuple(10)));

SELECT CAST('x', 'LowCardinality(String)') IN ['x', 'y'];

SELECT CAST(('x', 1), 'Tuple(LowCardinality(String), Int32)') IN [('x', 1), ('z', 2)];

SELECT CAST('a', 'Enum8(\'a\' = 1, \'b\' = 2)') IN ['a', 'c'];

-- Does not work for old analyzer
SELECT CAST(('a', 1), 'Tuple(Enum8(\'a\' = 1, \'b\' = 2), Int32)') IN [('a', 1), ('c', 1)] SETTINGS enable_analyzer = 1;

SELECT CAST((1, 2), 'Tuple(Int32, Int32)') IN [(1, 2, 3)];-- { serverError INCORRECT_ELEMENT_OF_SET }

SELECT CAST((1, 2), 'Tuple(Int32, Int32)') IN (1, 2);

SELECT (1, (1, NULL)) in (1, (1, NULL));

SELECT (1, (1, NULL)) in ((1, (1, NULL)));

SELECT (1, (1, 2)) in ((1, (1, NULL)), (1, (1, 2)));

SELECT 1 in '1';

SELECT 1 in ('1', '2');

SELECT 1234 IN ['1234'];

SELECT (1234, 32) IN ('1234', '32');

SELECT ('1234', '32') IN (1234, 32);

SELECT (1234, (32, 10)) IN ('1234', ('32', 10));

SELECT (1234, [32, 10]) IN ('1234', [32, 10]);

SELECT (1234, (32, (3, [3, 1]))) IN [('1234', ('32', (3, ['3', '1'])))];

SELECT toTypeName([('1234', ('32', (3, ['3', '1'])))]);

SELECT (1234, (32, (3, [3, 1]))) IN [('1234', ('32', (CAST(3, 'Nullable(Int)'), ['3', '1'])))];

SELECT (1234, (32, -10)) IN ('1234', (32, '-10'));

SELECT (1234, (32, -10)) IN ('1234', (32, -10.001));

SELECT 1 IN [[1, 2]];-- { serverError ILLEGAL_TYPE_OF_ARGUMENT }

select (1, 2) IN (((1, 2), 1), (1, 2));-- { serverError ILLEGAL_TYPE_OF_ARGUMENT }

select (1, 2) IN ((1, 2), (1, 2));

select (1, 2) IN ((1, 2), (1, 2), (1, 2, 3));-- { serverError INCORRECT_ELEMENT_OF_SET }

SELECT CAST((NULL, 3), 'Tuple(Nullable(Int32), Int32)') IN [(NULL, 3), (1, 3)];

SELECT NULL in NULL;

SELECT (NULL, NULL) in [(NULL, NULL)];

SELECT ((NULL, NULL), (NULL, NULL)) in [((NULL, NULL), (NULL, NULL))];

SELECT CAST(NULL, 'Nullable(Tuple(Int64))') IN [NULL];

SELECT CAST(NULL, 'Nullable(Tuple(Int64))') IN (NULL);

SELECT CAST(NULL, 'Nullable(Tuple(Int64))') IN NULL;

SELECT CAST(NULL, 'Nullable(Tuple(Int64))') IN (NULL, NULL);

SELECT CAST(NULL, 'Nullable(Tuple(Int64))') IN [NULL, NULL];

SELECT CAST(NULL, 'Nullable(Tuple())') IN [NULL];

SELECT CAST(NULL, 'Nullable(Tuple())') IN (NULL);

SELECT CAST(NULL, 'Nullable(Tuple())') IN NULL;

SELECT CAST(NULL, 'Nullable(Tuple())') IN (NULL, NULL);

SELECT CAST(NULL, 'Nullable(Tuple())') IN [NULL, NULL];

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN [NULL];

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN (NULL);

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN NULL;

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN (NULL, NULL);

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN [NULL, NULL];

SELECT (1, 2) IN [NULL, (1, 2)];

SELECT (1, 2) IN NULL;

SELECT (1, 2) IN (NULL, NULL, NULL);-- { serverError INCORRECT_ELEMENT_OF_SET }

SELECT (1, 2) IN (NULL, NULL, (1, 2));

SELECT 'a' IN (NULL, NULL, 'a');

SELECT 'a' IN [NULL, NULL, 'a'];

SELECT (1, 2) IN CAST((1, 2), 'Nullable(Tuple(Int64, Int64))');

SELECT (1, 2) IN CAST(NULL, 'Nullable(Tuple(Int64, Int64))');

SELECT (1, 2) IN CAST(NULL, 'Nullable(String)');

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN [NULL, (1, 2)];

SELECT CAST((1, 2), 'Nullable(Tuple(Int64, Int64))') IN [NULL, (1, 2)];

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN (NULL, (1, 2));

SELECT CAST((1, 2), 'Nullable(Tuple(Int64, Int64))') IN (NULL, (1, 2));

SELECT CAST((NULL, 3), 'Nullable(Tuple(Nullable(Int32), Int32))') IN [(NULL, 3), (1, 3), NULL];

SELECT CAST(NULL, 'Nullable(Tuple(Nullable(Int32), Int32))') IN [(NULL, 3), (1, 3), NULL];

SELECT CAST((NULL, 3), 'Nullable(Tuple(Nullable(Int32), Int32))') IN ((NULL, 3), (1, 3), NULL);

SELECT CAST(NULL, 'Nullable(Tuple(Nullable(Int32), Int32))') IN ((NULL, 3), (1, 3), NULL);

SELECT CAST((1, 3), 'Nullable(Tuple(Int32, Int32))') IN [(NULL, 3), (1, 3), NULL];

SELECT CAST(NULL, 'Nullable(Tuple(Int32, Int32))') IN [(NULL, 3), (1, 3), NULL];

SELECT CAST((1, 3), 'Nullable(Tuple(Int32, Int32))') IN ((NULL, 3), (1, 3), NULL);

SELECT CAST(NULL, 'Nullable(Tuple(Int32, Int32))') IN ((NULL, 3), (1, 3), NULL);

SELECT CAST(('a', 1), 'Nullable(Tuple(Enum8(\'a\' = 1, \'b\' = 2), Int32))') IN [('a', 1), ('c', 1), NULL] SETTINGS enable_analyzer = 1;

SELECT CAST(NULL, 'Nullable(Tuple(Enum8(\'a\' = 1, \'b\' = 2), Int32))') IN [('a', 1), ('c', 1), NULL] SETTINGS enable_analyzer = 1;

SELECT CAST(('a', 1), 'Nullable(Tuple(Enum8(\'a\' = 1, \'b\' = 2), Int32))') IN (('a', 1), ('c', 1), NULL) SETTINGS enable_analyzer = 1;

SELECT CAST(NULL, 'Nullable(Tuple(Enum8(\'a\' = 1, \'b\' = 2), Int32))') IN (('a', 1), ('c', 1), NULL) SETTINGS enable_analyzer = 1;

SELECT CAST((1, 2), 'Tuple(Int32, Int32)') IN [1, 2]; -- { serverError INCORRECT_ELEMENT_OF_SET }

SELECT (1, 2) IN (1, NULL);

SELECT (1, NULL) IN (1, NULL);

SELECT (1, 2) IN (NULL, NULL, (1, 2));

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN (NULL, NULL);

SELECT CAST(NULL, 'Nullable(Tuple(Int64, Int64))') IN (NULL, NULL, (1, 2));

SELECT (1, 2) IN 1; -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }

SELECT (1, 2) IN [1]; -- { serverError INCORRECT_ELEMENT_OF_SET }

SELECT (1, 2) IN (((1, 2), (1, 2)), ((1, 2), (1, 2))); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }

SELECT (1, 2) IN [((1, 2), (1, 2)), ((1, 2), (1, 2))]; -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }

{% endfor -%}
