==== partition IDs of partitioned_single_table should be usable for prefix filtering
100
0
1
10
11
12
13
14
15
16
17
18
19
2
20
21
22
23
24
25
26
27
28
29
3
30
31
32
33
34
35
36
37
38
39
4
40
41
42
43
44
45
46
47
48
49
5
50
51
52
53
54
55
56
57
58
59
6
60
61
62
63
64
65
66
67
68
69
7
70
71
72
73
74
75
76
77
78
79
8
80
81
82
83
84
85
86
87
88
89
9
90
91
92
93
94
95
96
97
98
99
==== partition IDs of partitioned_multi_table_date_uint should be usable for prefix filtering
300
20010101-0
20010101-1
20010101-10
20010101-11
20010101-12
20010101-13
20010101-14
20010101-15
20010101-16
20010101-17
20010101-18
20010101-19
20010101-2
20010101-20
20010101-21
20010101-22
20010101-23
20010101-24
20010101-25
20010101-26
20010101-27
20010101-28
20010101-29
20010101-3
20010101-30
20010101-31
20010101-32
20010101-33
20010101-34
20010101-35
20010101-36
20010101-37
20010101-38
20010101-39
20010101-4
20010101-40
20010101-41
20010101-42
20010101-43
20010101-44
20010101-45
20010101-46
20010101-47
20010101-48
20010101-49
20010101-5
20010101-50
20010101-51
20010101-52
20010101-53
20010101-54
20010101-55
20010101-56
20010101-57
20010101-58
20010101-59
20010101-6
20010101-60
20010101-61
20010101-62
20010101-63
20010101-64
20010101-65
20010101-66
20010101-67
20010101-68
20010101-69
20010101-7
20010101-70
20010101-71
20010101-72
20010101-73
20010101-74
20010101-75
20010101-76
20010101-77
20010101-78
20010101-79
20010101-8
20010101-80
20010101-81
20010101-82
20010101-83
20010101-84
20010101-85
20010101-86
20010101-87
20010101-88
20010101-89
20010101-9
20010101-90
20010101-91
20010101-92
20010101-93
20010101-94
20010101-95
20010101-96
20010101-97
20010101-98
20010101-99
20010102-0
20010102-1
20010102-10
20010102-11
20010102-12
20010102-13
20010102-14
20010102-15
20010102-16
20010102-17
20010102-18
20010102-19
20010102-2
20010102-20
20010102-21
20010102-22
20010102-23
20010102-24
20010102-25
20010102-26
20010102-27
20010102-28
20010102-29
20010102-3
20010102-30
20010102-31
20010102-32
20010102-33
20010102-34
20010102-35
20010102-36
20010102-37
20010102-38
20010102-39
20010102-4
20010102-40
20010102-41
20010102-42
20010102-43
20010102-44
20010102-45
20010102-46
20010102-47
20010102-48
20010102-49
20010102-5
20010102-50
20010102-51
20010102-52
20010102-53
20010102-54
20010102-55
20010102-56
20010102-57
20010102-58
20010102-59
20010102-6
20010102-60
20010102-61
20010102-62
20010102-63
20010102-64
20010102-65
20010102-66
20010102-67
20010102-68
20010102-69
20010102-7
20010102-70
20010102-71
20010102-72
20010102-73
20010102-74
20010102-75
20010102-76
20010102-77
20010102-78
20010102-79
20010102-8
20010102-80
20010102-81
20010102-82
20010102-83
20010102-84
20010102-85
20010102-86
20010102-87
20010102-88
20010102-89
20010102-9
20010102-90
20010102-91
20010102-92
20010102-93
20010102-94
20010102-95
20010102-96
20010102-97
20010102-98
20010102-99
20010103-0
20010103-1
20010103-10
20010103-11
20010103-12
20010103-13
20010103-14
20010103-15
20010103-16
20010103-17
20010103-18
20010103-19
20010103-2
20010103-20
20010103-21
20010103-22
20010103-23
20010103-24
20010103-25
20010103-26
20010103-27
20010103-28
20010103-29
20010103-3
20010103-30
20010103-31
20010103-32
20010103-33
20010103-34
20010103-35
20010103-36
20010103-37
20010103-38
20010103-39
20010103-4
20010103-40
20010103-41
20010103-42
20010103-43
20010103-44
20010103-45
20010103-46
20010103-47
20010103-48
20010103-49
20010103-5
20010103-50
20010103-51
20010103-52
20010103-53
20010103-54
20010103-55
20010103-56
20010103-57
20010103-58
20010103-59
20010103-6
20010103-60
20010103-61
20010103-62
20010103-63
20010103-64
20010103-65
20010103-66
20010103-67
20010103-68
20010103-69
20010103-7
20010103-70
20010103-71
20010103-72
20010103-73
20010103-74
20010103-75
20010103-76
20010103-77
20010103-78
20010103-79
20010103-8
20010103-80
20010103-81
20010103-82
20010103-83
20010103-84
20010103-85
20010103-86
20010103-87
20010103-88
20010103-89
20010103-9
20010103-90
20010103-91
20010103-92
20010103-93
20010103-94
20010103-95
20010103-96
20010103-97
20010103-98
20010103-99
==== partition IDs of partitioned_multi_table_uint_date should be usable for prefix filtering
300
0-20010101
0-20010102
0-20010103
1-20010101
1-20010102
1-20010103
10-20010101
10-20010102
10-20010103
11-20010101
11-20010102
11-20010103
12-20010101
12-20010102
12-20010103
13-20010101
13-20010102
13-20010103
14-20010101
14-20010102
14-20010103
15-20010101
15-20010102
15-20010103
16-20010101
16-20010102
16-20010103
17-20010101
17-20010102
17-20010103
18-20010101
18-20010102
18-20010103
19-20010101
19-20010102
19-20010103
2-20010101
2-20010102
2-20010103
20-20010101
20-20010102
20-20010103
21-20010101
21-20010102
21-20010103
22-20010101
22-20010102
22-20010103
23-20010101
23-20010102
23-20010103
24-20010101
24-20010102
24-20010103
25-20010101
25-20010102
25-20010103
26-20010101
26-20010102
26-20010103
27-20010101
27-20010102
27-20010103
28-20010101
28-20010102
28-20010103
29-20010101
29-20010102
29-20010103
3-20010101
3-20010102
3-20010103
30-20010101
30-20010102
30-20010103
31-20010101
31-20010102
31-20010103
32-20010101
32-20010102
32-20010103
33-20010101
33-20010102
33-20010103
34-20010101
34-20010102
34-20010103
35-20010101
35-20010102
35-20010103
36-20010101
36-20010102
36-20010103
37-20010101
37-20010102
37-20010103
38-20010101
38-20010102
38-20010103
39-20010101
39-20010102
39-20010103
4-20010101
4-20010102
4-20010103
40-20010101
40-20010102
40-20010103
41-20010101
41-20010102
41-20010103
42-20010101
42-20010102
42-20010103
43-20010101
43-20010102
43-20010103
44-20010101
44-20010102
44-20010103
45-20010101
45-20010102
45-20010103
46-20010101
46-20010102
46-20010103
47-20010101
47-20010102
47-20010103
48-20010101
48-20010102
48-20010103
49-20010101
49-20010102
49-20010103
5-20010101
5-20010102
5-20010103
50-20010101
50-20010102
50-20010103
51-20010101
51-20010102
51-20010103
52-20010101
52-20010102
52-20010103
53-20010101
53-20010102
53-20010103
54-20010101
54-20010102
54-20010103
55-20010101
55-20010102
55-20010103
56-20010101
56-20010102
56-20010103
57-20010101
57-20010102
57-20010103
58-20010101
58-20010102
58-20010103
59-20010101
59-20010102
59-20010103
6-20010101
6-20010102
6-20010103
60-20010101
60-20010102
60-20010103
61-20010101
61-20010102
61-20010103
62-20010101
62-20010102
62-20010103
63-20010101
63-20010102
63-20010103
64-20010101
64-20010102
64-20010103
65-20010101
65-20010102
65-20010103
66-20010101
66-20010102
66-20010103
67-20010101
67-20010102
67-20010103
68-20010101
68-20010102
68-20010103
69-20010101
69-20010102
69-20010103
7-20010101
7-20010102
7-20010103
70-20010101
70-20010102
70-20010103
71-20010101
71-20010102
71-20010103
72-20010101
72-20010102
72-20010103
73-20010101
73-20010102
73-20010103
74-20010101
74-20010102
74-20010103
75-20010101
75-20010102
75-20010103
76-20010101
76-20010102
76-20010103
77-20010101
77-20010102
77-20010103
78-20010101
78-20010102
78-20010103
79-20010101
79-20010102
79-20010103
8-20010101
8-20010102
8-20010103
80-20010101
80-20010102
80-20010103
81-20010101
81-20010102
81-20010103
82-20010101
82-20010102
82-20010103
83-20010101
83-20010102
83-20010103
84-20010101
84-20010102
84-20010103
85-20010101
85-20010102
85-20010103
86-20010101
86-20010102
86-20010103
87-20010101
87-20010102
87-20010103
88-20010101
88-20010102
88-20010103
89-20010101
89-20010102
89-20010103
9-20010101
9-20010102
9-20010103
90-20010101
90-20010102
90-20010103
91-20010101
91-20010102
91-20010103
92-20010101
92-20010102
92-20010103
93-20010101
93-20010102
93-20010103
94-20010101
94-20010102
94-20010103
95-20010101
95-20010102
95-20010103
96-20010101
96-20010102
96-20010103
97-20010101
97-20010102
97-20010103
98-20010101
98-20010102
98-20010103
99-20010101
99-20010102
99-20010103
==== partition IDs of partitioned_multi_table_ipv4_date should be usable for prefix filtering
600
101984561-20010101
101984581-20010101
101984601-20010101
101984621-20010101
101984641-20010101
101989681-20010103
101989701-20010103
101989721-20010103
101989741-20010103
101989761-20010103
101994801-20010102
101994821-20010102
101994841-20010102
101994861-20010102
101994881-20010102
101999921-20010101
101999941-20010101
101999961-20010101
101999981-20010101
102000001-20010101
102005041-20010103
102005061-20010103
102005081-20010103
102005101-20010103
102005121-20010103
102010161-20010102
102010181-20010102
102010201-20010102
102010221-20010102
102010241-20010102
118827570-20010102
118827590-20010102
118827610-20010102
118827630-20010102
118827650-20010102
118832690-20010101
118832710-20010101
118832730-20010101
118832750-20010101
118832770-20010101
118837810-20010103
118837830-20010103
118837850-20010103
118837870-20010103
118837890-20010103
118842930-20010102
118842950-20010102
118842970-20010102
118842990-20010102
118843010-20010102
118848050-20010101
118848070-20010101
118848090-20010101
118848110-20010101
118848130-20010101
118853170-20010103
118853190-20010103
118853210-20010103
118853230-20010103
118853250-20010103
135670579-20010103
135670599-20010103
135670619-20010103
135670639-20010103
135670659-20010103
135675699-20010102
135675719-20010102
135675739-20010102
135675759-20010102
135675779-20010102
135680819-20010101
135680839-20010101
135680859-20010101
135680879-20010101
135680899-20010101
135685939-20010103
135685959-20010103
135685979-20010103
135685999-20010103
135686019-20010103
135691059-20010102
135691079-20010102
135691099-20010102
135691119-20010102
135691139-20010102
135696179-20010101
135696199-20010101
135696219-20010101
135696239-20010101
135696259-20010101
152513588-20010101
152513608-20010101
152513628-20010101
152513648-20010101
152513668-20010101
152518708-20010103
152518728-20010103
152518748-20010103
152518768-20010103
152518788-20010103
152523828-20010102
152523848-20010102
152523868-20010102
152523888-20010102
152523908-20010102
152528948-20010101
152528968-20010101
152528988-20010101
152529008-20010101
152529028-20010101
152534068-20010103
152534088-20010103
152534108-20010103
152534128-20010103
152534148-20010103
152539188-20010102
152539208-20010102
152539228-20010102
152539248-20010102
152539268-20010102
169356597-20010102
169356617-20010102
169356637-20010102
169356657-20010102
169356677-20010102
169361717-20010101
169361737-20010101
169361757-20010101
169361777-20010101
169361797-20010101
169366837-20010103
169366857-20010103
169366877-20010103
169366897-20010103
169366917-20010103
169371957-20010102
169371977-20010102
169371997-20010102
169372017-20010102
169372037-20010102
169377077-20010101
169377097-20010101
169377117-20010101
169377137-20010101
169377157-20010101
169382197-20010103
169382217-20010103
169382237-20010103
169382257-20010103
169382277-20010103
17769516-20010102
17769536-20010102
17769556-20010102
17769576-20010102
17769596-20010102
17774636-20010101
17774656-20010101
17774676-20010101
17774696-20010101
17774716-20010101
17779756-20010103
17779776-20010103
17779796-20010103
17779816-20010103
17779836-20010103
17784876-20010102
17784896-20010102
17784916-20010102
17784936-20010102
17784956-20010102
17789996-20010101
17790016-20010101
17790036-20010101
17790056-20010101
17790076-20010101
17795116-20010103
17795136-20010103
17795156-20010103
17795176-20010103
17795196-20010103
186199606-20010103
186199626-20010103
186199646-20010103
186199666-20010103
186199686-20010103
186204726-20010102
186204746-20010102
186204766-20010102
186204786-20010102
186204806-20010102
186209846-20010101
186209866-20010101
186209886-20010101
186209906-20010101
186209926-20010101
186214966-20010103
186214986-20010103
186215006-20010103
186215026-20010103
186215046-20010103
186220086-20010102
186220106-20010102
186220126-20010102
186220146-20010102
186220166-20010102
186225206-20010101
186225226-20010101
186225246-20010101
186225266-20010101
186225286-20010101
203042615-20010101
203042635-20010101
203042655-20010101
203042675-20010101
203042695-20010101
203047735-20010103
203047755-20010103
203047775-20010103
203047795-20010103
203047815-20010103
203052855-20010102
203052875-20010102
203052895-20010102
203052915-20010102
203052935-20010102
203057975-20010101
203057995-20010101
203058015-20010101
203058035-20010101
203058055-20010101
203063095-20010103
203063115-20010103
203063135-20010103
203063155-20010103
203063175-20010103
203068215-20010102
203068235-20010102
203068255-20010102
203068275-20010102
203068295-20010102
219885624-20010102
219885644-20010102
219885664-20010102
219885684-20010102
219885704-20010102
219890744-20010101
219890764-20010101
219890784-20010101
219890804-20010101
219890824-20010101
219895864-20010103
219895884-20010103
219895904-20010103
219895924-20010103
219895944-20010103
219900984-20010102
219901004-20010102
219901024-20010102
219901044-20010102
219901064-20010102
219906104-20010101
219906124-20010101
219906144-20010101
219906164-20010101
219906184-20010101
219911224-20010103
219911244-20010103
219911264-20010103
219911284-20010103
219911304-20010103
236728633-20010103
236728653-20010103
236728673-20010103
236728693-20010103
236728713-20010103
236733753-20010102
236733773-20010102
236733793-20010102
236733813-20010102
236733833-20010102
236738873-20010101
236738893-20010101
236738913-20010101
236738933-20010101
236738953-20010101
236743993-20010103
236744013-20010103
236744033-20010103
236744053-20010103
236744073-20010103
236749113-20010102
236749133-20010102
236749153-20010102
236749173-20010102
236749193-20010102
236754233-20010101
236754253-20010101
236754273-20010101
236754293-20010101
236754313-20010101
253571642-20010101
253571662-20010101
253571682-20010101
253571702-20010101
253571722-20010101
253576762-20010103
253576782-20010103
253576802-20010103
253576822-20010103
253576842-20010103
253581882-20010102
253581902-20010102
253581922-20010102
253581942-20010102
253581962-20010102
253587002-20010101
253587022-20010101
253587042-20010101
253587062-20010101
253587082-20010101
253592122-20010103
253592142-20010103
253592162-20010103
253592182-20010103
253592202-20010103
253597242-20010102
253597262-20010102
253597282-20010102
253597302-20010102
253597322-20010102
270414651-20010102
270414671-20010102
270414691-20010102
270414711-20010102
270414731-20010102
270419771-20010101
270419791-20010101
270419811-20010101
270419831-20010101
270419851-20010101
270424891-20010103
270424911-20010103
270424931-20010103
270424951-20010103
270424971-20010103
270430011-20010102
270430031-20010102
270430051-20010102
270430071-20010102
270430091-20010102
270435131-20010101
270435151-20010101
270435171-20010101
270435191-20010101
270435211-20010101
270440251-20010103
270440271-20010103
270440291-20010103
270440311-20010103
270440331-20010103
287257660-20010103
287257680-20010103
287257700-20010103
287257720-20010103
287257740-20010103
287262780-20010102
287262800-20010102
287262820-20010102
287262840-20010102
287262860-20010102
287267900-20010101
287267920-20010101
287267940-20010101
287267960-20010101
287267980-20010101
287273020-20010103
287273040-20010103
287273060-20010103
287273080-20010103
287273100-20010103
287278140-20010102
287278160-20010102
287278180-20010102
287278200-20010102
287278220-20010102
287283260-20010101
287283280-20010101
287283300-20010101
287283320-20010101
287283340-20010101
304100669-20010101
304100689-20010101
304100709-20010101
304100729-20010101
304100749-20010101
304105789-20010103
304105809-20010103
304105829-20010103
304105849-20010103
304105869-20010103
304110909-20010102
304110929-20010102
304110949-20010102
304110969-20010102
304110989-20010102
304116029-20010101
304116049-20010101
304116069-20010101
304116089-20010101
304116109-20010101
304121149-20010103
304121169-20010103
304121189-20010103
304121209-20010103
304121229-20010103
304126269-20010102
304126289-20010102
304126309-20010102
304126329-20010102
304126349-20010102
320943678-20010102
320943698-20010102
320943718-20010102
320943738-20010102
320943758-20010102
320948798-20010101
320948818-20010101
320948838-20010101
320948858-20010101
320948878-20010101
320953918-20010103
320953938-20010103
320953958-20010103
320953978-20010103
320953998-20010103
320959038-20010102
320959058-20010102
320959078-20010102
320959098-20010102
320959118-20010102
320964158-20010101
320964178-20010101
320964198-20010101
320964218-20010101
320964238-20010101
320969278-20010103
320969298-20010103
320969318-20010103
320969338-20010103
320969358-20010103
34612525-20010103
34612545-20010103
34612565-20010103
34612585-20010103
34612605-20010103
34617645-20010102
34617665-20010102
34617685-20010102
34617705-20010102
34617725-20010102
34622765-20010101
34622785-20010101
34622805-20010101
34622825-20010101
34622845-20010101
34627885-20010103
34627905-20010103
34627925-20010103
34627945-20010103
34627965-20010103
34633005-20010102
34633025-20010102
34633045-20010102
34633065-20010102
34633085-20010102
34638125-20010101
34638145-20010101
34638165-20010101
34638185-20010101
34638205-20010101
51455534-20010101
51455554-20010101
51455574-20010101
51455594-20010101
51455614-20010101
51460654-20010103
51460674-20010103
51460694-20010103
51460714-20010103
51460734-20010103
51465774-20010102
51465794-20010102
51465814-20010102
51465834-20010102
51465854-20010102
51470894-20010101
51470914-20010101
51470934-20010101
51470954-20010101
51470974-20010101
51476014-20010103
51476034-20010103
51476054-20010103
51476074-20010103
51476094-20010103
51481134-20010102
51481154-20010102
51481174-20010102
51481194-20010102
51481214-20010102
68298543-20010102
68298563-20010102
68298583-20010102
68298603-20010102
68298623-20010102
68303663-20010101
68303683-20010101
68303703-20010101
68303723-20010101
68303743-20010101
68308783-20010103
68308803-20010103
68308823-20010103
68308843-20010103
68308863-20010103
68313903-20010102
68313923-20010102
68313943-20010102
68313963-20010102
68313983-20010102
68319023-20010101
68319043-20010101
68319063-20010101
68319083-20010101
68319103-20010101
68324143-20010103
68324163-20010103
68324183-20010103
68324203-20010103
68324223-20010103
85141552-20010103
85141572-20010103
85141592-20010103
85141612-20010103
85141632-20010103
85146672-20010102
85146692-20010102
85146712-20010102
85146732-20010102
85146752-20010102
85151792-20010101
85151812-20010101
85151832-20010101
85151852-20010101
85151872-20010101
85156912-20010103
85156932-20010103
85156952-20010103
85156972-20010103
85156992-20010103
85162032-20010102
85162052-20010102
85162072-20010102
85162092-20010102
85162112-20010102
85167152-20010101
85167172-20010101
85167192-20010101
85167212-20010101
85167232-20010101
926507-20010101
926527-20010101
926547-20010101
926567-20010101
926587-20010101
931627-20010103
931647-20010103
931667-20010103
931687-20010103
931707-20010103
936747-20010102
936767-20010102
936787-20010102
936807-20010102
936827-20010102
941867-20010101
941887-20010101
941907-20010101
941927-20010101
941947-20010101
946987-20010103
947007-20010103
947027-20010103
947047-20010103
947067-20010103
952107-20010102
952127-20010102
952147-20010102
952167-20010102
952187-20010102
==== partition IDs of partitioned_uint_toYYYYMMDD should be usable for prefix filtering
300
0-20010101
0-20010102
0-20010103
1-20010101
1-20010102
1-20010103
10-20010101
10-20010102
10-20010103
11-20010101
11-20010102
11-20010103
12-20010101
12-20010102
12-20010103
13-20010101
13-20010102
13-20010103
14-20010101
14-20010102
14-20010103
15-20010101
15-20010102
15-20010103
16-20010101
16-20010102
16-20010103
17-20010101
17-20010102
17-20010103
18-20010101
18-20010102
18-20010103
19-20010101
19-20010102
19-20010103
2-20010101
2-20010102
2-20010103
20-20010101
20-20010102
20-20010103
21-20010101
21-20010102
21-20010103
22-20010101
22-20010102
22-20010103
23-20010101
23-20010102
23-20010103
24-20010101
24-20010102
24-20010103
25-20010101
25-20010102
25-20010103
26-20010101
26-20010102
26-20010103
27-20010101
27-20010102
27-20010103
28-20010101
28-20010102
28-20010103
29-20010101
29-20010102
29-20010103
3-20010101
3-20010102
3-20010103
30-20010101
30-20010102
30-20010103
31-20010101
31-20010102
31-20010103
32-20010101
32-20010102
32-20010103
33-20010101
33-20010102
33-20010103
34-20010101
34-20010102
34-20010103
35-20010101
35-20010102
35-20010103
36-20010101
36-20010102
36-20010103
37-20010101
37-20010102
37-20010103
38-20010101
38-20010102
38-20010103
39-20010101
39-20010102
39-20010103
4-20010101
4-20010102
4-20010103
40-20010101
40-20010102
40-20010103
41-20010101
41-20010102
41-20010103
42-20010101
42-20010102
42-20010103
43-20010101
43-20010102
43-20010103
44-20010101
44-20010102
44-20010103
45-20010101
45-20010102
45-20010103
46-20010101
46-20010102
46-20010103
47-20010101
47-20010102
47-20010103
48-20010101
48-20010102
48-20010103
49-20010101
49-20010102
49-20010103
5-20010101
5-20010102
5-20010103
50-20010101
50-20010102
50-20010103
51-20010101
51-20010102
51-20010103
52-20010101
52-20010102
52-20010103
53-20010101
53-20010102
53-20010103
54-20010101
54-20010102
54-20010103
55-20010101
55-20010102
55-20010103
56-20010101
56-20010102
56-20010103
57-20010101
57-20010102
57-20010103
58-20010101
58-20010102
58-20010103
59-20010101
59-20010102
59-20010103
6-20010101
6-20010102
6-20010103
60-20010101
60-20010102
60-20010103
61-20010101
61-20010102
61-20010103
62-20010101
62-20010102
62-20010103
63-20010101
63-20010102
63-20010103
64-20010101
64-20010102
64-20010103
65-20010101
65-20010102
65-20010103
66-20010101
66-20010102
66-20010103
67-20010101
67-20010102
67-20010103
68-20010101
68-20010102
68-20010103
69-20010101
69-20010102
69-20010103
7-20010101
7-20010102
7-20010103
70-20010101
70-20010102
70-20010103
71-20010101
71-20010102
71-20010103
72-20010101
72-20010102
72-20010103
73-20010101
73-20010102
73-20010103
74-20010101
74-20010102
74-20010103
75-20010101
75-20010102
75-20010103
76-20010101
76-20010102
76-20010103
77-20010101
77-20010102
77-20010103
78-20010101
78-20010102
78-20010103
79-20010101
79-20010102
79-20010103
8-20010101
8-20010102
8-20010103
80-20010101
80-20010102
80-20010103
81-20010101
81-20010102
81-20010103
82-20010101
82-20010102
82-20010103
83-20010101
83-20010102
83-20010103
84-20010101
84-20010102
84-20010103
85-20010101
85-20010102
85-20010103
86-20010101
86-20010102
86-20010103
87-20010101
87-20010102
87-20010103
88-20010101
88-20010102
88-20010103
89-20010101
89-20010102
89-20010103
9-20010101
9-20010102
9-20010103
90-20010101
90-20010102
90-20010103
91-20010101
91-20010102
91-20010103
92-20010101
92-20010102
92-20010103
93-20010101
93-20010102
93-20010103
94-20010101
94-20010102
94-20010103
95-20010101
95-20010102
95-20010103
96-20010101
96-20010102
96-20010103
97-20010101
97-20010102
97-20010103
98-20010101
98-20010102
98-20010103
99-20010101
99-20010102
99-20010103
==== partition IDs of partitioned_uint_toYYYYMM should be usable for prefix filtering
100
0-200101
1-200101
10-200101
11-200101
12-200101
13-200101
14-200101
15-200101
16-200101
17-200101
18-200101
19-200101
2-200101
20-200101
21-200101
22-200101
23-200101
24-200101
25-200101
26-200101
27-200101
28-200101
29-200101
3-200101
30-200101
31-200101
32-200101
33-200101
34-200101
35-200101
36-200101
37-200101
38-200101
39-200101
4-200101
40-200101
41-200101
42-200101
43-200101
44-200101
45-200101
46-200101
47-200101
48-200101
49-200101
5-200101
50-200101
51-200101
52-200101
53-200101
54-200101
55-200101
56-200101
57-200101
58-200101
59-200101
6-200101
60-200101
61-200101
62-200101
63-200101
64-200101
65-200101
66-200101
67-200101
68-200101
69-200101
7-200101
70-200101
71-200101
72-200101
73-200101
74-200101
75-200101
76-200101
77-200101
78-200101
79-200101
8-200101
80-200101
81-200101
82-200101
83-200101
84-200101
85-200101
86-200101
87-200101
88-200101
89-200101
9-200101
90-200101
91-200101
92-200101
93-200101
94-200101
95-200101
96-200101
97-200101
98-200101
99-200101
==== partition IDs of partitioned_uint_toYear should be usable for prefix filtering
100
0-2001
1-2001
10-2001
11-2001
12-2001
13-2001
14-2001
15-2001
16-2001
17-2001
18-2001
19-2001
2-2001
20-2001
21-2001
22-2001
23-2001
24-2001
25-2001
26-2001
27-2001
28-2001
29-2001
3-2001
30-2001
31-2001
32-2001
33-2001
34-2001
35-2001
36-2001
37-2001
38-2001
39-2001
4-2001
40-2001
41-2001
42-2001
43-2001
44-2001
45-2001
46-2001
47-2001
48-2001
49-2001
5-2001
50-2001
51-2001
52-2001
53-2001
54-2001
55-2001
56-2001
57-2001
58-2001
59-2001
6-2001
60-2001
61-2001
62-2001
63-2001
64-2001
65-2001
66-2001
67-2001
68-2001
69-2001
7-2001
70-2001
71-2001
72-2001
73-2001
74-2001
75-2001
76-2001
77-2001
78-2001
79-2001
8-2001
80-2001
81-2001
82-2001
83-2001
84-2001
85-2001
86-2001
87-2001
88-2001
89-2001
9-2001
90-2001
91-2001
92-2001
93-2001
94-2001
95-2001
96-2001
97-2001
98-2001
99-2001
==== partition IDs of partitioned_uint_toMonth should be usable for prefix filtering
100
0-1
1-1
10-1
11-1
12-1
13-1
14-1
15-1
16-1
17-1
18-1
19-1
2-1
20-1
21-1
22-1
23-1
24-1
25-1
26-1
27-1
28-1
29-1
3-1
30-1
31-1
32-1
33-1
34-1
35-1
36-1
37-1
38-1
39-1
4-1
40-1
41-1
42-1
43-1
44-1
45-1
46-1
47-1
48-1
49-1
5-1
50-1
51-1
52-1
53-1
54-1
55-1
56-1
57-1
58-1
59-1
6-1
60-1
61-1
62-1
63-1
64-1
65-1
66-1
67-1
68-1
69-1
7-1
70-1
71-1
72-1
73-1
74-1
75-1
76-1
77-1
78-1
79-1
8-1
80-1
81-1
82-1
83-1
84-1
85-1
86-1
87-1
88-1
89-1
9-1
90-1
91-1
92-1
93-1
94-1
95-1
96-1
97-1
98-1
99-1
==== partition IDs of partitioned_multi_table_date_low_cardinality should not be usable for prefix filtering
0
==== partition IDs of partitioned_multi_table_string_uint_date should not be usable for prefix filtering
0
==== partition IDs of partitioned_multi_table_uint_string_date should not be usable for prefix filtering
0
==== partition IDs of partitioned_signed_int should not be usable for prefix filtering
0
1

==== PartitionPrefix should not prune anything (no conditions or hash-based partition IDs)

-- select * from partitioned_single_table
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  ReadFromMergeTree (default.partitioned_single_table)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 100/100
      Granules: 100/0
    MinMax
      Condition: true
      Parts: 100/100
      Granules: 100/100
    Partition
      Condition: true
      Parts: 100/100
      Granules: 100/100
    PrimaryKey
      Condition: true
      Parts: 100/100
      Granules: 100/100
    Ranges: 100
-- enable_analyzer=1
Expression ((Project names + (Projection + Change column names to column identifiers)))
  ReadFromMergeTree (default.partitioned_single_table)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 100/100
      Granules: 100/0
    MinMax
      Condition: true
      Parts: 100/100
      Granules: 100/100
    Partition
      Condition: true
      Parts: 100/100
      Granules: 100/100
    PrimaryKey
      Condition: true
      Parts: 100/100
      Granules: 100/100
    Ranges: 100

-- select * from partitioned_multi_table_date_uint
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  ReadFromMergeTree (default.partitioned_multi_table_date_uint)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300
-- enable_analyzer=1
Expression ((Project names + (Projection + Change column names to column identifiers)))
  ReadFromMergeTree (default.partitioned_multi_table_date_uint)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300

-- select * from partitioned_multi_table_uint_date
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  ReadFromMergeTree (default.partitioned_multi_table_uint_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300
-- enable_analyzer=1
Expression ((Project names + (Projection + Change column names to column identifiers)))
  ReadFromMergeTree (default.partitioned_multi_table_uint_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300

-- select * from partitioned_multi_table_string_uint_date
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  ReadFromMergeTree (default.partitioned_multi_table_string_uint_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300
-- enable_analyzer=1
Expression ((Project names + (Projection + Change column names to column identifiers)))
  ReadFromMergeTree (default.partitioned_multi_table_string_uint_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300

-- select * from partitioned_multi_table_uint_string_date
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  ReadFromMergeTree (default.partitioned_multi_table_uint_string_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300
-- enable_analyzer=1
Expression ((Project names + (Projection + Change column names to column identifiers)))
  ReadFromMergeTree (default.partitioned_multi_table_uint_string_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300

-- select * from partitioned_multi_table_date_low_cardinality
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  ReadFromMergeTree (default.partitioned_multi_table_date_low_cardinality)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300
-- enable_analyzer=1
Expression ((Project names + (Projection + Change column names to column identifiers)))
  ReadFromMergeTree (default.partitioned_multi_table_date_low_cardinality)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300

-- select * from partitioned_multi_table_string_uint_date where name = 'foo'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_string_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          name
        Condition: (name in [\'foo\', \'foo\'])
        Parts: 0/300
        Granules: 0/300
      Partition
        Keys:
          name
        Condition: (name in [\'foo\', \'foo\'])
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_string_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          name
        Condition: (name in [\'foo\', \'foo\'])
        Parts: 0/300
        Granules: 0/300
      Partition
        Keys:
          name
        Condition: (name in [\'foo\', \'foo\'])
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0

-- select * from partitioned_multi_table_date_low_cardinality where prt_date = '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_low_cardinality)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/300
        Granules: 100/300
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/100
        Granules: 100/100
      PrimaryKey
        Condition: true
        Parts: 100/100
        Granules: 100/100
      Ranges: 100
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_low_cardinality)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/300
        Granules: 100/300
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/100
        Granules: 100/100
      PrimaryKey
        Condition: true
        Parts: 100/100
        Granules: 100/100
      Ranges: 100

==== Single-column partition: PartitionPrefix filtering should be used

-- select * from partitioned_single_table where prt_id = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_single_table where prt_id = 1
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [1-,1-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [1, 1])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [1, 1])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [1-,1-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [1, 1])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [1, 1])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_single_table where prt_id > 50
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [51, +Inf))
        Parts: 49/100
        Granules: 49/100
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [51, +Inf))
        Parts: 49/49
        Granules: 49/49
      PrimaryKey
        Condition: true
        Parts: 49/49
        Granules: 49/49
      Ranges: 49
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [51, +Inf))
        Parts: 49/100
        Granules: 49/100
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [51, +Inf))
        Parts: 49/49
        Granules: 49/49
      PrimaryKey
        Condition: true
        Parts: 49/49
        Granules: 49/49
      Ranges: 49

-- select * from partitioned_single_table where prt_id >= 10 and prt_id <= 20
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [10-,20-]
        Parts: 12/100
        Granules: 12/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 11/12
        Granules: 11/12
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11
PartitionPrefixFilterPrunedParts: 88 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [10-,20-]
        Parts: 12/100
        Granules: 12/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 11/12
        Granules: 11/12
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11
PartitionPrefixFilterPrunedParts: 88 (increment)

==== Lexicographic vs numeric ordering: ranges spanning different digit lengths

These queries have ranges where min and max have different string lengths.

Lexicographic order differs from numeric order (e.g., '10' < '5' lexicographically).

-- select * from partitioned_single_table where prt_id >= 5 and prt_id <= 15
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 15]), (prt_id in [5, +Inf)))
        Parts: 11/100
        Granules: 11/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 15]), (prt_id in [5, +Inf)))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 15]), (prt_id in [5, +Inf)))
        Parts: 11/100
        Granules: 11/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 15]), (prt_id in [5, +Inf)))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11

-- select * from partitioned_single_table where prt_id >= 8 and prt_id <= 12
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 12]), (prt_id in [8, +Inf)))
        Parts: 5/100
        Granules: 5/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 12]), (prt_id in [8, +Inf)))
        Parts: 5/5
        Granules: 5/5
      PrimaryKey
        Condition: true
        Parts: 5/5
        Granules: 5/5
      Ranges: 5
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 12]), (prt_id in [8, +Inf)))
        Parts: 5/100
        Granules: 5/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 12]), (prt_id in [8, +Inf)))
        Parts: 5/5
        Granules: 5/5
      PrimaryKey
        Condition: true
        Parts: 5/5
        Granules: 5/5
      Ranges: 5

-- select * from partitioned_single_table where prt_id >= 1 and prt_id <= 100
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 100]), (prt_id in [1, +Inf)))
        Parts: 99/100
        Granules: 99/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 100]), (prt_id in [1, +Inf)))
        Parts: 99/99
        Granules: 99/99
      PrimaryKey
        Condition: true
        Parts: 99/99
        Granules: 99/99
      Ranges: 99
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 100]), (prt_id in [1, +Inf)))
        Parts: 99/100
        Granules: 99/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 100]), (prt_id in [1, +Inf)))
        Parts: 99/99
        Granules: 99/99
      PrimaryKey
        Condition: true
        Parts: 99/99
        Granules: 99/99
      Ranges: 99

-- select * from partitioned_single_table where prt_id >= 30 and prt_id <= 55
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [30-,55-]
        Parts: 28/100
        Granules: 28/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 55]), (prt_id in [30, +Inf)))
        Parts: 26/28
        Granules: 26/28
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 55]), (prt_id in [30, +Inf)))
        Parts: 26/26
        Granules: 26/26
      PrimaryKey
        Condition: true
        Parts: 26/26
        Granules: 26/26
      Ranges: 26
PartitionPrefixFilterPrunedParts: 72 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_single_table)
    Indexes:
      PartitionPrefix
        Condition: [30-,55-]
        Parts: 28/100
        Granules: 28/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 55]), (prt_id in [30, +Inf)))
        Parts: 26/28
        Granules: 26/28
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 55]), (prt_id in [30, +Inf)))
        Parts: 26/26
        Granules: 26/26
      PrimaryKey
        Condition: true
        Parts: 26/26
        Granules: 26/26
      Ranges: 26
PartitionPrefixFilterPrunedParts: 72 (increment)

==== Multi-column partition: filtering on first column only

-- select * from partitioned_multi_table_date_uint where prt_date = '1990-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [19900101-,19900101-]
        Parts: 0/300
        Granules: 0/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [7305, 7305])
        Parts: 0/0
        Granules: 0/0
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [7305, 7305])
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 300 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [19900101-,19900101-]
        Parts: 0/300
        Granules: 0/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [7305, 7305])
        Parts: 0/0
        Granules: 0/0
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [7305, 7305])
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 300 (increment)

-- select * from partitioned_multi_table_date_uint where prt_date = '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-,20010101-]
        Parts: 100/300
        Granules: 100/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/100
        Granules: 100/100
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/100
        Granules: 100/100
      PrimaryKey
        Condition: true
        Parts: 100/100
        Granules: 100/100
      Ranges: 100
PartitionPrefixFilterPrunedParts: 200 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-,20010101-]
        Parts: 100/300
        Granules: 100/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/100
        Granules: 100/100
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11323, 11323])
        Parts: 100/100
        Granules: 100/100
      PrimaryKey
        Condition: true
        Parts: 100/100
        Granules: 100/100
      Ranges: 100
PartitionPrefixFilterPrunedParts: 200 (increment)

-- select * from partitioned_multi_table_date_uint where prt_date > '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010102-,]
        Parts: 200/300
        Granules: 200/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11324, +Inf))
        Parts: 200/200
        Granules: 200/200
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11324, +Inf))
        Parts: 200/200
        Granules: 200/200
      PrimaryKey
        Condition: true
        Parts: 200/200
        Granules: 200/200
      Ranges: 200
PartitionPrefixFilterPrunedParts: 100 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010102-,]
        Parts: 200/300
        Granules: 200/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11324, +Inf))
        Parts: 200/200
        Granules: 200/200
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11324, +Inf))
        Parts: 200/200
        Granules: 200/200
      PrimaryKey
        Condition: true
        Parts: 200/200
        Granules: 200/200
      Ranges: 200
PartitionPrefixFilterPrunedParts: 100 (increment)

-- select * from partitioned_multi_table_date_uint where prt_date < '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [,20001231-]
        Parts: 0/300
        Granules: 0/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 11322])
        Parts: 0/0
        Granules: 0/0
      Partition
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 11322])
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 300 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [,20001231-]
        Parts: 0/300
        Granules: 0/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 11322])
        Parts: 0/0
        Granules: 0/0
      Partition
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 11322])
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 300 (increment)

-- select * from partitioned_multi_table_date_uint where prt_date < '2020-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [,20191231-]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 18261])
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 18261])
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [,20191231-]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 18261])
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_date
        Condition: (prt_date in (-Inf, 18261])
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300

-- select * from partitioned_multi_table_uint_date where prt_id = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)

-- select * from partitioned_multi_table_uint_date where prt_id >= 10 and prt_id <= 20
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,20-]
        Parts: 36/300
        Granules: 36/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 33/36
        Granules: 33/36
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 33/33
        Granules: 33/33
      PrimaryKey
        Condition: true
        Parts: 33/33
        Granules: 33/33
      Ranges: 33
PartitionPrefixFilterPrunedParts: 264 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,20-]
        Parts: 36/300
        Granules: 36/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 33/36
        Granules: 33/36
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))
        Parts: 33/33
        Granules: 33/33
      PrimaryKey
        Condition: true
        Parts: 33/33
        Granules: 33/33
      Ranges: 33
PartitionPrefixFilterPrunedParts: 264 (increment)

==== Multi-column partition: filtering on second column only (should not prune anything)

-- select * from partitioned_multi_table_uint_date where prt_date >= '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11323, +Inf))
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11323, +Inf))
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: (prt_date in [11323, +Inf))
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_date
        Condition: (prt_date in [11323, +Inf))
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300

==== Multi-column partition: filtering on first AND second column

-- select * from partitioned_multi_table_date_uint where prt_date = '2001-01-01' and prt_id = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-42-,20010101-42-]
        Parts: 1/300
        Granules: 1/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, 11323]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, 11323]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 299 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-42-,20010101-42-]
        Parts: 1/300
        Granules: 1/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, 11323]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, 11323]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 299 (increment)

-- select * from partitioned_multi_table_date_uint where prt_date = '2001-01-01' and prt_id >= 10 and prt_id <= 20
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-10-,20010101-20-]
        Parts: 12/300
        Granules: 12/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 20]), and((prt_id in [10, +Inf)), (prt_date in [11323, 11323])))
        Parts: 11/12
        Granules: 11/12
      Partition
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 20]), and((prt_id in [10, +Inf)), (prt_date in [11323, 11323])))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11
PartitionPrefixFilterPrunedParts: 288 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-10-,20010101-20-]
        Parts: 12/300
        Granules: 12/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 20]), and((prt_id in [10, +Inf)), (prt_date in [11323, 11323])))
        Parts: 11/12
        Granules: 11/12
      Partition
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 20]), and((prt_id in [10, +Inf)), (prt_date in [11323, 11323])))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11
PartitionPrefixFilterPrunedParts: 288 (increment)

-- select * from partitioned_multi_table_uint_date where prt_id = 42 and prt_date = '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-20010101-,42-20010101-]
        Parts: 1/300
        Granules: 1/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in [11323, 11323]), (prt_id in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in [11323, 11323]), (prt_id in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 299 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-20010101-,42-20010101-]
        Parts: 1/300
        Granules: 1/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in [11323, 11323]), (prt_id in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in [11323, 11323]), (prt_id in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 299 (increment)

-- select * from partitioned_multi_table_uint_date where prt_id = 42 and prt_date >= '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-20010101-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in [11323, +Inf)), (prt_id in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in [11323, +Inf)), (prt_id in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-20010101-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in [11323, +Inf)), (prt_id in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in [11323, +Inf)), (prt_id in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)

-- select * from partitioned_multi_table_date_uint where prt_date >= '2001-01-01' and prt_id = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-42-,]
        Parts: 263/300
        Granules: 263/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, +Inf)))
        Parts: 3/263
        Granules: 3/263
      Partition
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, +Inf)))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 37 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-42-,]
        Parts: 263/300
        Granules: 263/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, +Inf)))
        Parts: 3/263
        Granules: 3/263
      Partition
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in [42, 42]), (prt_date in [11323, +Inf)))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 37 (increment)

-- select * from partitioned_multi_table_uint_date where prt_id >= 10 and prt_id <= 20 and prt_date = '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,20-20010101-]
        Parts: 34/300
        Granules: 34/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in [11323, 11323]), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf))))
        Parts: 11/34
        Granules: 11/34
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in [11323, 11323]), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf))))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11
PartitionPrefixFilterPrunedParts: 266 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,20-20010101-]
        Parts: 34/300
        Granules: 34/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in [11323, 11323]), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf))))
        Parts: 11/34
        Granules: 11/34
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in [11323, 11323]), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf))))
        Parts: 11/11
        Granules: 11/11
      PrimaryKey
        Condition: true
        Parts: 11/11
        Granules: 11/11
      Ranges: 11
PartitionPrefixFilterPrunedParts: 266 (increment)

==== IPv4 partition column

-- select * from partitioned_multi_table_ipv4_date where prt_ip_v4 = toIPv4('1.15.36.44')
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_ipv4_date)
    Indexes:
      PartitionPrefix
        Condition: [17769516-,17769516-]
        Parts: 1/600
        Granules: 1/0
      MinMax
        Keys:
          prt_ip_v4
        Condition: (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\'])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_ip_v4
        Condition: (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\'])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 599 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_ipv4_date)
    Indexes:
      PartitionPrefix
        Condition: [17769516-,17769516-]
        Parts: 1/600
        Granules: 1/0
      MinMax
        Keys:
          prt_ip_v4
        Condition: (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\'])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_ip_v4
        Condition: (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\'])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 599 (increment)

-- select * from partitioned_multi_table_ipv4_date where prt_ip_v4 = toIPv4('1.15.36.44') and prt_date = '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_ipv4_date)
    Indexes:
      PartitionPrefix
        Condition: [17769516-20010101-,17769516-20010101-]
        Parts: 0/600
        Granules: 0/0
      MinMax
        Keys:
          prt_date
          prt_ip_v4
        Condition: and((prt_date in [11323, 11323]), (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\']))
        Parts: 0/0
        Granules: 0/0
      Partition
        Keys:
          prt_ip_v4
          prt_date
        Condition: and((prt_date in [11323, 11323]), (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\']))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 600 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_ipv4_date)
    Indexes:
      PartitionPrefix
        Condition: [17769516-20010101-,17769516-20010101-]
        Parts: 0/600
        Granules: 0/0
      MinMax
        Keys:
          prt_date
          prt_ip_v4
        Condition: and((prt_date in [11323, 11323]), (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\']))
        Parts: 0/0
        Granules: 0/0
      Partition
        Keys:
          prt_ip_v4
          prt_date
        Condition: and((prt_date in [11323, 11323]), (prt_ip_v4 in [\'1.15.36.44\', \'1.15.36.44\']))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 600 (increment)

==== OR conditions: should compute union of ranges

-- OR on same column produces a range covering both values

-- select * from partitioned_multi_table_uint_date where prt_id = 42 or prt_id = 43
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,43-]
        Parts: 6/300
        Granules: 6/0
      MinMax
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      Partition
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 294 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,43-]
        Parts: 6/300
        Granules: 6/0
      MinMax
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      Partition
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 294 (increment)

-- select * from partitioned_multi_table_uint_date where prt_id = 10 or prt_id = 50
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,50-]
        Parts: 135/300
        Granules: 135/0
      MinMax
        Keys:
          prt_id
        Condition: or((prt_id in [50, 50]), (prt_id in [10, 10]))
        Parts: 6/135
        Granules: 6/135
      Partition
        Keys:
          prt_id
        Condition: or((prt_id in [50, 50]), (prt_id in [10, 10]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 165 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,50-]
        Parts: 135/300
        Granules: 135/0
      MinMax
        Keys:
          prt_id
        Condition: or((prt_id in [50, 50]), (prt_id in [10, 10]))
        Parts: 6/135
        Granules: 6/135
      Partition
        Keys:
          prt_id
        Condition: or((prt_id in [50, 50]), (prt_id in [10, 10]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 165 (increment)

-- OR on different columns: must match everything

-- select * from partitioned_multi_table_uint_date where prt_id = 10 or prt_date = '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or((prt_date in [11323, 11323]), (prt_id in [10, 10]))
        Parts: 102/300
        Granules: 102/300
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or((prt_date in [11323, 11323]), (prt_id in [10, 10]))
        Parts: 102/102
        Granules: 102/102
      PrimaryKey
        Condition: true
        Parts: 102/102
        Granules: 102/102
      Ranges: 102
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or((prt_date in [11323, 11323]), (prt_id in [10, 10]))
        Parts: 102/300
        Granules: 102/300
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or((prt_date in [11323, 11323]), (prt_id in [10, 10]))
        Parts: 102/102
        Granules: 102/102
      PrimaryKey
        Condition: true
        Parts: 102/102
        Granules: 102/102
      Ranges: 102

-- complex example

-- select * from partitioned_multi_table_uint_date where (prt_date = '2001-01-01' and (prt_id != 20 and (prt_id = 10 or prt_id = 20))) or (prt_date <= '2002-01-01' and prt_id = 50)
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,50-20020101-]
        Parts: 135/300
        Granules: 135/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or(and((prt_id in [50, 50]), (prt_date in (-Inf, 11688])), and(and(or((prt_id in [20, 20]), (prt_id in [10, 10])), (prt_id not in [20, 20])), (prt_date in [11323, 11323])))
        Parts: 4/135
        Granules: 4/135
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or(and((prt_id in [50, 50]), (prt_date in (-Inf, 11688])), and(and(or((prt_id in [20, 20]), (prt_id in [10, 10])), (prt_id not in [20, 20])), (prt_date in [11323, 11323])))
        Parts: 4/4
        Granules: 4/4
      PrimaryKey
        Condition: true
        Parts: 4/4
        Granules: 4/4
      Ranges: 4
PartitionPrefixFilterPrunedParts: 165 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,50-20020101-]
        Parts: 135/300
        Granules: 135/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or(and((prt_id in [50, 50]), (prt_date in (-Inf, 11688])), and(and(or((prt_id in [20, 20]), (prt_id in [10, 10])), (prt_id not in [20, 20])), (prt_date in [11323, 11323])))
        Parts: 4/135
        Granules: 4/135
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or(and((prt_id in [50, 50]), (prt_date in (-Inf, 11688])), and(and(or((prt_id in [20, 20]), (prt_id in [10, 10])), (prt_id not in [20, 20])), (prt_date in [11323, 11323])))
        Parts: 4/4
        Granules: 4/4
      PrimaryKey
        Condition: true
        Parts: 4/4
        Granules: 4/4
      Ranges: 4
PartitionPrefixFilterPrunedParts: 165 (increment)

==== NOT / negation: conservatively matches everything (no prefix filtering)

-- select * from partitioned_multi_table_uint_date where not prt_id = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/300
        Granules: 297/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/297
        Granules: 297/297
      PrimaryKey
        Condition: true
        Parts: 297/297
        Granules: 297/297
      Ranges: 297
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/300
        Granules: 297/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/297
        Granules: 297/297
      PrimaryKey
        Condition: true
        Parts: 297/297
        Granules: 297/297
      Ranges: 297

-- select * from partitioned_multi_table_uint_date where prt_id != 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/300
        Granules: 297/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/297
        Granules: 297/297
      PrimaryKey
        Condition: true
        Parts: 297/297
        Granules: 297/297
      Ranges: 297
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/300
        Granules: 297/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id not in [42, 42])
        Parts: 297/297
        Granules: 297/297
      PrimaryKey
        Condition: true
        Parts: 297/297
        Granules: 297/297
      Ranges: 297

==== IN set / NOT IN set: treated as match-everything (no prefix filtering)

-- select * from partitioned_multi_table_uint_date where prt_id in (10, 20, 30)
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in 3-element set)
        Parts: 9/300
        Granules: 9/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id in 3-element set)
        Parts: 9/9
        Granules: 9/9
      PrimaryKey
        Condition: true
        Parts: 9/9
        Granules: 9/9
      Ranges: 9
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in 3-element set)
        Parts: 9/300
        Granules: 9/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id in 3-element set)
        Parts: 9/9
        Granules: 9/9
      PrimaryKey
        Condition: true
        Parts: 9/9
        Granules: 9/9
      Ranges: 9

-- select * from partitioned_multi_table_uint_date where prt_id not in (10, 20, 30)
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id notIn 3-element set)
        Parts: 291/300
        Granules: 291/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id notIn 3-element set)
        Parts: 291/291
        Granules: 291/291
      PrimaryKey
        Condition: true
        Parts: 291/291
        Granules: 291/291
      Ranges: 291
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id notIn 3-element set)
        Parts: 291/300
        Granules: 291/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id notIn 3-element set)
        Parts: 291/291
        Granules: 291/291
      PrimaryKey
        Condition: true
        Parts: 291/291
        Granules: 291/291
      Ranges: 291

==== NULL checks: treated as match-everything (no prefix filtering)

-- select * from partitioned_multi_table_uint_date where prt_id is not null
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  ReadFromMergeTree (default.partitioned_multi_table_uint_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300
-- enable_analyzer=1
Expression ((Project names + (Projection + Change column names to column identifiers)))
  ReadFromMergeTree (default.partitioned_multi_table_uint_date)
  Indexes:
    PartitionPrefix
      Condition: [,] (condition is always unknown or true)
      Parts: 300/300
      Granules: 300/0
    MinMax
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Partition
      Condition: true
      Parts: 300/300
      Granules: 300/300
    PrimaryKey
      Condition: true
      Parts: 300/300
      Granules: 300/300
    Ranges: 300

==== Mixed conditions: AND with match-everything still uses the usable range

-- select * from partitioned_multi_table_uint_date where prt_id = 42 and prt_date in ('2001-01-01', '2001-01-02')
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in 2-element set), (prt_id in [42, 42]))
        Parts: 2/3
        Granules: 2/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in 2-element set), (prt_id in [42, 42]))
        Parts: 2/2
        Granules: 2/2
      PrimaryKey
        Condition: true
        Parts: 2/2
        Granules: 2/2
      Ranges: 2
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in 2-element set), (prt_id in [42, 42]))
        Parts: 2/3
        Granules: 2/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in 2-element set), (prt_id in [42, 42]))
        Parts: 2/2
        Granules: 2/2
      PrimaryKey
        Condition: true
        Parts: 2/2
        Granules: 2/2
      Ranges: 2
PartitionPrefixFilterPrunedParts: 297 (increment)

-- select * from partitioned_multi_table_uint_date where prt_id = 42 and prt_date is not null
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date isNotNull), (prt_id in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date isNotNull), (prt_id in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Filter ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)

==== Functions applied to partition key: only filter if possible

-- select * from partitioned_multi_table_date_uint where toYear(prt_date) = 2001
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-,20011231-]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: and((prt_date in (-Inf, 11687]), (prt_date in [11323, +Inf)))
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_date
        Condition: and((prt_date in (-Inf, 11687]), (prt_date in [11323, +Inf)))
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_date_uint)
    Indexes:
      PartitionPrefix
        Condition: [20010101-,20011231-]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_date
        Condition: and((prt_date in (-Inf, 11687]), (prt_date in [11323, +Inf)))
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_date
        Condition: and((prt_date in (-Inf, 11687]), (prt_date in [11323, +Inf)))
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300

-- select * from partitioned_multi_table_uint_date where prt_id + 1 = 43
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (plus(prt_id, 1) in [43, 43])
        Parts: 3/300
        Granules: 3/300
      Partition
        Keys:
          prt_id
        Condition: (plus(prt_id, 1) in [43, 43])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (plus(prt_id, 1) in [43, 43])
        Parts: 3/300
        Granules: 3/300
      Partition
        Keys:
          prt_id
        Condition: (plus(prt_id, 1) in [43, 43])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3

==== Complex filtering expressions

Deeply nested AND/OR - 4 levels deep

-- select * from partitioned_multi_table_uint_date where ((prt_id = 10 or prt_id = 20) and (prt_id = 15 or prt_id = 20)) or ((prt_id = 30 or prt_id = 40) and (prt_id = 35 or prt_id = 40))
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [15-,40-]
        Parts: 87/300
        Granules: 87/0
      MinMax
        Keys:
          prt_id
        Condition: or(and(or((prt_id in [40, 40]), (prt_id in [35, 35])), or((prt_id in [40, 40]), (prt_id in [30, 30]))), and(or((prt_id in [20, 20]), (prt_id in [15, 15])), or((prt_id in [20, 20]), (prt_id in [10, 10]))))
        Parts: 6/87
        Granules: 6/87
      Partition
        Keys:
          prt_id
        Condition: or(and(or((prt_id in [40, 40]), (prt_id in [35, 35])), or((prt_id in [40, 40]), (prt_id in [30, 30]))), and(or((prt_id in [20, 20]), (prt_id in [15, 15])), or((prt_id in [20, 20]), (prt_id in [10, 10]))))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 213 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [15-,40-]
        Parts: 87/300
        Granules: 87/0
      MinMax
        Keys:
          prt_id
        Condition: or(and(or((prt_id in [40, 40]), (prt_id in [35, 35])), or((prt_id in [40, 40]), (prt_id in [30, 30]))), and(or((prt_id in [20, 20]), (prt_id in [15, 15])), or((prt_id in [20, 20]), (prt_id in [10, 10]))))
        Parts: 6/87
        Granules: 6/87
      Partition
        Keys:
          prt_id
        Condition: or(and(or((prt_id in [40, 40]), (prt_id in [35, 35])), or((prt_id in [40, 40]), (prt_id in [30, 30]))), and(or((prt_id in [20, 20]), (prt_id in [15, 15])), or((prt_id in [20, 20]), (prt_id in [10, 10]))))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 213 (increment)

Nested ORs inside ANDs inside ORs

-- select * from partitioned_multi_table_uint_date where (((prt_id = 10 or prt_id = 11) and prt_date = '2001-01-01') or ((prt_id = 20 or prt_id = 21) and prt_date = '2001-01-02')) or prt_id = 50
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,50-]
        Parts: 135/300
        Granules: 135/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or((prt_id in [50, 50]), or(and((prt_date in [11324, 11324]), or((prt_id in [21, 21]), (prt_id in [20, 20]))), and((prt_date in [11323, 11323]), or((prt_id in [11, 11]), (prt_id in [10, 10])))))
        Parts: 7/135
        Granules: 7/135
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or((prt_id in [50, 50]), or(and((prt_date in [11324, 11324]), or((prt_id in [21, 21]), (prt_id in [20, 20]))), and((prt_date in [11323, 11323]), or((prt_id in [11, 11]), (prt_id in [10, 10])))))
        Parts: 7/7
        Granules: 7/7
      PrimaryKey
        Condition: true
        Parts: 7/7
        Granules: 7/7
      Ranges: 7
PartitionPrefixFilterPrunedParts: 165 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,50-]
        Parts: 135/300
        Granules: 135/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or((prt_id in [50, 50]), or(and((prt_date in [11324, 11324]), or((prt_id in [21, 21]), (prt_id in [20, 20]))), and((prt_date in [11323, 11323]), or((prt_id in [11, 11]), (prt_id in [10, 10])))))
        Parts: 7/135
        Granules: 7/135
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or((prt_id in [50, 50]), or(and((prt_date in [11324, 11324]), or((prt_id in [21, 21]), (prt_id in [20, 20]))), and((prt_date in [11323, 11323]), or((prt_id in [11, 11]), (prt_id in [10, 10])))))
        Parts: 7/7
        Granules: 7/7
      PrimaryKey
        Condition: true
        Parts: 7/7
        Granules: 7/7
      Ranges: 7
PartitionPrefixFilterPrunedParts: 165 (increment)

Complex: multiple NOTs nested

-- select * from partitioned_multi_table_uint_date where prt_id = 42 and not (prt_date = '2001-01-01' or prt_date = '2001-01-02')
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and(and((prt_date not in [11324, 11324]), (prt_date not in [11323, 11323])), (prt_id in [42, 42]))
        Parts: 1/3
        Granules: 1/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and(and((prt_date not in [11324, 11324]), (prt_date not in [11323, 11323])), (prt_id in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and(and((prt_date not in [11324, 11324]), (prt_date not in [11323, 11323])), (prt_id in [42, 42]))
        Parts: 1/3
        Granules: 1/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and(and((prt_date not in [11324, 11324]), (prt_date not in [11323, 11323])), (prt_id in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 297 (increment)

-- select * from partitioned_multi_table_uint_date where not (not (prt_id = 42))
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [42, 42])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)

Deeply nested ranges with AND/OR

-- select * from partitioned_multi_table_uint_date where (((prt_id >= 10 and prt_id <= 20) or (prt_id >= 30 and prt_id <= 40)) and ((prt_date >= '2001-01-01' and prt_date <= '2001-01-02') or prt_date = '2001-01-03'))
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,40-20010103-]
        Parts: 102/300
        Granules: 102/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and(or((prt_date in [11325, 11325]), and((prt_date in (-Inf, 11324]), (prt_date in [11323, +Inf)))), or(and((prt_id in (-Inf, 40]), (prt_id in [30, +Inf))), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))))
        Parts: 66/102
        Granules: 66/102
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and(or((prt_date in [11325, 11325]), and((prt_date in (-Inf, 11324]), (prt_date in [11323, +Inf)))), or(and((prt_id in (-Inf, 40]), (prt_id in [30, +Inf))), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))))
        Parts: 66/66
        Granules: 66/66
      PrimaryKey
        Condition: true
        Parts: 66/66
        Granules: 66/66
      Ranges: 66
PartitionPrefixFilterPrunedParts: 198 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,40-20010103-]
        Parts: 102/300
        Granules: 102/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and(or((prt_date in [11325, 11325]), and((prt_date in (-Inf, 11324]), (prt_date in [11323, +Inf)))), or(and((prt_id in (-Inf, 40]), (prt_id in [30, +Inf))), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))))
        Parts: 66/102
        Granules: 66/102
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and(or((prt_date in [11325, 11325]), and((prt_date in (-Inf, 11324]), (prt_date in [11323, +Inf)))), or(and((prt_id in (-Inf, 40]), (prt_id in [30, +Inf))), and((prt_id in (-Inf, 20]), (prt_id in [10, +Inf)))))
        Parts: 66/66
        Granules: 66/66
      PrimaryKey
        Condition: true
        Parts: 66/66
        Granules: 66/66
      Ranges: 66
PartitionPrefixFilterPrunedParts: 198 (increment)

Mix of point, range, and complex conditions - 5 levels

-- select * from partitioned_multi_table_uint_date where ((prt_id = 10 and (prt_date = '2001-01-01' or (prt_date >= '2001-01-02' and prt_date <= '2001-01-03'))) or (prt_id = 20 and prt_date = '2001-01-01')) and prt_id < 50
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,20-20010103-]
        Parts: 36/300
        Granules: 36/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 49]), or(and((prt_date in [11323, 11323]), (prt_id in [20, 20])), and(or(and((prt_date in (-Inf, 11325]), (prt_date in [11324, +Inf))), (prt_date in [11323, 11323])), (prt_id in [10, 10]))))
        Parts: 4/36
        Granules: 4/36
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_id in (-Inf, 49]), or(and((prt_date in [11323, 11323]), (prt_id in [20, 20])), and(or(and((prt_date in (-Inf, 11325]), (prt_date in [11324, +Inf))), (prt_date in [11323, 11323])), (prt_id in [10, 10]))))
        Parts: 4/4
        Granules: 4/4
      PrimaryKey
        Condition: true
        Parts: 4/4
        Granules: 4/4
      Ranges: 4
PartitionPrefixFilterPrunedParts: 264 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,20-20010103-]
        Parts: 36/300
        Granules: 36/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 49]), or(and((prt_date in [11323, 11323]), (prt_id in [20, 20])), and(or(and((prt_date in (-Inf, 11325]), (prt_date in [11324, +Inf))), (prt_date in [11323, 11323])), (prt_id in [10, 10]))))
        Parts: 4/36
        Granules: 4/36
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_id in (-Inf, 49]), or(and((prt_date in [11323, 11323]), (prt_id in [20, 20])), and(or(and((prt_date in (-Inf, 11325]), (prt_date in [11324, +Inf))), (prt_date in [11323, 11323])), (prt_id in [10, 10]))))
        Parts: 4/4
        Granules: 4/4
      PrimaryKey
        Condition: true
        Parts: 4/4
        Granules: 4/4
      Ranges: 4
PartitionPrefixFilterPrunedParts: 264 (increment)

Alternating AND/OR at each level

-- select * from partitioned_multi_table_uint_date where (prt_id = 10 or (prt_id = 20 and (prt_id = 20 or (prt_id = 30 and prt_date = '2001-01-01'))))
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,20-]
        Parts: 36/300
        Granules: 36/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or(and(or(and((prt_date in [11323, 11323]), (prt_id in [30, 30])), (prt_id in [20, 20])), (prt_id in [20, 20])), (prt_id in [10, 10]))
        Parts: 6/36
        Granules: 6/36
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or(and(or(and((prt_date in [11323, 11323]), (prt_id in [30, 30])), (prt_id in [20, 20])), (prt_id in [20, 20])), (prt_id in [10, 10]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 264 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,20-]
        Parts: 36/300
        Granules: 36/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or(and(or(and((prt_date in [11323, 11323]), (prt_id in [30, 30])), (prt_id in [20, 20])), (prt_id in [20, 20])), (prt_id in [10, 10]))
        Parts: 6/36
        Granules: 6/36
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or(and(or(and((prt_date in [11323, 11323]), (prt_id in [30, 30])), (prt_id in [20, 20])), (prt_id in [20, 20])), (prt_id in [10, 10]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 264 (increment)

Complex with functions mixed in (should be conservative on function parts)

-- select * from partitioned_multi_table_uint_date where (prt_id = 42 or prt_id = 43) and (prt_id + 0 = prt_id)
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,43-]
        Parts: 6/300
        Granules: 6/0
      MinMax
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      Partition
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 294 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,43-]
        Parts: 6/300
        Granules: 6/0
      MinMax
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      Partition
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 294 (increment)

Triple OR of complex ANDs

-- select * from partitioned_multi_table_uint_date where (prt_id = 10 and prt_date = '2001-01-01') or (prt_id = 20 and prt_date = '2001-01-02') or (prt_id = 30 and prt_date = '2001-01-03')
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,30-20010103-]
        Parts: 69/300
        Granules: 69/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or(and((prt_date in [11325, 11325]), (prt_id in [30, 30])), or(and((prt_date in [11324, 11324]), (prt_id in [20, 20])), and((prt_date in [11323, 11323]), (prt_id in [10, 10]))))
        Parts: 3/69
        Granules: 3/69
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or(and((prt_date in [11325, 11325]), (prt_id in [30, 30])), or(and((prt_date in [11324, 11324]), (prt_id in [20, 20])), and((prt_date in [11323, 11323]), (prt_id in [10, 10]))))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 231 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-20010101-,30-20010103-]
        Parts: 69/300
        Granules: 69/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or(and((prt_date in [11325, 11325]), (prt_id in [30, 30])), or(and((prt_date in [11324, 11324]), (prt_id in [20, 20])), and((prt_date in [11323, 11323]), (prt_id in [10, 10]))))
        Parts: 3/69
        Granules: 3/69
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or(and((prt_date in [11325, 11325]), (prt_id in [30, 30])), or(and((prt_date in [11324, 11324]), (prt_id in [20, 20])), and((prt_date in [11323, 11323]), (prt_id in [10, 10]))))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Condition: true
        Parts: 3/3
        Granules: 3/3
      Ranges: 3
PartitionPrefixFilterPrunedParts: 231 (increment)

Nested with IN sets (match-everything parts)

-- select * from partitioned_multi_table_uint_date where ((prt_id = 42 or prt_id = 43) and prt_date in ('2001-01-01', '2001-01-02')) or prt_id = 50
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,50-]
        Parts: 30/300
        Granules: 30/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or((prt_id in [50, 50]), and((prt_date in 2-element set), or((prt_id in [43, 43]), (prt_id in [42, 42]))))
        Parts: 7/30
        Granules: 7/30
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or((prt_id in [50, 50]), and((prt_date in 2-element set), or((prt_id in [43, 43]), (prt_id in [42, 42]))))
        Parts: 7/7
        Granules: 7/7
      PrimaryKey
        Condition: true
        Parts: 7/7
        Granules: 7/7
      Ranges: 7
PartitionPrefixFilterPrunedParts: 270 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,50-]
        Parts: 30/300
        Granules: 30/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or((prt_id in [50, 50]), and((prt_date in 2-element set), or((prt_id in [43, 43]), (prt_id in [42, 42]))))
        Parts: 7/30
        Granules: 7/30
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or((prt_id in [50, 50]), and((prt_date in 2-element set), or((prt_id in [43, 43]), (prt_id in [42, 42]))))
        Parts: 7/7
        Granules: 7/7
      PrimaryKey
        Condition: true
        Parts: 7/7
        Granules: 7/7
      Ranges: 7
PartitionPrefixFilterPrunedParts: 270 (increment)

Very deep: 6 levels of nesting

-- select * from partitioned_multi_table_uint_date where (((((prt_id = 10 or prt_id = 11) and prt_date >= '2001-01-01') or prt_id = 20) and prt_date <= '2001-01-03') or prt_id = 30) and prt_id < 100
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,30-]
        Parts: 69/300
        Granules: 69/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 99]), or((prt_id in [30, 30]), and((prt_date in (-Inf, 11325]), or((prt_id in [20, 20]), and((prt_date in [11323, +Inf)), or((prt_id in [11, 11]), (prt_id in [10, 10])))))))
        Parts: 12/69
        Granules: 12/69
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_id in (-Inf, 99]), or((prt_id in [30, 30]), and((prt_date in (-Inf, 11325]), or((prt_id in [20, 20]), and((prt_date in [11323, +Inf)), or((prt_id in [11, 11]), (prt_id in [10, 10])))))))
        Parts: 12/12
        Granules: 12/12
      PrimaryKey
        Condition: true
        Parts: 12/12
        Granules: 12/12
      Ranges: 12
PartitionPrefixFilterPrunedParts: 231 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [10-,30-]
        Parts: 69/300
        Granules: 69/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id in (-Inf, 99]), or((prt_id in [30, 30]), and((prt_date in (-Inf, 11325]), or((prt_id in [20, 20]), and((prt_date in [11323, +Inf)), or((prt_id in [11, 11]), (prt_id in [10, 10])))))))
        Parts: 12/69
        Granules: 12/69
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_id in (-Inf, 99]), or((prt_id in [30, 30]), and((prt_date in (-Inf, 11325]), or((prt_id in [20, 20]), and((prt_date in [11323, +Inf)), or((prt_id in [11, 11]), (prt_id in [10, 10])))))))
        Parts: 12/12
        Granules: 12/12
      PrimaryKey
        Condition: true
        Parts: 12/12
        Granules: 12/12
      Ranges: 12
PartitionPrefixFilterPrunedParts: 231 (increment)

Complex contradictions nested

-- select * from partitioned_multi_table_uint_date where (prt_id = 10 and prt_id = 20) or (prt_id = 30 and prt_date = '2001-01-01')
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [30-,30-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: or(and((prt_date in [11323, 11323]), (prt_id in [30, 30])), and((prt_id in [20, 20]), (prt_id in [10, 10])))
        Parts: 1/3
        Granules: 1/3
      Partition
        Keys:
          prt_id
          prt_date
        Condition: or(and((prt_date in [11323, 11323]), (prt_id in [30, 30])), and((prt_id in [20, 20]), (prt_id in [10, 10])))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [30-20010101-,30-20010101-]
        Parts: 1/300
        Granules: 1/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_date in [11323, 11323]), (prt_id in [30, 30]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_date in [11323, 11323]), (prt_id in [30, 30]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
PartitionPrefixFilterPrunedParts: 299 (increment)

Nested with NULL checks

-- select * from partitioned_multi_table_uint_date where ((prt_id = 42 and prt_date is not null) or (prt_id = 43 and prt_date is not null)) and prt_id is not null
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,43-]
        Parts: 6/300
        Granules: 6/0
      MinMax
        Keys:
          prt_date
          prt_id
        Condition: and((prt_id isNotNull), or(and((prt_date isNotNull), (prt_id in [43, 43])), and((prt_date isNotNull), (prt_id in [42, 42]))))
        Parts: 6/6
        Granules: 6/6
      Partition
        Keys:
          prt_id
          prt_date
        Condition: and((prt_id isNotNull), or(and((prt_date isNotNull), (prt_id in [43, 43])), and((prt_date isNotNull), (prt_id in [42, 42]))))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 294 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Filter ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [42-,43-]
        Parts: 6/300
        Granules: 6/0
      MinMax
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      Partition
        Keys:
          prt_id
        Condition: or((prt_id in [43, 43]), (prt_id in [42, 42]))
        Parts: 6/6
        Granules: 6/6
      PrimaryKey
        Condition: true
        Parts: 6/6
        Granules: 6/6
      Ranges: 6
PartitionPrefixFilterPrunedParts: 294 (increment)

Edge cases

-- select * from partitioned_multi_table_uint_date where prt_id > 100
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [101, +Inf))
        Parts: 0/300
        Granules: 0/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [101, +Inf))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [101, +Inf))
        Parts: 0/300
        Granules: 0/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [101, +Inf))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Condition: true
        Parts: 0/0
        Granules: 0/0
      Ranges: 0

-- select * from partitioned_multi_table_uint_date where prt_id >= 0
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_multi_table_uint_date)
    Indexes:
      PartitionPrefix
        Condition: [,]
        Parts: 300/300
        Granules: 300/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 300/300
        Granules: 300/300
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 300/300
        Granules: 300/300
      PrimaryKey
        Condition: true
        Parts: 300/300
        Granules: 300/300
      Ranges: 300

==== transformed timestamp partitioning

-- select * from partitioned_uint_toYYYYMMDD where uint = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYYYYMMDD)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 3/3
        Granules: 3/3
        Search Algorithm: binary search
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYYYYMMDD)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 3/3
        Granules: 3/3
        Search Algorithm: binary search
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)

-- select * from partitioned_uint_toYYYYMMDD where uint = 42 and timestamp >= '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYYYYMMDD)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          uint
          toYYYYMMDD(timestamp)
        Condition: and((toYYYYMMDD(timestamp) in [20010101, +Inf)), (uint in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 3/3
        Granules: 3/3
        Search Algorithm: generic exclusion search
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYYYYMMDD)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 3/300
        Granules: 3/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      Partition
        Keys:
          uint
          toYYYYMMDD(timestamp)
        Condition: and((toYYYYMMDD(timestamp) in [20010101, +Inf)), (uint in [42, 42]))
        Parts: 3/3
        Granules: 3/3
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 3/3
        Granules: 3/3
        Search Algorithm: generic exclusion search
      Ranges: 3
PartitionPrefixFilterPrunedParts: 297 (increment)

-- select * from partitioned_uint_toYYYYMM where uint = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYYYYMM)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: binary search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYYYYMM)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: binary search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_uint_toYYYYMM where uint = 42 and timestamp >= '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYYYYMM)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
          toYYYYMM(timestamp)
        Condition: and((toYYYYMM(timestamp) in [200101, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: generic exclusion search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYYYYMM)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
          toYYYYMM(timestamp)
        Condition: and((toYYYYMM(timestamp) in [200101, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: generic exclusion search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_uint_toYYYYMM where uint = 42 and timestamp >= '2001-06-06'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYYYYMM)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/1
        Granules: 0/1
      Partition
        Keys:
          uint
          toYYYYMM(timestamp)
        Condition: and((toYYYYMM(timestamp) in [200106, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYYYYMM)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/1
        Granules: 0/1
      Partition
        Keys:
          uint
          toYYYYMM(timestamp)
        Condition: and((toYYYYMM(timestamp) in [200106, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_uint_toYear where uint = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYear)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: binary search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYear)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: binary search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_uint_toYear where uint = 42 and timestamp >= '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYear)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
          toYear(timestamp)
        Condition: and((toYear(timestamp) in [2001, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: generic exclusion search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYear)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
          toYear(timestamp)
        Condition: and((toYear(timestamp) in [2001, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: generic exclusion search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_uint_toYear where uint = 42 and timestamp >= '2001-06-06'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toYear)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/1
        Granules: 0/1
      Partition
        Keys:
          uint
          toYear(timestamp)
        Condition: and((toYear(timestamp) in [2001, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toYear)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/1
        Granules: 0/1
      Partition
        Keys:
          uint
          toYear(timestamp)
        Condition: and((toYear(timestamp) in [2001, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [991785600, +Inf)), (uint in [42, 42]))
        Parts: 0/0
        Granules: 0/0
      Ranges: 0
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_uint_toMonth where uint = 42
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toMonth)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: binary search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toMonth)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: binary search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

-- select * from partitioned_uint_toMonth where uint = 42 and timestamp >= '2001-01-01'
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_uint_toMonth)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: generic exclusion search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_uint_toMonth)
    Indexes:
      PartitionPrefix
        Condition: [42-,42-]
        Parts: 1/100
        Granules: 1/0
      MinMax
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
      Partition
        Keys:
          uint
        Condition: (uint in [42, 42])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Keys:
          uint
          timestamp
        Condition: and((timestamp in [978307200, +Inf)), (uint in [42, 42]))
        Parts: 1/1
        Granules: 1/1
        Search Algorithm: generic exclusion search
      Ranges: 1
PartitionPrefixFilterPrunedParts: 99 (increment)

==== Signed integer partition key (should not use prefix filtering)

-- select * from partitioned_signed_int where prt_id = 10
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_signed_int)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [10, 10])
        Parts: 1/100
        Granules: 1/100
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [10, 10])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_signed_int)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [10, 10])
        Parts: 1/100
        Granules: 1/100
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [10, 10])
        Parts: 1/1
        Granules: 1/1
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Ranges: 1

-- select * from partitioned_signed_int where prt_id >= -10 and prt_id <= 10
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_signed_int)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 10]), (prt_id in [-10, +Inf)))
        Parts: 21/100
        Granules: 21/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 10]), (prt_id in [-10, +Inf)))
        Parts: 21/21
        Granules: 21/21
      PrimaryKey
        Condition: true
        Parts: 21/21
        Granules: 21/21
      Ranges: 21
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_signed_int)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 10]), (prt_id in [-10, +Inf)))
        Parts: 21/100
        Granules: 21/100
      Partition
        Keys:
          prt_id
        Condition: and((prt_id in (-Inf, 10]), (prt_id in [-10, +Inf)))
        Parts: 21/21
        Granules: 21/21
      PrimaryKey
        Condition: true
        Parts: 21/21
        Granules: 21/21
      Ranges: 21

-- select * from partitioned_signed_int where prt_id >= 0
-- enable_analyzer=0
Expression ((Projection + Before ORDER BY))
  Expression (WHERE)
    ReadFromMergeTree (default.partitioned_signed_int)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 50/100
        Granules: 50/100
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 50/50
        Granules: 50/50
      PrimaryKey
        Condition: true
        Parts: 50/50
        Granules: 50/50
      Ranges: 50
-- enable_analyzer=1
Expression ((Project names + Projection))
  Expression ((WHERE + Change column names to column identifiers))
    ReadFromMergeTree (default.partitioned_signed_int)
    Indexes:
      PartitionPrefix
        Condition: [,] (partition key not represented by unsigned integer)
        Parts: 100/100
        Granules: 100/0
      MinMax
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 50/100
        Granules: 50/100
      Partition
        Keys:
          prt_id
        Condition: (prt_id in [0, +Inf))
        Parts: 50/50
        Granules: 50/50
      PrimaryKey
        Condition: true
        Parts: 50/50
        Granules: 50/50
      Ranges: 50
