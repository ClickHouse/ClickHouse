SELECT removeGarbageParametersFromURL('http://yandex.ru/clck/jsredir?from=yandex.ru;search%2F;web;;&text=&etext=1004&cst=AiuY0DBWFJ5Hyx_fyvalFPA3abBqdnSOApSiLPWwVkIeiz46AroRCQXrfJ8M5oYTWorWEWccK4Kw_QEhSDD6X4nGMT4OabEk0xnry4NtnOEzWFPU4iTzunSVVjkuY7CYolnD7hb04cMRv7iMnaO8LjNm0hxqvwN9sXCzUYeXp_muLsdY4W99_U5MJKGmz7IAmR5-ceoAoaBB2XGYAS9BTYKbbvlmneBpbf_SwAd_6OOACXtLmRXqXad3AQbcArYE8LCO0zmE9vpha3yoT0jl8pd9CUmbGZR5nA3sf5TcDFTpr5nYaOdxjmHep2cZeW3QHvPtKA2xWXW6qzGrQeZ1SEOPcJ1afJqmAHisup90hhNYyl2hxl8xn_DtCRbJqYHb88JtuQ3591EGW42wPZhSbxBFdU0KIZN3c_VZOmk6avzKzqG_kJpjPObWXbh9qs0S23WxDGCcPUrIzi3ESSLv1qgaRhqkfjBc57BFVA4RxlljpKQdeVeTbklJgqptznf1aHZQ2wYARBzC_jvv994MCTZIus_NctCMWoSaU74OaMmo0h5ScYLI2CWy6nj5PbhCrgeLsaEBVOQT9xoLSoCRfJ78xI_T1ruuD3QBJmHY6YW8f5UM36LRbzhd5vmNTPRvrs2wcCFhF_w&l10n=ru&cts=1458904227333&mc=1.584962500721156', 0);
SELECT removeGarbageParametersFromURL('http://yandex.ru/clck/jsredir?from=yandex.ru;search%2F;web;;&text=&etext=1004&cst=AiuY0DBWFJ5Hyx_fyvalFPA3abBqdnSOApSiLPWwVkIeiz46AroRCQXrfJ8M5oYTWorWEWccK4Kw_QEhSDD6X4nGMT4OabEk0xnry4NtnOEzWFPU4iTzunSVVjkuY7CYolnD7hb04cMRv7iMnaO8LjNm0hxqvwN9sXCzUYeXp_muLsdY4W99_U5MJKGmz7IAmR5-ceoAoaBB2XGYAS9BTYKbbvlmneBpbf_SwAd_6OOACXtLmRXqXad3AQbcArYE8LCO0zmE9vpha3yoT0jl8pd9CUmbGZR5nA3sf5TcDFTpr5nYaOdxjmHep2cZeW3QHvPtKA2xWXW6qzGrQeZ1SEOPcJ1afJqmAHisup90hhNYyl2hxl8xn_DtCRbJqYHb88JtuQ3591EGW42wPZhSbxBFdU0KIZN3c_VZOmk6avzKzqG_kJpjPObWXbh9qs0S23WxDGCcPUrIzi3ESSLv1qgaRhqkfjBc57BFVA4RxlljpKQdeVeTbklJgqptznf1aHZQ2wYARBzC_jvv994MCTZIus_NctCMWoSaU74OaMmo0h5ScYLI2CWy6nj5PbhCrgeLsaEBVOQT9xoLSoCRfJ78xI_T1ruuD3QBJmHY6YW8f5UM36LRbzhd5vmNTPRvrs2wcCFhF_w&l10n=ru&cts=1458904227333&mc=1.584962500721156', 13);
SELECT removeGarbageParametersFromURL('http://yandex.ru/clck/jsredir?from=yandex.ru;search%2F;web;;&text=&etext=1004&cst=AiuY0DBWFJ5Hyx_fyvalFPA3abBqdnSOApSiLPWwVkIeiz46AroRCQXrfJ8M5oYTWorWEWccK4Kw_QEhSDD6X4nGMT4OabEk0xnry4NtnOEzWFPU4iTzunSVVjkuY7CYolnD7hb04cMRv7iMnaO8LjNm0hxqvwN9sXCzUYeXp_muLsdY4W99_U5MJKGmz7IAmR5-ceoAoaBB2XGYAS9BTYKbbvlmneBpbf_SwAd_6OOACXtLmRXqXad3AQbcArYE8LCO0zmE9vpha3yoT0jl8pd9CUmbGZR5nA3sf5TcDFTpr5nYaOdxjmHep2cZeW3QHvPtKA2xWXW6qzGrQeZ1SEOPcJ1afJqmAHisup90hhNYyl2hxl8xn_DtCRbJqYHb88JtuQ3591EGW42wPZhSbxBFdU0KIZN3c_VZOmk6avzKzqG_kJpjPObWXbh9qs0S23WxDGCcPUrIzi3ESSLv1qgaRhqkfjBc57BFVA4RxlljpKQdeVeTbklJgqptznf1aHZQ2wYARBzC_jvv994MCTZIus_NctCMWoSaU74OaMmo0h5ScYLI2CWy6nj5PbhCrgeLsaEBVOQT9xoLSoCRfJ78xI_T1ruuD3QBJmHY6YW8f5UM36LRbzhd5vmNTPRvrs2wcCFhF_w&l10n=ru&cts=1458904227333&mc=1.584962500721156', 14);
SELECT removeGarbageParametersFromURL('http://ya.ru/?param=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef', 0);
CREATE TABLE test.hits
(
    URL String
)
ENGINE = MergeTree();
INSERT INTO test.hits (URL) VALUES
    ('http://webmodelka/118820005260808&cond=onair.html%3Fbprtment-arizm.ru/task/12810faSOWQ%3D%3DfrSMw%3D%3DfsSaHR0cDovL21lbWJlcmxpYWV0c2tv.ru/s/21/03/20/region;noagent.do?NextServingatlanakomster-dzhemchura.ru%2fcity=on&default-summessage/2229000012173/tuk196EII5dZrmAg'),
    ('http://webmodelka/118820005260808&cond=onair.html%3Fbprtment-arizm.ru/task/12810faSOWQ%3D%3DfrSMw%3D%3DfsSaHR0cDovL21lbWJlcmxpYWV0c2tv.ru/s/21/03/20/region;noagent.do?NextServingatlanakomster-dzhemchura.ru%2fcity=on&default-summessage/2229000012173/tuk196EII5dZrmAg'),
    ('http://webmodelka/118820005260808&cond=onair.html%3Fbprtment-arizm.ru/task/12810faSOWQ%3D%3DfrSMw%3D%3DfsSaHR0cDovL21lbWJlcmxpYWV0c2tv.ru/s/21/03/20/region;noagent.do?NextServingatlanakomster-dzhemchura.ru%2fcity=on&default-summessage/2229000012173/tuk196EII5dZrmAg'),
    ('http://hurpasspx?EntityType=images.jpg,http:%2F%2Fweb%2Fimages'),
    ('http://webmodelka/118820005260808&cond=onair.html%3Fbprtment-arizm.ru/task/12810faSOWQ%3D%3DfrSMw%3D%3DfsSaHR0cDovL21lbWJlcmxpYWV0c2tv.ru/s/21/03/20/region;noagent.do?NextServingatlanakomster-dzhemchura.ru%2fcity=on&default-summessage/2229000012173/tuk196EII5dZrmAg'),
    ('http://webmodelka/118820005260808&cond=onair.html%3Fbprtment-arizm.ru/task/12810faSOWQ%3D%3DfrSMw%3D%3DfsSaHR0cDovL21lbWJlcmxpYWV0c2tv.ru/s/21/03/20/region;noagent.do?NextServingatlanakomster-dzhemchura.ru%2fcity=on&default-summessage/2229000012173/tuk196EII5dZrmAg'),
    ('http://hurpasspx?EntityType=images.jpg,http:%2F%2Fweb%2Fimages'),
    ('http://hurpasspx?EntityType=images.jpg,http:%2F%2Fweb%2Fimages'),
    ('http://webmodelka/118820005260808&cond=onair.html%3Fbprtment-arizm.ru/task/12810faSOWQ%3D%3DfrSMw%3D%3DfsSaHR0cDovL21lbWJlcmxpYWV0c2tv.ru/s/21/03/20/region;noagent.do?NextServingatlanakomster-dzhemchura.ru%2fcity=on&default-summessage/2229000012173/tuk196EII5dZrmAg'),
    ('http://webmodelka/118820005260808&cond=onair.html%3Fbprtment-arizm.ru/task/12810faSOWQ%3D%3DfrSMw%3D%3DfsSaHR0cDovL21lbWJlcmxpYWV0c2tv.ru/s/21/03/20/region;noagent.do?NextServingatlanakomster-dzhemchura.ru%2fcity=on&default-summessage/2229000012173/tuk196EII5dZrmAg');

SELECT removeGarbageParametersFromURL(URL, 0) FROM test.hits LIMIT 10;
SELECT removeGarbageParametersFromURL('http://ya.ru/?param=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef', 0) FROM test.hits LIMIT 10;
DROP TABLE test.hits;