-- t1_value does not look correct
-- let's only check that output is not changed

-- { echoOn }

SELECT 'First JOIN LEFT second JOIN INNER';
First JOIN LEFT second JOIN INNER
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
INNER JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
16974962042730899080	900
SELECT 'First JOIN LEFT second JOIN LEFT';
First JOIN LEFT second JOIN LEFT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
LEFT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
16974962042730899080	900
SELECT 'First JOIN LEFT second JOIN RIGHT';
First JOIN LEFT second JOIN RIGHT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
RIGHT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
4391728079814366501	1544
SELECT 'First JOIN LEFT second JOIN FULL';
First JOIN LEFT second JOIN FULL
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
FULL JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
4391728079814366501	1544
SELECT 'First JOIN LEFT second JOIN INNER';
First JOIN LEFT second JOIN INNER
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
INNER JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
16974962042730899080	900
SELECT 'First JOIN LEFT second JOIN LEFT';
First JOIN LEFT second JOIN LEFT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
LEFT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
16974962042730899080	900
SELECT 'First JOIN LEFT second JOIN RIGHT';
First JOIN LEFT second JOIN RIGHT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
RIGHT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
4391728079814366501	1544
SELECT 'First JOIN LEFT second JOIN FULL';
First JOIN LEFT second JOIN FULL
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
LEFT JOIN test_table_join_2 AS t2 USING (id)
FULL JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
4391728079814366501	1544
