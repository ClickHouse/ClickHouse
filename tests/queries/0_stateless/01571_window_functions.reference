-- { echo }
-- Another test for window functions because the other one is too long.
set allow_experimental_window_functions = 1;
-- expressions in window frame
select count() over (rows between 1 + 1 preceding and 1 + 1 following) from numbers(10);
3
4
5
5
5
5
5
5
4
3
-- signed and unsigned in offset do not cause logical error
select count() over (rows between 2 following and 1 + -1 following) FROM numbers(10); -- { serverError 36 }
-- default arguments of lagInFrame can be a subtype of the argument
select number,
    lagInFrame(toNullable(number), 2, null) over w,
    lagInFrame(number, 2, 1) over w
from numbers(10)
window w as (order by number)
;
0	\N	1
1	\N	1
2	0	0
3	1	1
4	2	2
5	3	3
6	4	4
7	5	5
8	6	6
9	7	7
