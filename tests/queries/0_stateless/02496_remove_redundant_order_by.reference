-- Disable query_plan_remove_redundant_order_by
-- ORDER BY clauses in subqueries are untouched
Expression (Project names)
Header: number UInt64
  Sorting (Sorting for ORDER BY)
  Header: number_0 UInt64
    Expression ((Before ORDER BY + (Projection + (Change column names to column identifiers + Project names))))
    Header: number_0 UInt64
      Sorting (Sorting for ORDER BY)
      Header: number_1 UInt64
        Expression ((Before ORDER BY + (Projection + (Change column names to column identifiers + Project names))))
        Header: number_1 UInt64
          Sorting (Sorting for ORDER BY)
          Header: number_2 UInt64
            Expression ((Before ORDER BY + (Projection + Change column names to column identifiers)))
            Header: number_2 UInt64
              ReadFromStorage (SystemNumbers)
              Header: number UInt64
-- Enable query_plan_remove_redundant_order_by
-- ORDER BY removes ORDER BY clauses in subqueries
Expression (Project names)
Header: number UInt64
  Sorting (Sorting for ORDER BY)
  Header: number_0 UInt64
    Expression ((Before ORDER BY + (Projection + (Change column names to column identifiers + (Project names + (Before ORDER BY + (Projection + (Change column names to column identifiers + (Project names + (Before ORDER BY + (Projection + Change column names to column identifiers)))))))))))
    Header: number_0 UInt64
      ReadFromStorage (SystemNumbers)
      Header: number UInt64
-- ORDER BY cannot remove ORDER BY in subquery WITH FILL
Expression (Project names)
Header: number UInt64
  Sorting (Sorting for ORDER BY)
  Header: number_0 UInt64
    Expression ((Before ORDER BY + (Projection + (Change column names to column identifiers + Project names))))
    Header: number_0 UInt64
      Filling
      Header: number_1 UInt64
        Sorting (Sorting for ORDER BY)
        Header: number_1 UInt64
          Expression ((Before ORDER BY + (Projection + (Change column names to column identifiers + (Project names + (Before ORDER BY + (Projection + Change column names to column identifiers)))))))
          Header: number_1 UInt64
            ReadFromStorage (SystemNumbers)
            Header: number UInt64
-- ORDER BY cannot remove ORDER BY in subquery with LIMIT BY
Expression (Project names)
Header: number UInt64
  Sorting (Sorting for ORDER BY)
  Header: number_0 UInt64
    Expression ((Before ORDER BY + (Projection + (Change column names to column identifiers + Project names))))
    Header: number_0 UInt64
      LimitBy
      Header: number_1 UInt64
        Expression (Before LIMIT BY)
        Header: number_1 UInt64
          Sorting (Sorting for ORDER BY)
          Header: number_1 UInt64
            Expression ((Before ORDER BY + (Projection + (Change column names to column identifiers + (Project names + (Before ORDER BY + (Projection + Change column names to column identifiers)))))))
            Header: number_1 UInt64
              ReadFromStorage (SystemNumbers)
              Header: number UInt64
-- GROUP BY removes ORDER BY in _all_ subqueries
Expression ((Project names + Projection))
Header: number UInt64
  Aggregating
  Header: number_0 UInt64
    Expression ((Before GROUP BY + (Change column names to column identifiers + (Project names + (Before ORDER BY + (Projection + (Change column names to column identifiers + (Project names + (Before ORDER BY + (Projection + Change column names to column identifiers))))))))))
    Header: number_0 UInt64
      ReadFromStorage (SystemNumbers)
      Header: number UInt64
