SELECT number FROM numbers(1000000) LIMIT -1;

SELECT count() FROM (SELECT number FROM numbers(1000000) LIMIT -70000);
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000) LIMIT 10;
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000) LIMIT -10;

SELECT count() FROM (SELECT number FROM numbers(1000000) LIMIT -70000 OFFSET -100000);
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000 OFFSET -100000) LIMIT 10;
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000 OFFSET -100000) LIMIT -10;

SELECT count() FROM (SELECT number FROM numbers(1000000) OFFSET -100000);
SELECT * FROM (SELECT number FROM numbers(1000000) OFFSET -100000) LIMIT 10;
SELECT * FROM (SELECT number FROM numbers(1000000) OFFSET -100000) LIMIT -10;

SELECT number FROM numbers(1000000) LIMIT 0 OFFSET -900000;
SELECT number FROM numbers(1000000) LIMIT -10 OFFSET 0;
SELECT number FROM numbers(1000000) LIMIT -18446744073709550000 OFFSET -999990;

SELECT DISTINCT number FROM numbers(1000000) LIMIT -1;
SELECT number FROM numbers(1000000) ORDER BY number LIMIT -1;
SELECT DISTINCT number FROM numbers(1000000) OFFSET -999999;
SELECT number FROM numbers(1000000) ORDER BY number OFFSET -999999;
SELECT DISTINCT number FROM numbers(1000000) LIMIT -1 OFFSET -999999;
SELECT number FROM numbers(1000000) ORDER BY number LIMIT -1 OFFSET -999999;

SELECT number FROM numbers(1000000) LIMIT 5 OFFSET -999990; -- { serverError INVALID_LIMIT_EXPRESSION }
SELECT number FROM numbers(1000000) LIMIT -5 OFFSET 999990; -- { serverError INVALID_LIMIT_EXPRESSION }
SELECT number FROM numbers(1000000) LIMIT -18446744073709551615; -- { serverError INVALID_LIMIT_EXPRESSION }
SELECT number FROM numbers(1000000) OFFSET -18446744073709551615; -- { serverError INVALID_LIMIT_EXPRESSION }

SET allow_experimental_analyzer = 1;

SELECT number FROM numbers(1000000) LIMIT -1;

SELECT count() FROM (SELECT number FROM numbers(1000000) LIMIT -70000);
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000) LIMIT 10;
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000) LIMIT -10;

SELECT count() FROM (SELECT number FROM numbers(1000000) LIMIT -70000 OFFSET -100000);
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000 OFFSET -100000) LIMIT 10;
SELECT * FROM (SELECT number FROM numbers(1000000) LIMIT -70000 OFFSET -100000) LIMIT -10;

SELECT count() FROM (SELECT number FROM numbers(1000000) OFFSET -100000);
SELECT * FROM (SELECT number FROM numbers(1000000) OFFSET -100000) LIMIT 10;
SELECT * FROM (SELECT number FROM numbers(1000000) OFFSET -100000) LIMIT -10;

SELECT number FROM numbers(1000000) LIMIT 0 OFFSET -900000;
SELECT number FROM numbers(1000000) LIMIT -10 OFFSET 0;
SELECT number FROM numbers(1000000) LIMIT -18446744073709550000 OFFSET -999990;

SELECT DISTINCT number FROM numbers(1000000) LIMIT -1;
SELECT number FROM numbers(1000000) ORDER BY number LIMIT -1;
SELECT DISTINCT number FROM numbers(1000000) OFFSET -999999;
SELECT number FROM numbers(1000000) ORDER BY number OFFSET -999999;
SELECT DISTINCT number FROM numbers(1000000) LIMIT -1 OFFSET -999999;
SELECT number FROM numbers(1000000) ORDER BY number LIMIT -1 OFFSET -999999;

SELECT number FROM numbers(1000000) LIMIT 5 OFFSET -999990; -- { serverError INVALID_LIMIT_EXPRESSION }
SELECT number FROM numbers(1000000) LIMIT -5 OFFSET 999990; -- { serverError INVALID_LIMIT_EXPRESSION }
SELECT number FROM numbers(1000000) LIMIT -18446744073709551615; -- { serverError INVALID_LIMIT_EXPRESSION }
SELECT number FROM numbers(1000000) OFFSET -18446744073709551615; -- { serverError INVALID_LIMIT_EXPRESSION }
