1	A	100
1	A	200
1	B	300
2	A	400
2	A	500
2	B	600
3	C	700
1	A	2
1	B	1
2	A	2
2	B	1
3	C	1
1	A	A_item1
1	A	A_item2
1	B	B_item3
2	A	A_item4
2	A	A_item5
2	B	B_item6
3	C	C_item7
1	A	100
1	A	200
1	B	300
2	A	400
2	A	500
2	B	600
3	C	700
1	A	100
1	A	200
1	B	300
2	A	400
2	A	500
2	B	600
3	C	700
SELECT
    id,
    category,
    value,
    rand() AS r
FROM test_limit_by_all
ORDER BY
    id ASC,
    category ASC,
    value ASC
LIMIT 1 BY ALL
QUERY id: 0
  PROJECTION COLUMNS
    id Int32
    category String
    value Int32
  PROJECTION
    LIST id: 1, nodes: 3
      COLUMN id: 2, column_name: id, result_type: Int32, source_id: 3
      COLUMN id: 4, column_name: category, result_type: String, source_id: 3
      COLUMN id: 5, column_name: value, result_type: Int32, source_id: 3
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.test_limit_by_all
  ORDER BY
    LIST id: 6, nodes: 3
      SORT id: 7, sort_direction: ASCENDING, with_fill: 0
        EXPRESSION
          COLUMN id: 8, column_name: id, result_type: Int32, source_id: 3
      SORT id: 9, sort_direction: ASCENDING, with_fill: 0
        EXPRESSION
          COLUMN id: 10, column_name: category, result_type: String, source_id: 3
      SORT id: 11, sort_direction: ASCENDING, with_fill: 0
        EXPRESSION
          COLUMN id: 12, column_name: value, result_type: Int32, source_id: 3
  LIMIT BY LIMIT
    CONSTANT id: 13, constant_value: UInt64_1, constant_value_type: UInt64
  LIMIT BY
    LIST id: 14, nodes: 3
      COLUMN id: 15, column_name: id, result_type: Int32, source_id: 3
      COLUMN id: 16, column_name: category, result_type: String, source_id: 3
      COLUMN id: 17, column_name: value, result_type: Int32, source_id: 3
1	A	100	1
1	A	200	2
1	B	300	1
1	B	300
2	A	400
2	A	500
2	B	600
3	C	700
1	A
1	B
2	A
2	B
3	C
1	A	100	item1
1	A	200	item2
1	B	300	item3
2	A	400	item4
2	A	500	item5
2	B	600	item6
3	C	700	item7
1
2
3
1	A
1	B
2025-01-01 00:00:00	A	2
2025-01-01 00:00:00	B	2
2025-01-01 00:00:00	C	1
1	A
2	A
1	A
2	A
3	C
2	B
SELECT
    t.id,
    tag,
    sum(value) AS s
FROM test_limit_by_all AS t
ALL LEFT JOIN test_limit_by_all_tags AS g USING (id)
ARRAY JOIN g.tags AS tag
GROUP BY
    t.id,
    tag
ORDER BY
    t.id ASC,
    tag ASC
LIMIT 1 BY ALL
1	x
1	y
2	y
3	z
2025-01-01 12:00:00	A
2025-01-01 12:00:00	B
2025-01-01 12:00:00	C
1	A	200
1	B	300
2	A	500
2	B	600
1	A	200
1	B	300
2	A	500
2	B	600
SELECT
    id,
    category,
    value
FROM test_limit_by_all
ORDER BY
    1 ASC,
    2 ASC,
    3 ASC
LIMIT 2 BY
    1,
    2
SETTINGS enable_positional_arguments = 1
2	B	600
3	C	700
2	A	500
2	B	600
1	2
2	2
3	1
1	A
1	B
2	A
2	B
3	C
4	
