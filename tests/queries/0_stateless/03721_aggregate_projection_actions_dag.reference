Expression ((Project names + Projection))
  Aggregating
    Expression (((Before GROUP BY + ) + Discarding unused columns))
      Expression (Post Join Actions)
        Join (JOIN FillRightFirst)
          Expression (Left Pre Join Actions)
            Expression (Post Join Actions)
              Join (JOIN FillRightFirst)
                Expression (Left Pre Join Actions)
                  Filter ((WHERE + (Change column names to column identifiers + (Project names + Projection))))
                    Window (Window step for window \'PARTITION BY __table3.key\')
                      Sorting (Sorting for window \'PARTITION BY __table3.key\')
                        Expression ((Before WINDOW + Change column names to column identifiers))
                          ReadFromMergeTree (default.test)
                Expression (Right Pre Join Actions)
                  Filter ((((WHERE + (Change column names to column identifiers + (Project names + (Projection + )))) + ) + (Change column names to column identifiers + (Project names + Projection))))
                    Aggregating
                      Expression ((Before GROUP BY + Change column names to column identifiers))
                        ReadFromMergeTree (default.test)
          Expression (Right Pre Join Actions)
            Expression ((Change column names to column identifiers + (Project names + Projection)))
              Aggregating
                Expression ((Before GROUP BY + Change column names to column identifiers))
                  ReadFromMergeTree (default.test)
