set optimize_duplicate_order_by_and_distinct = 1
QUERY id: 0
  PROJECTION COLUMNS
    number UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      COLUMN id: 2, column_name: number, result_type: UInt64, source_id: 3
  JOIN TREE
    QUERY id: 3, is_subquery: 1, is_distinct: 1
      PROJECTION COLUMNS
        number UInt64
      PROJECTION
        LIST id: 4, nodes: 1
          COLUMN id: 5, column_name: number, result_type: UInt64, source_id: 6
      JOIN TREE
        TABLE_FUNCTION id: 6, table_function_name: numbers
          ARGUMENTS
            LIST id: 7, nodes: 1
              CONSTANT id: 8, constant_value: UInt64_3, constant_value_type: UInt8
QUERY id: 0
  PROJECTION COLUMNS
    t UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      COLUMN id: 2, column_name: t, result_type: UInt64, source_id: 3
  JOIN TREE
    QUERY id: 3, is_subquery: 1, is_distinct: 1
      PROJECTION COLUMNS
        t UInt64
      PROJECTION
        LIST id: 4, nodes: 1
          COLUMN id: 5, column_name: number, result_type: UInt64, source_id: 6
      JOIN TREE
        TABLE_FUNCTION id: 6, table_function_name: numbers
          ARGUMENTS
            LIST id: 7, nodes: 1
              CONSTANT id: 8, constant_value: UInt64_3, constant_value_type: UInt8
QUERY id: 0
  PROJECTION COLUMNS
    number UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      COLUMN id: 2, column_name: number, result_type: UInt64, source_id: 3
  JOIN TREE
    QUERY id: 3, is_subquery: 1
      PROJECTION COLUMNS
        number UInt64
      PROJECTION
        LIST id: 4, nodes: 1
          COLUMN id: 5, column_name: number, result_type: UInt64, source_id: 6
      JOIN TREE
        QUERY id: 6, is_subquery: 1, is_distinct: 1
          PROJECTION COLUMNS
            number UInt64
          PROJECTION
            LIST id: 7, nodes: 1
              COLUMN id: 8, column_name: number, result_type: UInt64, source_id: 9
          JOIN TREE
            TABLE_FUNCTION id: 9, table_function_name: numbers
              ARGUMENTS
                LIST id: 10, nodes: 1
                  CONSTANT id: 11, constant_value: UInt64_3, constant_value_type: UInt8
set optimize_duplicate_order_by_and_distinct = 0
QUERY id: 0, is_distinct: 1
  PROJECTION COLUMNS
    number UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      COLUMN id: 2, column_name: number, result_type: UInt64, source_id: 3
  JOIN TREE
    QUERY id: 3, is_subquery: 1, is_distinct: 1
      PROJECTION COLUMNS
        number UInt64
      PROJECTION
        LIST id: 4, nodes: 1
          COLUMN id: 5, column_name: number, result_type: UInt64, source_id: 6
      JOIN TREE
        TABLE_FUNCTION id: 6, table_function_name: numbers
          ARGUMENTS
            LIST id: 7, nodes: 1
              CONSTANT id: 8, constant_value: UInt64_3, constant_value_type: UInt8
QUERY id: 0, is_distinct: 1
  PROJECTION COLUMNS
    t UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      COLUMN id: 2, column_name: t, result_type: UInt64, source_id: 3
  JOIN TREE
    QUERY id: 3, is_subquery: 1, is_distinct: 1
      PROJECTION COLUMNS
        t UInt64
      PROJECTION
        LIST id: 4, nodes: 1
          COLUMN id: 5, column_name: number, result_type: UInt64, source_id: 6
      JOIN TREE
        TABLE_FUNCTION id: 6, table_function_name: numbers
          ARGUMENTS
            LIST id: 7, nodes: 1
              CONSTANT id: 8, constant_value: UInt64_3, constant_value_type: UInt8
QUERY id: 0, is_distinct: 1
  PROJECTION COLUMNS
    number UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      COLUMN id: 2, column_name: number, result_type: UInt64, source_id: 3
  JOIN TREE
    QUERY id: 3, is_subquery: 1
      PROJECTION COLUMNS
        number UInt64
      PROJECTION
        LIST id: 4, nodes: 1
          COLUMN id: 5, column_name: number, result_type: UInt64, source_id: 6
      JOIN TREE
        QUERY id: 6, is_subquery: 1, is_distinct: 1
          PROJECTION COLUMNS
            number UInt64
          PROJECTION
            LIST id: 7, nodes: 1
              COLUMN id: 8, column_name: number, result_type: UInt64, source_id: 9
          JOIN TREE
            TABLE_FUNCTION id: 9, table_function_name: numbers
              ARGUMENTS
                LIST id: 10, nodes: 1
                  CONSTANT id: 11, constant_value: UInt64_3, constant_value_type: UInt8
