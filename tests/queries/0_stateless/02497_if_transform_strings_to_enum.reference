other
other
google
other
censor.net
other
yahoo
other
other
other
SELECT transform(number, [2, 4, 6], _CAST([\'google\', \'censor.net\', \'yahoo\'], \'Array(Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2, \\\'other\\\' = 3, \\\'yahoo\\\' = 4))\'), _CAST(\'other\', \'Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2, \\\'other\\\' = 3, \\\'yahoo\\\' = 4)\'))
FROM system.numbers
LIMIT 10
QUERY id: 0
  PROJECTION COLUMNS
    transform(number, [2, 4, 6], [\'google\', \'censor.net\', \'yahoo\'], \'other\') String
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: transform, function_type: ordinary, result_type: String
        ARGUMENTS
          LIST id: 3, nodes: 4
            COLUMN id: 4, column_name: number, result_type: UInt64, source_id: 5
            CONSTANT id: 6, constant_value: Array_[UInt64_2, UInt64_4, UInt64_6], constant_value_type: Array(UInt8)
            FUNCTION id: 7, function_name: _CAST, function_type: ordinary, result_type: Array(Enum8(\'censor.net\' = 1, \'google\' = 2, \'other\' = 3, \'yahoo\' = 4))
              ARGUMENTS
                LIST id: 8, nodes: 2
                  CONSTANT id: 9, constant_value: Array_[\'google\', \'censor.net\', \'yahoo\'], constant_value_type: Array(String)
                  CONSTANT id: 10, constant_value: \'Array(Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2, \\\'other\\\' = 3, \\\'yahoo\\\' = 4))\', constant_value_type: String
            FUNCTION id: 11, function_name: _CAST, function_type: ordinary, result_type: Enum8(\'censor.net\' = 1, \'google\' = 2, \'other\' = 3, \'yahoo\' = 4)
              ARGUMENTS
                LIST id: 12, nodes: 2
                  CONSTANT id: 13, constant_value: \'other\', constant_value_type: String
                  CONSTANT id: 14, constant_value: \'Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2, \\\'other\\\' = 3, \\\'yahoo\\\' = 4)\', constant_value_type: String
  JOIN TREE
    TABLE id: 5, table_name: system.numbers
  LIMIT
    CONSTANT id: 15, constant_value: UInt64_10, constant_value_type: UInt8
google
google
google
google
google
google
censor.net
censor.net
censor.net
censor.net
SELECT if(number > 5, _CAST(\'censor.net\', \'Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2)\'), _CAST(\'google\', \'Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2)\'))
FROM system.numbers
LIMIT 10
QUERY id: 0
  PROJECTION COLUMNS
    if(greater(number, 5), \'censor.net\', \'google\') String
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: if, function_type: ordinary, result_type: String
        ARGUMENTS
          LIST id: 3, nodes: 3
            FUNCTION id: 4, function_name: greater, function_type: ordinary, result_type: UInt8
              ARGUMENTS
                LIST id: 5, nodes: 2
                  COLUMN id: 6, column_name: number, result_type: UInt64, source_id: 7
                  CONSTANT id: 8, constant_value: UInt64_5, constant_value_type: UInt8
            FUNCTION id: 9, function_name: _CAST, function_type: ordinary, result_type: Enum8(\'censor.net\' = 1, \'google\' = 2)
              ARGUMENTS
                LIST id: 10, nodes: 2
                  CONSTANT id: 11, constant_value: \'censor.net\', constant_value_type: String
                  CONSTANT id: 12, constant_value: \'Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2)\', constant_value_type: String
            FUNCTION id: 13, function_name: _CAST, function_type: ordinary, result_type: Enum8(\'censor.net\' = 1, \'google\' = 2)
              ARGUMENTS
                LIST id: 14, nodes: 2
                  CONSTANT id: 15, constant_value: \'google\', constant_value_type: String
                  CONSTANT id: 12, constant_value: \'Enum8(\\\'censor.net\\\' = 1, \\\'google\\\' = 2)\', constant_value_type: String
  JOIN TREE
    TABLE id: 7, table_name: system.numbers
  LIMIT
    CONSTANT id: 16, constant_value: UInt64_10, constant_value_type: UInt8
21
21
21
21
21
21
20
20
20
20
SELECT CAST(if(number > 5, \'20\', \'21\'), \'Int8\')
FROM system.numbers
LIMIT 10
QUERY id: 0
  PROJECTION COLUMNS
    CAST(if(greater(number, 5), \'20\', \'21\'), \'Int8\') Int8
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: CAST, function_type: ordinary, result_type: Int8
        ARGUMENTS
          LIST id: 3, nodes: 2
            FUNCTION id: 4, function_name: if, function_type: ordinary, result_type: String
              ARGUMENTS
                LIST id: 5, nodes: 3
                  FUNCTION id: 6, function_name: greater, function_type: ordinary, result_type: UInt8
                    ARGUMENTS
                      LIST id: 7, nodes: 2
                        COLUMN id: 8, column_name: number, result_type: UInt64, source_id: 9
                        CONSTANT id: 10, constant_value: UInt64_5, constant_value_type: UInt8
                  CONSTANT id: 11, constant_value: \'20\', constant_value_type: String
                  CONSTANT id: 12, constant_value: \'21\', constant_value_type: String
            CONSTANT id: 13, constant_value: \'Int8\', constant_value_type: String
  JOIN TREE
    TABLE id: 9, table_name: system.numbers
  LIMIT
    CONSTANT id: 14, constant_value: UInt64_10, constant_value_type: UInt8
other
other
google
other
censor.net
other
yahoo
other
other
other
SELECT transform(number, [2, 4, 6], [\'google\', \'censor.net\', \'yahoo\'], \'other\')
FROM system.numbers
LIMIT 10
QUERY id: 0
  PROJECTION COLUMNS
    transform(number, [2, 4, 6], [\'google\', \'censor.net\', \'yahoo\'], \'other\') String
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: transform, function_type: ordinary, result_type: String
        ARGUMENTS
          LIST id: 3, nodes: 4
            COLUMN id: 4, column_name: number, result_type: UInt64, source_id: 5
            CONSTANT id: 6, constant_value: Array_[UInt64_2, UInt64_4, UInt64_6], constant_value_type: Array(UInt8)
            CONSTANT id: 7, constant_value: Array_[\'google\', \'censor.net\', \'yahoo\'], constant_value_type: Array(String)
            CONSTANT id: 8, constant_value: \'other\', constant_value_type: String
  JOIN TREE
    TABLE id: 5, table_name: system.numbers
  LIMIT
    CONSTANT id: 9, constant_value: UInt64_10, constant_value_type: UInt8
google
google
google
google
google
google
censor.net
censor.net
censor.net
censor.net
SELECT if(number > 5, \'censor.net\', \'google\')
FROM system.numbers
LIMIT 10
QUERY id: 0
  PROJECTION COLUMNS
    if(greater(number, 5), \'censor.net\', \'google\') String
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: if, function_type: ordinary, result_type: String
        ARGUMENTS
          LIST id: 3, nodes: 3
            FUNCTION id: 4, function_name: greater, function_type: ordinary, result_type: UInt8
              ARGUMENTS
                LIST id: 5, nodes: 2
                  COLUMN id: 6, column_name: number, result_type: UInt64, source_id: 7
                  CONSTANT id: 8, constant_value: UInt64_5, constant_value_type: UInt8
            CONSTANT id: 9, constant_value: \'censor.net\', constant_value_type: String
            CONSTANT id: 10, constant_value: \'google\', constant_value_type: String
  JOIN TREE
    TABLE id: 7, table_name: system.numbers
  LIMIT
    CONSTANT id: 11, constant_value: UInt64_10, constant_value_type: UInt8
