-- { echoOn } --
set optimize_aggregation_in_order = 0;
SELECT trimLeft(*) FROM (explain select sum(b) from pr_t group by a order by a limit 5 offset 500) WHERE explain LIKE '%ReadFromMergeTree%';
ReadFromMergeTree (p_agg)
set optimize_aggregation_in_order = 1; -- optimize_aggregation_in_order will be disabled with parallel replicas, see https://github.com/ClickHouse/ClickHouse/pull/95306
explain pipeline select sum(b) from pr_t group by a order by a limit 5 offset 500;
(Expression)
ExpressionTransform
  (Limit)
  Limit
    (Sorting)
    MergingSortedTransform 4 → 1
      MergeSortingTransform × 4
        LimitsCheckingTransform × 4
          PartialSortingTransform × 4
            (Expression)
            ExpressionTransform × 4
              (MergingAggregated)
              Resize 4 → 4
                MergingAggregatedBucketTransform × 4
                  Resize 1 → 4
                    GroupingAggregatedTransform 3 → 1
                      (Union)
                        (Aggregating)
                        AggregatingTransform
                          (Expression)
                          ExpressionTransform
                            (ReadFromMergeTree)
                            MergeTreeSelect(pool: ReadPoolParallelReplicas, algorithm: Thread) 0 → 1
                        (ReadFromRemoteParallelReplicas)
select sum(b) from pr_t group by a order by a limit 5 offset 500;
500000
501000
502000
503000
504000
