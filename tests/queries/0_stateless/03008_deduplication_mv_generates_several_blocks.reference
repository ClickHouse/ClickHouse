
Test case 0: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
OK

Test case 1: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
OK

Test case 2: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	94
0
0
OK

Test case 3: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	90
0
0
OK

Test case 4: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	47
0
0
OK

Test case 5: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	45
0
0
OK

Test case 6: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 7: engine=MergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

Test case 8: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	1
table_when_b_even_and_joined
count	10
EXPECTED_TO_FAIL

Test case 9: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	9
EXPECTED_TO_FAIL

Test case 10: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	1
table_when_b_even_and_joined
count	47
EXPECTED_TO_FAIL

Test case 11: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	45
EXPECTED_TO_FAIL

Test case 12: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	10
0
EXPECTED_TO_FAIL

Test case 13: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	9
0
EXPECTED_TO_FAIL

Test case 14: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 15: engine=MergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

Test case 16: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 17: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
OK

Test case 18: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	94
0
0
OK

Test case 19: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	90
0
0
OK

Test case 20: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 21: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	9
0
0
OK

Test case 22: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 23: engine=MergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

Test case 24: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 25: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
OK

Test case 26: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	94
0
0
OK

Test case 27: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	90
0
0
OK

Test case 28: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 29: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	9
0
0
OK

Test case 30: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 31: engine=MergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

Test case 32: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
OK

Test case 33: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
OK

Test case 34: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	94
0
0
OK

Test case 35: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	90
0
0
OK

Test case 36: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	47
0
0
OK

Test case 37: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	45
0
0
OK

Test case 38: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 39: engine=ReplicatedMergeTree use_insert_token=True single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

Test case 40: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	1
table_when_b_even_and_joined
count	10
EXPECTED_TO_FAIL

Test case 41: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	9
EXPECTED_TO_FAIL

Test case 42: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	1
table_when_b_even_and_joined
count	47
EXPECTED_TO_FAIL

Test case 43: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	45
EXPECTED_TO_FAIL

Test case 44: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	10
0
EXPECTED_TO_FAIL

Test case 45: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	9
0
EXPECTED_TO_FAIL

Test case 46: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 47: engine=ReplicatedMergeTree use_insert_token=True single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

Test case 48: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 49: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
OK

Test case 50: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	94
0
0
OK

Test case 51: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	90
0
0
OK

Test case 52: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 53: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	9
0
0
OK

Test case 54: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 55: engine=ReplicatedMergeTree use_insert_token=False single_thread=True deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

Test case 56: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 57: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	9
0
0
OK

Test case 58: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	5
table_when_b_even_and_joined
count	94
0
0
OK

Test case 59: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=True deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	1
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	1
table_when_b_even_and_joined
count	90
0
0
OK

Test case 60: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	14
0
EXPECTED_TO_FAIL

Test case 61: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=True insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	9
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	9
0
0
OK

Test case 62: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=True
table_a_b
count	5
table_when_b_even_and_joined
count	47
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	94
0
0
OK

Test case 63: engine=ReplicatedMergeTree use_insert_token=False single_thread=False deduplicate_src_table=False deduplicate_dst_table=False insert_unique_blocks=False
table_a_b
count	5
table_when_b_even_and_joined
count	45
0
0
table_a_b
count	10
table_when_b_even_and_joined
count	90
0
0
OK

All cases executed
