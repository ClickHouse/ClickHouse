-- { echoOn }

SELECT * FROM tbl WHERE id = 10000; -- single row expected (bar), because the force_select_final is in action
10000	bar
SELECT * FROM tbl final WHERE id = 10000; -- single row expected (bar), because the force_select_final is in action and FINAL is there.
10000	bar
SELECT * FROM tbl WHERE id = 10000 SETTINGS ignore_force_select_final=1; -- now we see 2 'real' rows
10000	bar
10000	foo
SELECT * FROM tbl FINAL WHERE id = 10000 SETTINGS ignore_force_select_final=1; -- now we see single row again.
10000	bar
SYSTEM START MERGES tbl;
OPTIMIZE TABLE tbl FINAL;
SELECT * FROM tbl WHERE id = 10000 SETTINGS ignore_force_select_final=1; -- now we see single row DROP TABLE tbl;
10000	bar
DROP TABLE tbl;
