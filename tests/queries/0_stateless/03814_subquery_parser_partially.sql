-- Tags: no-parallel, no-parallel-replicas, no-async-insert

-- Tests for GitHub issue 93358.

SELECT 'Underlying issue.';
SELECT (SELECT [(1)] AS `a` NOT LIKE `a`); -- { clientError SYNTAX_ERROR }
SELECT (SELECT [(1)] AS `a` LIKE `a`); -- { clientError SYNTAX_ERROR }
SELECT (SELECT [(1)] AS `a` = `a`); -- { clientError SYNTAX_ERROR }
SELECT (SELECT [(1)] AS `a` <> `a`); -- { clientError SYNTAX_ERROR }
SELECT (SELECT [(1)] AS `a` + `a`); -- { clientError SYNTAX_ERROR }
SELECT (SELECT [(1)] AS `a` - `a`); -- { clientError SYNTAX_ERROR }
SELECT (SELECT [(1)] AS `a` / `a`); -- { clientError SYNTAX_ERROR }
SELECT (SELECT [(1)] AS `a` * `a`); -- { clientError SYNTAX_ERROR }

SELECT 'Original query.';
WITH cte0d0 AS (SELECT `c0`, `c1`, `c2`, `c3`, `c4` FROM (FROM d13.`t80` AS t0d1 SELECT DISTINCT `t0d1`.`c0`[toUInt64OrNull(5837962187858800033::Int256)] AS `a0`, `a0`, `a0`, last_value(1122018372840911623) OVER (PARTITION BY `a0`.`UInt64` OR `t0d1`.`c0`, 5486343433692036636::Int32, (SELECT (`a0` AS `a1`) OFFSET 2 SETTINGS input_format_parquet_local_time_as_utc = 0, optimize_inverse_dictionary_lookup = 0, output_format_parquet_bloom_filter_flush_threshold_bytes = 884188607, output_format_bson_string_as_string = 0, split_parts_ranges_into_intersecting_and_non_intersecting_final = 1, date_time_64_output_format_cut_trailing_zeros_align_to_groups_of_thousands = 1, default_max_bytes_in_join = 3435613, use_query_cache = 0, database_replicated_allow_explicit_uuid = 1, parsedatetime_e_requires_space_padding = 1, input_format_arrow_allow_missing_columns = 1, input_format_defaults_for_omitted_fields = 0, optimize_extract_common_expressions = 0, throw_if_no_data_to_insert = 1, filesystem_cache_prefer_bigger_buffer_size = 0, optimize_skip_merged_partitions = 0, materialize_statistics_on_insert = 0, use_skip_indexes_if_final = 1, output_format_binary_write_json_as_string = 0, merge_tree_coarse_index_granularity = 29, query_plan_merge_filters = 1, distributed_cache_read_alignment = 0, max_bytes_before_external_group_by = 5241749, join_runtime_filter_pass_ratio_threshold_for_disabling = 1.000000, function_json_value_return_type_allow_nullable = 1, output_format_parquet_parallel_encoding = 1, input_format_orc_allow_missing_columns = 0, output_format_compression_level = 11, describe_include_subcolumns = 0, ignore_cold_parts_seconds = 0, enable_join_runtime_filters = 0), `a0`) AS `a2`, `t0d1`.`c0` != 0.326 AS `a3` LIMIT 1, `a0` BY 3 LIMIT -100)(c0, c1, c2, c3, c4)), dictGetFloat32('d15.d290', 'c0', f1(1235280706434102322::Int128, *)) AS `a4` SELECT showCertificate(), `t4d0`.`c0`, [toDecimal64('-749744840.22', 2), '247:26:06'::Time], `t3d0`.`c1`, `t3d0`.`c1` FROM generateSeries(((SELECT [(1)] AS `a5` NOT LIKE `a5`) AS `a6`), 668799, 563486) AS t1d0 LEFT JOIN remote('localhost:9000', view(SELECT `c0` FROM (WITH ('want' AS `a8`) AS `a7`, cte0d1 AS (SELECT `c0` FROM (SELECT '2106-02-07 06:28:15')(c0)), (randomPrintableASCII(42), NULL, ['(-9047369089930715242,-289664453702.4586728969533709733560190880059828)'::Point, 15677709463858676838::UInt16]) AS `a9`, `a7` AS `a10` SELECT DISTINCT -1947772541374065840::Int64 AS `a11` WHERE `a8` GROUP BY `a10` WITH ROLLUP ORDER BY ALL OFFSET 0)(c0)), c0) AS t2d0 ON `t1d0`.`generate_series` >= `t2d0`.`c0` INNER JOIN url('https://localhost:8443/?query=SELECT+c0,c2,c1+FROM+d15.t283+FORMAT+MsgPack', 'MsgPack', 'c0 Bool, c2 Int64, c1 LowCardinality(Bool)') AS t3d0 ON (NOT `t2d0`.`c0` = `t3d0`.`c2`) PASTE JOIN d15.`t118` AS t4d0 WHERE `t1d0`.`generate_series` = 9695246092354064994::Int32 QUALIFY f2((-sumMap(DISTINCT `a4`) OVER ()), `t3d0`.`c2`, `t2d0`.`c0`) ORDER BY `a4`, `t2d0`.`c0`, `t3d0`.`c1` DESC NULLS FIRST, 5 ASC, lowCardinalityIndices(`t4d0`.`c0`) NULLS FIRST OFFSET 0 INTO OUTFILE '/var/lib/clickhouse/user_files/file.data' TRUNCATE FORMAT Null; -- { clientError SYNTAX_ERROR }
