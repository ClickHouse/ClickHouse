-- { echo }
select _table, count(), length(groupArrayDistinct(_partition_id)) from merge(currentDatabase(), '^data_') group by _table order by 1 settings cluster_query_shards=0;
data_r1	5	5
data_r2	5	5
data_r3	5	5
data_r4	5	5
select replica, length(groupArray(partition)) from system.cluster_partitions array join active_replicas as replica where database = currentDatabase() and table = 'data_r1' group by 1 order by 1;
1	5
2	5
3	5
4	5
select partition, count() from system.cluster_partitions array join active_replicas as replica where database = currentDatabase() and table = 'data_r1' group by 1 order by 1;
0-0	2
0-1	2
0-2	2
0-3	2
0-4	2
0-5	2
0-6	2
0-7	2
0-8	2
0-9	2
select _table, count(), length(groupArrayDistinct(_partition_id)) size from merge(currentDatabase(), '^data_') group by _table order by 1 settings cluster_query_shards=1;
data_r1	10	10
data_r2	10	10
data_r3	10	10
data_r4	10	10
