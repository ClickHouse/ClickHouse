-- { echoOn }

SELECT 'First JOIN INNER second JOIN INNER';
First JOIN INNER second JOIN INNER
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    INNER JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 0
)
EXCEPT
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    INNER JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 1
);
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
INNER JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS enable_parallel_replicas=0;
14139232792575619499	700
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
INNER JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC;
14139232792575619499	700
SELECT 'First JOIN INNER second JOIN LEFT';
First JOIN INNER second JOIN LEFT
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    LEFT JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 0
)
EXCEPT
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    LEFT JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 1
);
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
LEFT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS enable_parallel_replicas=0;
12052041548298784267	900
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
LEFT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC;
12052041548298784267	900
SELECT 'First JOIN INNER second JOIN RIGHT';
First JOIN INNER second JOIN RIGHT
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    RIGHT JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 0
)
EXCEPT
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    RIGHT JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 1
);
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
RIGHT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS enable_parallel_replicas=0;
13783665296683752452	900
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
RIGHT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC;
13783665296683752452	900
SELECT 'First JOIN INNER second JOIN FULL';
First JOIN INNER second JOIN FULL
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    FULL JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 0
)
EXCEPT
(
    SELECT
        t1.*,
        t2.*,
        t3.*
    FROM test_table_join_1 AS t1
    INNER JOIN test_table_join_2 AS t2 USING (id)
    FULL JOIN test_table_join_3 AS t3 USING (id)
    ORDER BY ALL ASC
    SETTINGS enable_parallel_replicas = 1
);
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
FULL JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS enable_parallel_replicas=0;
11696474052406917220	1100
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
FULL JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC;
11696474052406917220	1100
