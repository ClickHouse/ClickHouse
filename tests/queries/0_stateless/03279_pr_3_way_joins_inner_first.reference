-- t1_value does not look correct
-- let's only check that output is not changed

-- { echoOn }

SELECT 'First JOIN INNER second JOIN INNER';
First JOIN INNER second JOIN INNER
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
INNER JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
5876547070216632603	500
SELECT 'First JOIN INNER second JOIN LEFT';
First JOIN INNER second JOIN LEFT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
LEFT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
5876547070216632603	500
SELECT 'First JOIN INNER second JOIN RIGHT';
First JOIN INNER second JOIN RIGHT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
RIGHT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
10980554161392103410	1244
SELECT 'First JOIN INNER second JOIN FULL';
First JOIN INNER second JOIN FULL
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
FULL JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=0;
10980554161392103410	1244
SELECT 'First JOIN INNER second JOIN INNER';
First JOIN INNER second JOIN INNER
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
INNER JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
5876547070216632603	500
SELECT 'First JOIN INNER second JOIN LEFT';
First JOIN INNER second JOIN LEFT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
LEFT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
5876547070216632603	500
SELECT 'First JOIN INNER second JOIN RIGHT';
First JOIN INNER second JOIN RIGHT
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
RIGHT JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
10980554161392103410	1244
SELECT 'First JOIN INNER second JOIN FULL';
First JOIN INNER second JOIN FULL
SELECT
    sum(sipHash64(t1.*, t2.*, t3.*)),
    count()
FROM test_table_join_1 AS t1
INNER JOIN test_table_join_2 AS t2 USING (id)
FULL JOIN test_table_join_3 AS t3 USING (id)
ORDER BY ALL ASC
SETTINGS parallel_replicas_local_plan=1;
10980554161392103410	1244
