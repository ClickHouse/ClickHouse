[0;1mSELECT[0m
    [0;22;33mREGEXP_REPLACE[0;38;5;218m([0;22;36mReferer[0m, [0;22;32m'[0;1;35;1m^[0;22;32mhttps[0;1;35;1m?:[0;22;32m//[0;1;35;1m(?:[0;22;32mwww[0;22;37;1m\\[0;22;32m.[0;1;35;1m)?([^[0;22;32m/[0;1;35;1m]+)[0;22;32m/[0;1;35;1m.*$[0;22;32m'[0m, [0;22;32m'[0;22;37;1m\\[0;22;32m1'[0;38;5;218m)[0m [0;1mAS[0m [0;38;5;44mk[0m,
    [0;22;33mAVG[0;38;5;210m([0;22;33mlength[0;38;5;222m([0;22;36mReferer[0;38;5;222m)[0;38;5;210m)[0m [0;1mAS[0m [0;38;5;44ml[0m,
    [0;22;33mCOUNT[0;38;5;228m([0m*[0;38;5;228m)[0m [0;1mAS[0m [0;38;5;44mc[0m,
    [0;22;33mMIN[0;38;5;120m([0;22;36mReferer[0;38;5;120m)[0m
[0;1mFROM[0m [0;22;33murl[0;38;5;123m([0;22;32m'https://clickhouse-public-datasets-eu-west-1.s3.amazonaws.com/hits_1t/0002.parquet'[0;38;5;123m)[0m
[0;1mWHERE[0m [0;22;36mReferer[0m != [0;22;32m''[0m
[0;1mGROUP BY[0m [0;22;36mk[0m
[0;1mHAVING[0m [0;22;33mCOUNT[0;38;5;141m([0m*[0;38;5;141m)[0m > [0;38;5;40m100000[0m
[0;1mORDER BY[0m [0;22;36ml[0m [0;1mDESC[0m
[0;1mLIMIT[0m [0;38;5;40m25[0m
[0;1mSELECT[0m
    [0;22;33mREGEXP_REPLACE[0;38;5;218m([0;22;36mReferer[0m, [0;22;32m'[0;1;35;1m^[0;22;32mhttps[0;1;35;1m?:[0;22;32m//[0;1;35;1m(?:[0;22;32mwww[0;22;37;1m\\[0;22;32m.[0;1;35;1m)?([^[0;22;32m/[0;1;35;1m]+)[0;22;32m/[0;1;35;1m.*$[0;22;32m'[0m, [0;22;32m'[0;22;37;1m\\[0;22;32m1'[0;38;5;218m)[0m [0;1mAS[0m [0;38;5;44mk[0m,
    [0;22;33mAVG[0;38;5;210m([0;22;33mlength[0;38;5;222m([0;22;36mReferer[0;38;5;222m)[0;38;5;210m)[0m [0;1mAS[0m [0;38;5;44ml[0m,
    [0;22;33mCOUNT[0;38;5;228m([0m*[0;38;5;228m)[0m [0;1mAS[0m [0;38;5;44mc[0m,
    [0;22;33mMIN[0;38;5;120m([0;22;36mReferer[0;38;5;120m)[0m
[0;1mFROM[0m [0;22;33murl[0;38;5;123m([0;22;32m'https://clickhouse-public-datasets-eu-west-1.s3.amazonaws.com/hits_1t/0002.parquet'[0;38;5;123m)[0m
[0;1mWHERE[0m [0;22;36mReferer[0m != [0;22;32m''[0m
[0;1mGROUP BY[0m [0;22;36mk[0m
[0;1mHAVING[0m [0;22;33mCOUNT[0;38;5;141m([0m*[0;38;5;141m)[0m > [0;38;5;40m100000[0m
[0;1mORDER BY[0m [0;22;36ml[0m [0;1mDESC[0m
[0;1mLIMIT[0m [0;38;5;40m25[0m
