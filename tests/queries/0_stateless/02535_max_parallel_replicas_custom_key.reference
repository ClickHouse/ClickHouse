query='SELECT * FROM cluster(test_cluster_one_shard_three_replicas_localhost, currentDatabase(), 02535_custom_key)' with custom_key='sipHash64(x)'
filter_type='default' max_replicas=1 prefer_localhost_replica=0
Hello
(ReadFromRemote)
filter_type='default' max_replicas=2 prefer_localhost_replica=0
Hello
(ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=0
Hello
(ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=0
Hello
(ReadFromRemote)
filter_type='range' max_replicas=2 prefer_localhost_replica=0
Hello
(ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=0
Hello
(ReadFromRemote)
filter_type='default' max_replicas=1 prefer_localhost_replica=1
Hello
(Expression)
ExpressionTransform
  (ReadFromMergeTree)
  MergeTreeInOrder 0 → 1
filter_type='default' max_replicas=2 prefer_localhost_replica=1
Hello
(Union)
  (Expression)
  ExpressionTransform
    (Filter)
    FilterTransform
      (ReadFromMergeTree)
      MergeTreeInOrder 0 → 1
  (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=1
Hello
(Union)
  (Expression)
  ExpressionTransform
    (Filter)
    FilterTransform
      (ReadFromMergeTree)
      MergeTreeInOrder 0 → 1
  (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=1
Hello
(Expression)
ExpressionTransform
  (ReadFromMergeTree)
  MergeTreeInOrder 0 → 1
filter_type='range' max_replicas=2 prefer_localhost_replica=1
Hello
(Union)
  (Expression)
  ExpressionTransform
    (Filter)
    FilterTransform
      (ReadFromMergeTree)
      MergeTreeInOrder 0 → 1
  (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=1
Hello
(Union)
  (Expression)
  ExpressionTransform
    (Filter)
    FilterTransform
      (ReadFromMergeTree)
      MergeTreeInOrder 0 → 1
  (ReadFromRemote)
query='SELECT count() FROM cluster(test_cluster_one_shard_three_replicas_localhost, currentDatabase(), 02535_custom_key)' with custom_key='cityHash64(x)'
filter_type='default' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='default' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='range' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='default' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='range' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
query='SELECT count() FROM cluster(test_cluster_one_shard_three_replicas_localhost, currentDatabase(), 02535_custom_key)' with custom_key='y'
filter_type='default' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='default' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='range' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='default' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='range' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
query='SELECT count() FROM cluster(test_cluster_one_shard_three_replicas_localhost, currentDatabase(), 02535_custom_key)' with custom_key='cityHash64(x) + y'
filter_type='default' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='default' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='range' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='default' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='range' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
query='SELECT count() FROM cluster(test_cluster_one_shard_three_replicas_localhost, currentDatabase(), 02535_custom_key)' with custom_key='cityHash64(x) + 1'
filter_type='default' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='default' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=0
1000
(ReadFromRemote)
filter_type='range' max_replicas=2 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=0
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (ReadFromRemote)
filter_type='default' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='default' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='default' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=1 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform
  (ReadFromStorage)
  AggregatingTransform
    ExpressionTransform
      SourceFromSingleChunk 0 → 1
filter_type='range' max_replicas=2 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 2 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
filter_type='range' max_replicas=3 prefer_localhost_replica=1
1000
(Expression)
ExpressionTransform × 4
  (MergingAggregated)
  Resize 1 → 4
    SortingAggregatedTransform 4 → 1
      MergingAggregatedBucketTransform × 4
        Resize 1 → 4
          GroupingAggregatedTransform 3 → 1
            (Union)
              (Aggregating)
              AggregatingTransform
                (Expression)
                ExpressionTransform
                  (Filter)
                  FilterTransform
                    (ReadFromMergeTree)
                    MergeTreeInOrder 0 → 1
              (ReadFromRemote)
