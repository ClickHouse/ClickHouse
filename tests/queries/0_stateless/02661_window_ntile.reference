-- { echo }

-- Normal cases
select a, b, ntile(3) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20));
0	0	1
0	1	1
0	2	1
0	3	1
0	4	2
0	5	2
0	6	2
0	7	3
0	8	3
0	9	3
1	0	1
1	1	1
1	2	1
1	3	1
1	4	2
1	5	2
1	6	2
1	7	3
1	8	3
1	9	3
select a, b, ntile(2) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20));
0	0	1
0	1	1
0	2	1
0	3	1
0	4	1
0	5	2
0	6	2
0	7	2
0	8	2
0	9	2
1	0	1
1	1	1
1	2	1
1	3	1
1	4	1
1	5	2
1	6	2
1	7	2
1	8	2
1	9	2
select a, b, ntile(1) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20));
0	0	1
0	1	1
0	2	1
0	3	1
0	4	1
0	5	1
0	6	1
0	7	1
0	8	1
0	9	1
1	0	1
1	1	1
1	2	1
1	3	1
1	4	1
1	5	1
1	6	1
1	7	1
1	8	1
1	9	1
select a, b, ntile(100) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20));
0	0	1
0	1	2
0	2	3
0	3	4
0	4	5
0	5	6
0	6	7
0	7	8
0	8	9
0	9	10
1	0	1
1	1	2
1	2	3
1	3	4
1	4	5
1	5	6
1	6	7
1	7	8
1	8	9
1	9	10
-- Bad arguments
select a, b, ntile(3.0) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
select a, b, ntile('2') over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
select a, b, ntile(0) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
select a, b, ntile(-2) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
select a, b, ntile(b + 1) over (partition by a order by b rows between unbounded preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
-- Bad window type
select a, b, ntile(2) over (partition by a) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
select a, b, ntile(2) over (partition by a order by b rows between 4 preceding and current row) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
select a, b, ntile(2) over (partition by a order by b rows between unbounded preceding and 4 following) from(select intDiv(number,10) as a, number%10 as b from numbers(20)); -- { serverError 36 }
select a, b, ntile(2) over (partition by a order by b rows between 4 preceding and 4 following) from(select intDiv(number,10) as a, number%10 as b from numbers(20));; -- { serverError 36 }
select a, b, ntile(2) over (partition by a order by b rows between current row  and 4 following) from(select intDiv(number,10) as a, number%10 as b from numbers(20));; -- { serverError 36 }
select a, b, ntile(2) over (partition by a order by b range unbounded preceding) from(select intDiv(number,10) as a, number%10 as b from numbers(20));; -- { serverError 36 }
