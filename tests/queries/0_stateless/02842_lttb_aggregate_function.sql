drop table if exists lttbTestFloat64Float64;

CREATE TABLE lttbTestFloat64Float64
(
    x Float64,
    y Float64
) ENGINE = MergeTree order by (y,x);

INSERT INTO lttbTestFloat64Float64
VALUES (1.0, 10.0),(2.0, 20.0),(3.0, 15.0),(8.0, 60.0),(9.0, 55.0),(10.0, 70.0),(4.0, 30.0),(5.0, 40.0),(6.0, 35.0),(7.0, 50.0);

select lttb(0)(x, y) FROM lttbTestFloat64Float64;

select lttb(1)(x, y) FROM lttbTestFloat64Float64;

select lttb(2)(x, y) FROM lttbTestFloat64Float64;

SELECT lttb(4)(x, y) AS downsampled_data
FROM lttbTestFloat64Float64;

drop table lttbTestFloat64Float64;

drop table if exists lttbTestDecimal64Decimal64;

CREATE TABLE lttbTestDecimal64Decimal64
(
    x Decimal64(2),
    y Decimal64(2)
) ENGINE = MergeTree order by (y,x);

INSERT INTO lttbTestDecimal64Decimal64(x, y) VALUES (0.6269274318604969, 0.2533354621167315), (0.02292889293995992, 0.15818793288353084), (0.2939691658904474, 0.15813688916970137), (0.19580349713986878, 0.24325955103050934), (0.7791825062037451, 0.23312205330183156), (0.9300114542650039, 0.15134132439514814), (0.3955292185030347, 0.21253231895427593), (0.17295071853963606, 0.939750365994895), (0.587661910255141, 0.5995666039167036), (0.9916920386794205, 0.5788414852451664), (0.4088415014927298, 0.6328143393001883), (0.39748813394501714, 0.5716987390253008), (0.5635113846960187, 0.6632011830186312), (0.055455484646037556, 0.7331044269728889), (0.1293068576937897, 0.06209382865354818), (0.26647246095332366, 0.9894693221750891), (0.9287279794829701, 0.10208668974638124), (0.35756397507219506, 0.9926771546320386), (0.566862985687317, 0.1840178584443405), (0.6584073167832293, 0.27510009655313117), (0.010320280207521071, 0.5849887979418847), (0.7919062157306627, 0.16855356987752668), (0.9785840528140496, 0.09414670964399896), (0.9861024354982798, 0.18762835586739524), (0.4372531758596374, 0.26094343935133446), (0.8881577157458493, 0.9427973704238286), (0.3131685550178188, 0.6229803988714411), (0.7319863082194951, 0.9530439123795025), (0.4545770673700469, 0.8581275419128741), (0.3681919480697593, 0.860163636716297), (0.3968998089670912, 0.8833812856918504), (0.6019207171645469, 0.6414595125453761), (0.10534200832662999, 0.3111727996875553), (0.7009278270903265, 0.24582717328548598), (0.1376381486337871, 0.23913030141009695), (0.8526437614015179, 0.14564074118628723), (0.6796831609410511, 0.3904936262367842), (0.3127041273919666, 0.9143559220786232), (0.5759547718453799, 0.9176055645473493), (0.9018905560574773, 0.29816860329908434), (0.6710911024277676, 0.3684287599289009), (0.24850673183893623, 0.3425546598603789), (0.09053531625751265, 3.094019357019473e-05), (0.9318889822471171, 0.7126304723495399), (0.4182942754562151, 0.004397371845618947), (0.581167279629864, 0.7943450650921527), (0.6601181965806944, 0.11946217986232543), (0.9148054870305193, 0.6221949859066175), (0.6599993319729175, 0.18120034264523588), (0.1445240544705343, 0.9305231938818628), (0.4716096257207234, 0.06385673816118098), (0.08360674737359053, 0.879344031285679), (0.6591536627162915, 0.11944026199765145), (0.4764016345107962, 0.5664652734655534), (0.586150292850322, 0.3907777091845801), (0.546253580887362, 0.7514987457982003), (0.9524918948219452, 0.5536202045331245), (0.1924056024075641, 0.2655390186137042), (0.31272418226059473, 0.5211394699171993), (0.5332782933461568, 0.4174460077093519), (0.18442453764109346, 0.8673984248671064), (0.872425836257601, 0.14980933112688233), (0.7199993207899258, 0.8338615073635146), (0.14743788168682437, 0.09025233779856878), (0.7741385164621111, 0.27865655046918436), (0.5645274357060077, 0.7087754712182365), (0.008431141888207372, 0.7514251148705328), (0.656638699941343, 0.044580075243081274), (0.7180485361900073, 0.38940260485696176), (0.7547911448087812, 0.2062018441779715), (0.49719354879971567, 0.20366378579879085), (0.9434185084608488, 0.1507668150225573), (0.43636498550325065, 0.9036625431929806), (0.2715778048503059, 0.817773006567945), (0.6705615889012387, 0.5186915859859116), (0.7882833019016634, 0.30648911841695514), (0.9354145777419304, 0.9405103046197459), (0.3934886370917118, 0.8595687932368253), (0.9297181534034813, 0.8683809135430983), (0.18099942347049247, 0.02731104175298049), (0.1672146096960142, 0.8717361233609109), (0.5198766488692533, 0.10738994578752792), (0.17823740601433913, 0.2944176023035475), (0.9886074198510446, 0.9756220802161846), (0.3817150837275616, 0.7460715965534447), (0.526539668453563, 0.17972940182441544), (0.7802481794091678, 0.2830175920798833), (0.5589272746093485, 0.8773158113223417), (0.5586762203475353, 0.5979152173850433), (0.7109160694697472, 0.4404446357871108), (0.3085142658047647, 0.6508077369870577), (0.7504988510980485, 0.06555396328913543), (0.2137808780487752, 0.46303733817486714), (0.8780749543192611, 0.14986161918738827), (0.8896759973341898, 0.39756605512253484), (0.12564108433235022, 0.39299852806303426), (0.9497077406759799, 0.41403622273738394), (0.8312084987324139, 0.6669661686623602), (0.4215083696019787, 0.8775426999478525), (0.23399923085299124, 0.22546168129627042);

select lttb(20)(x, y) from lttbTestDecimal64Decimal64;

drop table lttbTestDecimal64Decimal64;

drop table if exists lttbTestDateTime64Float64;

create table lttbTestDateTime64Float64 (x DateTime64(3), y Float64) engine = MergeTree order by (y,x);

INSERT INTO lttbTestDateTime64Float64 (x, y) VALUES ('2023-09-06 00:00:00', 14.217481939467213), ('2023-09-11 00:00:00', 30.096113766096455), ('2023-01-31 00:00:00', 91.42364224984735), ('2023-12-14 00:00:00', 42.08543753438961), ('2023-10-31 00:00:00', 29.93227107709394), ('2023-12-31 00:00:00', 98.52375935588333), ('2023-07-07 00:00:00', 79.9367415060134), ('2023-08-02 00:00:00', 55.417182033825696), ('2023-03-15 00:00:00', 98.77709508458238), ('2023-09-05 00:00:00', 2.832505232031368), ('2023-06-05 00:00:00', 8.107958052612418), ('2023-02-08 00:00:00', 62.95788480328096), ('2023-02-17 00:00:00', 76.80522155552535), ('2023-11-13 00:00:00', 24.927527306242993), ('2023-02-03 00:00:00', 7.966981342350332), ('2023-05-31 00:00:00', 44.61922229800436), ('2023-09-21 00:00:00', 65.86974701469791), ('2023-01-14 00:00:00', 35.96528042030847), ('2023-02-19 00:00:00', 16.065599678978305), ('2023-05-24 00:00:00', 17.23630978966909), ('2023-11-15 00:00:00', 15.544172190379879), ('2023-12-03 00:00:00', 13.738382187690856), ('2023-10-09 00:00:00', 16.7137129521176), ('2023-11-19 00:00:00', 12.12866001303361), ('2023-06-10 00:00:00', 95.15764263905534), ('2023-07-06 00:00:00', 18.87765798627088), ('2023-03-13 00:00:00', 44.82941460384813), ('2023-01-29 00:00:00', 36.0214717111606), ('2023-12-19 00:00:00', 90.30173319497655), ('2023-07-15 00:00:00', 12.67101467231364), ('2023-07-06 00:00:00', 88.13662733228512), ('2023-05-10 00:00:00', 34.18711141027026), ('2023-11-12 00:00:00', 75.58716684321973), ('2023-10-28 00:00:00', 35.79179186729331), ('2023-11-14 00:00:00', 0.9318182359137728), ('2023-09-29 00:00:00', 80.05338096818797), ('2023-09-13 00:00:00', 16.130217942056866), ('2023-07-28 00:00:00', 11.186638594914744), ('2023-02-12 00:00:00', 69.43690757793445), ('2023-12-18 00:00:00', 12.832032764204616), ('2023-05-21 00:00:00', 74.25002458036471), ('2023-04-03 00:00:00', 51.5662427420719), ('2023-11-27 00:00:00', 96.44359131281784), ('2023-03-29 00:00:00', 33.018594418113324), ('2023-02-07 00:00:00', 84.58945099939815), ('2023-11-16 00:00:00', 40.61531555527268), ('2023-04-21 00:00:00', 60.0545791577218), ('2023-01-31 00:00:00', 87.23185155362057), ('2023-05-19 00:00:00', 77.4095289464808), ('2023-08-26 00:00:00', 18.700816570182067);

select lttb(5)(x, y) from lttbTestDateTime64Float64;

drop table lttbTestDateTime64Float64;