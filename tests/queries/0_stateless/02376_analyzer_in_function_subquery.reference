-- { echoOn }

SELECT id, value FROM test_table WHERE id IN (SELECT 1);
1	Value_1
SELECT '--';
--
SELECT id, value FROM test_table WHERE id IN (SELECT 2);
2	Value_2
DROP TABLE IF EXISTS test_table_for_in;
CREATE TABLE test_table_for_in
(
    id UInt64
) ENGINE=TinyLog;
INSERT INTO test_table_for_in VALUES (0), (1);
SELECT '--';
--
SELECT id, value FROM test_table WHERE id IN test_table_for_in;
0	Value_0
1	Value_1
SELECT '--';
--
SELECT id, value FROM test_table WHERE id IN (SELECT id FROM test_table_for_in);
0	Value_0
1	Value_1
SELECT '--';
--
SELECT id, value FROM test_table WHERE id IN (SELECT id FROM test_table_for_in UNION DISTINCT SELECT id FROM test_table_for_in);
0	Value_0
1	Value_1
SELECT '--';
--
WITH cte_test_table_for_in AS (SELECT id FROM test_table_for_in) SELECT id, value FROM test_table WHERE id IN cte_test_table_for_in;
0	Value_0
1	Value_1
SELECT '--';
--
WITH cte_test_table_for_in AS (SELECT id FROM test_table_for_in) SELECT id, value
FROM test_table WHERE id IN (SELECT id FROM cte_test_table_for_in UNION DISTINCT SELECT id FROM cte_test_table_for_in);
0	Value_0
1	Value_1
