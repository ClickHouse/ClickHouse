#!/usr/bin/env bash
# Tags: no-fasttest

CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
# shellcheck source=../shell_config.sh
. "$CUR_DIR"/../shell_config.sh

# Generated by Flink, with optional map key int it.
# Parquet schema:
# message flink_schema {
#   optional int64 id;
#   optional group data (MAP) {
#     repeated group key_value (MAP_KEY_VALUE) {
#       optional binary key (UTF8);
#       optional binary value (UTF8);
#     }
#   }
# }
DATA_FILE=$CUR_DIR/data_parquet/optional_map_key.parquet

$CLICKHOUSE_LOCAL -q "desc file('$DATA_FILE')"
$CLICKHOUSE_LOCAL -q "select * from file('$DATA_FILE')"
