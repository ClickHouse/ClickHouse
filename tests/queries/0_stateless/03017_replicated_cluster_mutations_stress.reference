-- { echo }
select _table, count() = countIf(value = key+100) from merge(currentDatabase(), '^data_') group by _table order by 1 settings cluster_query_shards=0;
data_r1	1
data_r2	1
data_r3	1
data_r4	1
select count(), countIf(value = key+100), length(groupArray(_partition_id)) from data_r1;
100000	100000	100000
select replica, length(groupArray(partition)) from system.cluster_partitions array join active_replicas as replica where database = currentDatabase() and table = 'data_r1' group by 1 order by 1;
1	5
2	5
3	5
4	5
select partition, count() from system.cluster_partitions array join active_replicas as replica where database = currentDatabase() and table = 'data_r1' group by 1 order by 1;
0	2
1	2
2	2
3	2
4	2
5	2
6	2
7	2
8	2
9	2
