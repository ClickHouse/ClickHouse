Test direct read optimization from text log
Test hasToken:	1
Test hasAllTokens:	1
Test hasAnyTokens:	1
Test hasToken + length(text):	2
Test select text + hasAnyTokens:	Alick a01
Test hasToken and hasToken:	0
Test hasAnyTokens or hasToken:	2
Test NOT hasAllTokens:	1
Added: [__text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8], Removed: [text]
Added: [__text_index_idx_hasAllTokens_e7a7ab2df53846f18ae5a86c4ce452e9], Removed: [text]
Added: [__text_index_idx_hasAnyTokens_5bdd7eadb42d107c51b224fc6e4f764f], Removed: [text]
Added: [__text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8]
Added: [__text_index_idx_hasAnyTokens_5bdd7eadb42d107c51b224fc6e4f764f]
Added: [__text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8, __text_index_idx_hasToken_c59a18d8fad9a55578502d88319e8999], Removed: [text]
Added: [__text_index_idx_hasAnyTokens_d6702e45d9f4e5e38c13ef8e3a93dd13, __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8], Removed: [text]
Added: [__text_index_idx_hasAllTokens_c9d410e7a461849da4abf4ffd733029b], Removed: [text]
Expression ((Project names + Projection))
Actions: INPUT :: 0 -> count() UInt64 : 0
         COLUMN Const(String) -> \'Test hasToken:\' String : 1
Positions: 1 0
  Aggregating
  Keys:
  Aggregates:
      count()
        Function: count() → UInt64
        Arguments: none
  Skip merging: 0
    Expression (Before GROUP BY)
    Positions:
      Filter
      Filter column: __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 (removed)
      Actions: INPUT :: 0 -> __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 UInt8 : 0
      Positions: 0
        ReadFromMergeTree (default.tab)
        ReadType: Default
        Parts: 1
        Granules: 1
Expression ((Project names + Projection))
Actions: INPUT :: 0 -> count() UInt64 : 0
         COLUMN Const(String) -> \'Test hasAllTokens:\' String : 1
Positions: 1 0
  Aggregating
  Keys:
  Aggregates:
      count()
        Function: count() → UInt64
        Arguments: none
  Skip merging: 0
    Expression (Before GROUP BY)
    Positions:
      Filter
      Filter column: __text_index_idx_hasAllTokens_e7a7ab2df53846f18ae5a86c4ce452e9 (removed)
      Actions: INPUT :: 0 -> __text_index_idx_hasAllTokens_e7a7ab2df53846f18ae5a86c4ce452e9 UInt8 : 0
      Positions: 0
        ReadFromMergeTree (default.tab)
        ReadType: Default
        Parts: 1
        Granules: 1
Expression ((Project names + Projection))
Actions: INPUT :: 0 -> count() UInt64 : 0
         COLUMN Const(String) -> \'Test hasAnyTokens:\' String : 1
Positions: 1 0
  Aggregating
  Keys:
  Aggregates:
      count()
        Function: count() → UInt64
        Arguments: none
  Skip merging: 0
    Expression (Before GROUP BY)
    Positions:
      Filter
      Filter column: __text_index_idx_hasAnyTokens_5bdd7eadb42d107c51b224fc6e4f764f (removed)
      Actions: INPUT :: 0 -> __text_index_idx_hasAnyTokens_5bdd7eadb42d107c51b224fc6e4f764f UInt8 : 0
      Positions: 0
        ReadFromMergeTree (default.tab)
        ReadType: Default
        Parts: 1
        Granules: 1
Expression ((Project names + Projection))
Actions: INPUT :: 0 -> count() UInt64 : 0
         COLUMN Const(String) -> \'Test hasToken + length(text):\' String : 1
Positions: 1 0
  Aggregating
  Keys:
  Aggregates:
      count()
        Function: count() → UInt64
        Arguments: none
  Skip merging: 0
    Expression (Before GROUP BY)
    Positions:
      Filter
      Filter column: or(hasToken(__table1.text, \'Alick\'_String), greater(length(__table1.text), 1_UInt8)) (removed)
      Actions: INPUT : 0 -> text String : 0
               INPUT : 1 -> __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 UInt8 : 1
               COLUMN Const(UInt8) -> 1_UInt8 UInt8 : 2
               FUNCTION length(text :: 0) -> length(__table1.text) UInt64 : 3
               FUNCTION greater(length(__table1.text) :: 3, 1_UInt8 :: 2) -> greater(length(__table1.text), 1_UInt8) UInt8 : 0
               FUNCTION or(__text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 :: 1, greater(length(__table1.text), 1_UInt8) :: 0) -> or(hasToken(__table1.text, \'Alick\'_String), greater(length(__table1.text), 1_UInt8)) UInt8 : 2
      Positions: 2
        ReadFromMergeTree (default.tab)
        ReadType: Default
        Parts: 1
        Granules: 1
Expression ((Project names + Projection))
Actions: INPUT : 0 -> __table1.text String : 0
         COLUMN Const(String) -> \'Test select text + hasAnyTokens:\' String : 1
         ALIAS __table1.text :: 0 -> text String : 2
Positions: 1 2
  Expression
  Actions: INPUT : 0 -> text String : 0
           INPUT :: 1 -> __text_index_idx_hasAnyTokens_5bdd7eadb42d107c51b224fc6e4f764f UInt8 : 1
           ALIAS text :: 0 -> __table1.text String : 2
  Positions: 2
    ReadFromMergeTree (default.tab)
    ReadType: Default
    Parts: 1
    Granules: 1
    Prewhere info
    Need filter: 1
      Prewhere filter
      Prewhere filter column: __text_index_idx_hasAnyTokens_5bdd7eadb42d107c51b224fc6e4f764f (removed)
      Actions: INPUT :: 0 -> __text_index_idx_hasAnyTokens_5bdd7eadb42d107c51b224fc6e4f764f UInt8 : 0
      Positions: 0 0
Expression ((Project names + Projection))
Actions: INPUT :: 0 -> count() UInt64 : 0
         COLUMN Const(String) -> \'Test hasToken and hasToken:\' String : 1
Positions: 1 0
  Aggregating
  Keys:
  Aggregates:
      count()
        Function: count() → UInt64
        Arguments: none
  Skip merging: 0
    Expression (Before GROUP BY)
    Positions:
      Expression
      Actions: INPUT :: 0 -> __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 UInt8 : 0
               INPUT :: 1 -> __text_index_idx_hasToken_c59a18d8fad9a55578502d88319e8999 UInt8 : 1
      Positions:
        ReadFromMergeTree (default.tab)
        ReadType: Default
        Parts: 1
        Granules: 1
        Prewhere info
        Need filter: 1
          Prewhere filter
          Prewhere filter column: and(__text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8, __text_index_idx_hasToken_c59a18d8fad9a55578502d88319e8999) (removed)
          Actions: INPUT : 0 -> __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 UInt8 : 0
                   INPUT : 1 -> __text_index_idx_hasToken_c59a18d8fad9a55578502d88319e8999 UInt8 : 1
                   FUNCTION and(__text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 : 0, __text_index_idx_hasToken_c59a18d8fad9a55578502d88319e8999 : 1) -> and(__text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8, __text_index_idx_hasToken_c59a18d8fa... UInt8 : 2
          Positions: 0 1 2
Expression ((Project names + Projection))
Actions: INPUT :: 0 -> count() UInt64 : 0
         COLUMN Const(String) -> \'Test hasAnyTokens or hasToken:\' String : 1
Positions: 1 0
  Aggregating
  Keys:
  Aggregates:
      count()
        Function: count() → UInt64
        Arguments: none
  Skip merging: 0
    Expression (Before GROUP BY)
    Positions:
      Filter
      Filter column: or(hasAnyTokens(__table1.text, _CAST([\'Blick\']_Array(String), \'Array(String)\'_String)), hasToken(__table1.text, \'Alick\'_String)) (removed)
      Actions: INPUT : 0 -> __text_index_idx_hasAnyTokens_d6702e45d9f4e5e38c13ef8e3a93dd13 UInt8 : 0
               INPUT : 1 -> __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 UInt8 : 1
               FUNCTION or(__text_index_idx_hasAnyTokens_d6702e45d9f4e5e38c13ef8e3a93dd13 :: 0, __text_index_idx_hasToken_964e5077dcf15a3ce9e4959da4ba5fb8 :: 1) -> or(hasAnyTokens(__table1.text, _CAST([\'Blick\']_Array(String), \'Array(String)\'_String)), hasToken(__t... UInt8 : 2
      Positions: 2
        ReadFromMergeTree (default.tab)
        ReadType: Default
        Parts: 1
        Granules: 1
Expression ((Project names + Projection))
Actions: INPUT :: 0 -> count() UInt64 : 0
         COLUMN Const(String) -> \'Test NOT hasAllTokens:\' String : 1
Positions: 1 0
  Aggregating
  Keys:
  Aggregates:
      count()
        Function: count() → UInt64
        Arguments: none
  Skip merging: 0
    Expression (Before GROUP BY)
    Positions:
      Filter
      Filter column: not(hasAllTokens(__table1.text, _CAST([\'Blick\']_Array(String), \'Array(String)\'_String))) (removed)
      Actions: INPUT : 0 -> __text_index_idx_hasAllTokens_c9d410e7a461849da4abf4ffd733029b UInt8 : 0
               FUNCTION not(__text_index_idx_hasAllTokens_c9d410e7a461849da4abf4ffd733029b :: 0) -> not(hasAllTokens(__table1.text, _CAST([\'Blick\']_Array(String), \'Array(String)\'_String))) UInt8 : 1
      Positions: 1
        ReadFromMergeTree (default.tab)
        ReadType: Default
        Parts: 1
        Granules: 1
