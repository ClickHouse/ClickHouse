-- TODO: uncomment line below when we'll correctly do minus from max UInt64
-- INSERT INTO optimize_sorting SELECT 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF;
-- { echoOn }
SELECT a from optimize_sorting order by a;
0
1
2
3
4
5
6
7
8
9
-- queries with unary function in order by
SELECT a from optimize_sorting order by -a;
9
8
7
6
5
4
3
2
1
0
SELECT a from optimize_sorting order by toFloat64(a);
0
1
2
3
4
5
6
7
8
9
-- queries with non-unary function in order by
SELECT a, a+1 from optimize_sorting order by a+1;
0	1
1	2
2	3
3	4
4	5
5	6
6	7
7	8
8	9
9	10
SELECT a, a-1 from optimize_sorting order by a-1;
0	-1
1	0
2	1
3	2
4	3
5	4
6	5
7	6
8	7
9	8
SELECT a, sipHash64(a,'a') from optimize_sorting order by sipHash64(a,'a');
3	1173123105019859883
8	1721650864755082841
0	5764203013335897168
9	7186398762098957933
5	7941328890117047678
1	11604135878754760071
2	14554472274185621678
6	15415898319530396106
4	15793726040922926059
7	18182906236422157798
-- queries with aliases
SELECT a as a from optimize_sorting order by a;
0
1
2
3
4
5
6
7
8
9
SELECT a+1 as a from optimize_sorting order by a;
1
2
3
4
5
6
7
8
9
10
SELECT toFloat64(a) as a from optimize_sorting order by a;
0
1
2
3
4
5
6
7
8
9
SELECT sipHash64(a) as a from optimize_sorting order by a;
9140302661501632497
9199082625845137542
9224715256000962398
13180436571133193200
13251804803629934096
13686418376000424449
14247234200463187066
14454559127837024772
14848019510572519333
16738165381834614119
-- queries with filter
SELECT a FROM optimize_sorting WHERE a > 0 ORDER BY a;
1
2
3
4
5
6
7
8
9
SELECT a > 0 FROM optimize_sorting WHERE a > 0;
1
1
1
1
1
1
1
1
1
SELECT a FROM (SELECT a FROM optimize_sorting) WHERE a != 0 ORDER BY a;
1
2
3
4
5
6
7
8
9
SELECT a FROM (SELECT sipHash64(a) AS a FROM optimize_sorting) WHERE a != 0 ORDER BY a;
9140302661501632497
9199082625845137542
9224715256000962398
13180436571133193200
13251804803629934096
13686418376000424449
14247234200463187066
14454559127837024772
14848019510572519333
16738165381834614119
-- queries with non-trivial action's chain in expression
SELECT a, z FROM (SELECT sipHash64(a) AS a, a + 1 AS z FROM (SELECT a FROM optimize_sorting ORDER BY a + 1)) ORDER BY a + 1;
9140302661501632497	9140302661501632498
9199082625845137542	9199082625845137543
9224715256000962398	9224715256000962399
13180436571133193200	13180436571133193201
13251804803629934096	13251804803629934097
13686418376000424449	13686418376000424450
14247234200463187066	14247234200463187067
14454559127837024772	14454559127837024773
14848019510572519333	14848019510572519334
16738165381834614119	16738165381834614120
