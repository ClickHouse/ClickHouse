CREATE TABLE t1 (x Int16, y ALIAS x + x * 2) ENGINE=MergeTree() ORDER BY x;
CREATE TABLE t2 (y Int16, z Int16) ENGINE=MergeTree() ORDER BY y;

INSERT INTO t1 VALUES (1231), (123);
INSERT INTO t2 VALUES (6666, 48);
INSERT INTO t2 VALUES (369, 50);

SELECT count() FROM t1 INNER JOIN t2 USING (y);
SELECT count() FROM t2 INNER JOIN t1 USING (y);

DROP TABLE IF EXISTS t1;
DROP TABLE IF EXISTS t2;
