-- { echo }
SELECT arrayJoin([toDateTime('2026-01-01 00:00:00', 'UTC'), toTimeZone(fromUnixTimestamp(0), 'UTC')]) a ORDER BY a DESC WITH FILL STALENESS toIntervalSecond(-2);
2026-01-01 00:00:00
2025-12-31 23:59:59
1970-01-01 00:00:00
SELECT arrayJoin([toTimeZone(fromUnixTimestamp(10), 'UTC'), toTimeZone(fromUnixTimestamp(0), 'UTC')]) a ORDER BY a DESC WITH FILL STALENESS toIntervalSecond(-2);
1970-01-01 00:00:10
1970-01-01 00:00:09
1970-01-01 00:00:00
-- no overflow
SELECT arrayJoin([toTimeZone(fromUnixTimestamp(10), 'UTC'), toTimeZone(fromUnixTimestamp(2), 'UTC')]) a ORDER BY a DESC WITH FILL STALENESS toIntervalSecond(-2);
1970-01-01 00:00:10
1970-01-01 00:00:09
1970-01-01 00:00:02
1970-01-01 00:00:01
