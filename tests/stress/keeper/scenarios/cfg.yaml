version: 1
defaults:
  duration: 120
  topology: 3
scenarios:
  - id: CFG-02
    name: Readiness lifecycle
    topology: 3
    workload: { config: workloads/prod_mix.yaml }
    faults:
      - { kind: rcvr, on: leader }
      - { kind: expect_ready, on: leader, ok: false }

  - id: CFG-03
    name: 4LW allowlist
    topology: 3
    workload: { config: workloads/prod_mix.yaml }
    gates:
      - { type: fourlw_enforces, allow: ["ruok", "mntr", "stat"], deny: ["conf", "srvr", "cons"] }
    opts:
      coord_overrides_xml: "<four_letter_word_allow_list>ruok,mntr,stat</four_letter_word_allow_list>"

  - id: CFG-04
    name: Hostname checks
    topology: 3
    workload: { config: workloads/prod_mix.yaml }

  - id: CFG-05
    name: IPv6 end-to-end
    topology: 3
    workload: { config: workloads/prod_mix.yaml }
    opts:
      coord_overrides_xml: "<enable_ipv6>true</enable_ipv6>"

  - id: CFG-06
    name: auto_forwarding=false semantics
    topology: 3
    workload: { config: workloads/prod_mix.yaml }
    opts:
      coord_overrides_xml: "<coordination_settings><auto_forwarding>false</auto_forwarding></coordination_settings>"

  - id: CFG-07
    name: Startup/shutdown timeouts
    topology: 3
    workload: { config: workloads/prod_mix.yaml }
    gates:
      - { type: coord_timeouts_match, startup: 5000, shutdown: 5000 }
    opts:
      coord_overrides_xml: "<coordination_settings><startup_timeout>5000</startup_timeout><shutdown_timeout>5000</shutdown_timeout></coordination_settings>"

  - id: CFG-08
    name: Feature flags truth + errors
    topology: 3
    workload: { config: workloads/prod_mix.yaml }
    opts:
      feature_flags:
        multi_read: 1
        remove_recursive: 1
        check_not_exists: 1

  - id: RCV-01
    name: Recovery mode semantics
    topology: 3
    workload: { config: workloads/prod_mix.yaml }
    faults:
      - { kind: rcvr, on: leader }
