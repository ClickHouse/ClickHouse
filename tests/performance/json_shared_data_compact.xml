<test>
    <create_query>CREATE TABLE test_shared_data_compact (json JSON(max_dynamic_paths=0)) ENGINE=MergeTree ORDER BY tuple() SETTINGS min_bytes_for_wide_part='200G', write_marks_for_substreams_in_compact_parts=1</create_query>

    <fill_query>INSERT INTO test_shared_data_compact SELECT arrayMap(x -> tuple('key' || x, randomStringUTF8(16)), range(256))::Map(String, String) FROM numbers(150000)</fill_query>
    <fill_query>INSERT INTO test_shared_data_compact SELECT arrayMap(x -> tuple('key' || x, randomStringUTF8(16)), range(256))::Map(String, String) FROM numbers(150000)</fill_query>

    <fill_query>OPTIMIZE TABLE test_shared_data_compact FINAL SETTINGS mutations_sync=1</fill_query>

    <query>SELECT json.key0 FROM test_shared_data_compact FORMAT Null</query>
    <query>SELECT json.non_existing_key FROM test_shared_data_compact FORMAT Null</query>
    <query>SELECT json.key0, json.key1, json.key2, json.key3, json.key4 FROM test_shared_data_compact FORMAT Null</query>

    <drop_query>DROP TABLE IF EXISTS test_shared_data_compact</drop_query>
</test>
