<test>
    <settings>
        <max_insert_threads>8</max_insert_threads>
        <allow_experimental_projection_optimization>0</allow_experimental_projection_optimization>
        <max_threads>4</max_threads>
    </settings>

    <create_query>
        CREATE TABLE t_nullable
        (
        key_string1 Nullable(String),
        key_string2 Nullable(String),
        key_string3 Nullable(String),
        m1 Int64,
        m2 Int64,
        )
        ENGINE = Memory
    </create_query>
    <fill_query>insert into t_nullable select ['aaaaaa','bbaaaa','ccaaaa','ddaaaa'][number % 101 + 1], ['aa','bb','cc','dd'][number % 100 + 1], ['aa','bb','cc','dd'][number % 102 + 1], number%6000+1, number%5000+2 from numbers_mt(20000000)</fill_query>
    <query>select key_string1,key_string2,key_string3, min(m1) from t_nullable group by key_string1,key_string2,key_string3</query>

    <drop_query>drop table if exists t_nullable</drop_query>
</test>