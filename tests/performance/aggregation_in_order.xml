<test>
    <preconditions>
        <table_exists>hits_10m_single</table_exists>
        <table_exists>hits_100m_single</table_exists>
    </preconditions>

    <substitutions>
        <substitution>
           <name>table</name>
           <values>
               <value>hits_10m_single</value>
               <value>hits_100m_single</value>
           </values>
       </substitution>
    </substitutions>

    <query>SELECT avg(length(URL)) as x from {table} GROUP BY CounterID FORMAT Null settings optimize_aggregation_in_order = 1</query>
    <query>SELECT avg(length(URL)) as x from {table} GROUP BY -CounterID FORMAT Null settings optimize_aggregation_in_order = 1</query>
    <query>SELECT avg(length(URL)) as x from {table} GROUP BY CounterID, EventDate FORMAT Null settings optimize_aggregation_in_order = 1</query>
    <query>SELECT avg(length(URL)) as x from hits_10m_single GROUP BY CounterID, EventDate, intHash32(UserID) FORMAT Null settings optimize_aggregation_in_order = 1</query>

</test>
