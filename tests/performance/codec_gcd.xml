<test>
    <create_query>
        CREATE TABLE IF NOT EXISTS gcd_codec (n UInt64 CODEC(GCD, LZ4))
        ENGINE = MergeTree PARTITION BY tuple() ORDER BY tuple()
        SETTINGS parts_to_delay_insert = 5000, parts_to_throw_insert = 5000;
    </create_query>

    <query>INSERT INTO gcd_codec SELECT number*1000 FROM system.numbers LIMIT 20000000 SETTINGS max_threads=1</query>
    <query>SELECT * FROM gcd_codec LIMIT 20000000 SETTINGS max_threads=1</query>

    <drop_query>DROP TABLE IF EXISTS gcd_codec</drop_query>
</test>
