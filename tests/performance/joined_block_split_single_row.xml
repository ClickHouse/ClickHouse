<test>
    <create_query>CREATE TABLE left (id UInt64, payload String) ENGINE = MergeTree ORDER BY id</create_query>
    <create_query>CREATE TABLE right (id UInt64, payload String) ENGINE = MergeTree ORDER BY id</create_query>

    <fill_query>INSERT INTO left SELECT number, repeat('aaa', 100) FROM numbers(100)</fill_query>
    <fill_query>INSERT INTO right SELECT number % 100, repeat('bbb', 10) FROM numbers(100_000)</fill_query>

    <query>
        SELECT * FROM left JOIN right ON left.id = right.id
        SETTINGS query_plan_join_swap_table = 0, joined_block_split_single_row = 1, max_joined_block_size_rows = 512
    </query>

    <query>
        SELECT * FROM left JOIN right ON left.id = right.id
        SETTINGS query_plan_join_swap_table = 0, joined_block_split_single_row = 1
    </query>

    <query>
        SELECT * FROM left JOIN right ON left.id = right.id
        SETTINGS query_plan_join_swap_table = 0, joined_block_split_single_row = 0
    </query>

    <drop_query>DROP TABLE IF EXISTS left</drop_query>
    <drop_query>DROP TABLE IF EXISTS right</drop_query>
</test>
