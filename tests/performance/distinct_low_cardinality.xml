<test>
    <drop_query>
        DROP TABLE IF EXISTS distinct_high_cardinality_lc;
    </drop_query>

    <drop_query>
        DROP TABLE IF EXISTS distinct_low_cardinality_lc;
    </drop_query>

    <create_query>
        CREATE TABLE distinct_high_cardinality_lc
        (
            id UInt32,
            lc LowCardinality(String)
        )
        ENGINE = MergeTree
        ORDER BY id;
    </create_query>

    <create_query>
        INSERT INTO distinct_high_cardinality_lc
        SELECT
            number AS id,
            toLowCardinality(toString(number % 5000)) AS lc
        FROM numbers(10000000);
    </create_query>

    <create_query>
        CREATE TABLE distinct_low_cardinality_lc
        (
            id UInt32,
            lc LowCardinality(String)
        )
        ENGINE = MergeTree
        ORDER BY id;
    </create_query>

    <create_query>
        INSERT INTO distinct_low_cardinality_lc
        SELECT
            number AS id,
            toLowCardinality(toString(number % 100)) AS lc
        FROM numbers(10000000);
    </create_query>

    <query>
        SELECT DISTINCT lc
        FROM distinct_high_cardinality_lc
        FORMAT NULL;
    </query>

    <query>
        SELECT DISTINCT lc
        FROM distinct_low_cardinality_lc
        FORMAT NULL;
    </query>

    <drop_query>
        DROP TABLE IF EXISTS distinct_high_cardinality_lc;
    </drop_query>

    <drop_query>
        DROP TABLE IF EXISTS distinct_low_cardinality_lc;
    </drop_query>
</test>
