<test>
    <create_query>DROP TABLE IF EXISTS perf_lc</create_query>
    <create_query>CREATE TABLE perf_lc(
        str LowCardinality(String),
        arr Array(LowCardinality(String)) default array(str)
        ) ENGINE = MergeTree() ORDER BY tuple()</create_query>

    <create_query>
        INSERT INTO perf_lc (str)
        SELECT concat('asdf', toString(number % 10000))
        FROM numbers(1000000000)
    </create_query>

    <query>SELECT count() FROM perf_lc WHERE str = 'asdf337'</query>
    <query>SELECT count() FROM perf_lc WHERE arr[1] = 'asdf337'</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, 'asdf337')</query>
    <query>SELECT count() FROM perf_lc WHERE indexOf(arr, 'asdf337') > 0</query>

    <query>SELECT count() FROM perf_lc WHERE arr[1] = str</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, str)</query>
    <query>SELECT count() FROM perf_lc WHERE indexOf(arr, str) > 0</query>

    <query>SELECT count() FROM perf_lc WHERE has(arr, concat('0', str))</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, concat(str, 'str'))</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, concat(str, '0'))</query>

    <drop_query>DROP TABLE IF EXISTS perf_lc</drop_query>
</test>
