<test>
    <create_query>DROP TABLE IF EXISTS perf_lc</create_query>

    <create_query>CREATE TABLE perf_lc(
        str LowCardinality(String),
        arr Array(LowCardinality(String)) default [str]
        ) ENGINE = MergeTree() ORDER BY tuple()
    </create_query>

    <create_query>
        INSERT INTO perf_lc (str)
        SELECT concat('asdf', toString(number % 10000))
        FROM numbers(500000000)
    </create_query>

    <query>SELECT count() FROM perf_lc WHERE str = 'asdf337'</query>
    <query>SELECT count() FROM perf_lc WHERE arr[1] = 'asdf337'</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, 'asdf337')</query>
    <query>SELECT count() FROM perf_lc WHERE indexOf(arr, 'asdf337') > 0</query>

    <query>SELECT count() FROM perf_lc WHERE arr[1] = str</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, str)</query>
    <query>SELECT count() FROM perf_lc WHERE indexOf(arr, str) > 0</query>

    <query>SELECT count() FROM perf_lc WHERE has(arr, concat('0', str))</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, concat(str, 'str'))</query>
    <query>SELECT count() FROM perf_lc WHERE has(arr, concat(str, '0'))</query>

    <drop_query>DROP TABLE IF EXISTS perf_lc</drop_query>

    <create_query>CREATE TABLE perf_lc_num(
        num UInt8,
        arr Array(LowCardinality(Int64)) default [num]
        ) ENGINE = MergeTree() ORDER BY tuple()
    </create_query>

    <create_query>
        INSERT INTO perf_lc_num (num)
        SELECT number % 1000
        FROM numbers(500000000)
    </create_query>

    <query>SELECT count() FROM perf_lc_num WHERE num = 42</query>
    <query>SELECT count() FROM perf_lc_num WHERE arr[1] = 42</query>
    <query>SELECT count() FROM perf_lc_num WHERE has(arr, 42)</query>
    <query>SELECT count() FROM perf_lc_num WHERE indexOf(arr, 42) > 0</query>

    <query>SELECT count() FROM perf_lc_num WHERE arr[1] = num</query>
    <query>SELECT count() FROM perf_lc_num WHERE has(arr, num)</query>
    <query>SELECT count() FROM perf_lc_num WHERE indexOf(arr, num) > 0</query>

    <query>SELECT count() FROM perf_lc_num WHERE has(arr, num * 10)</query>
    <query>SELECT count() FROM perf_lc_num WHERE has(arr, (num * 1000 + 20) % 137)</query>

    <drop_query>DROP TABLE IF EXISTS perf_lc_num</drop_query>
</test>
