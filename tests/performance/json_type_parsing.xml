<test>
    <fill_query>INSERT INTO FUNCTION file(test_json_parsing_1.txt, Raw) SELECT toJSONString(arrayMap(x -> tuple('a' || x, multiIf(x % 6 == 0, x::UInt32, x % 6 == 1, x / 3.333333, x % 6 == 2, randomStringUTF8(16), x % 6 == 3, '2020-01-01', x % 6 == 4, '2020-01-01 10:00:00', '2020-01-01 10:00:00.000')), range(1000))::Map(String, Dynamic)) FROM numbers(10000) SETTINGS use_variant_as_common_type=1, engine_file_truncate_on_insert=1</fill_query>
    <fill_query>INSERT INTO FUNCTION file(test_json_parsing_2.txt, Raw) SELECT toJSONString(arrayMap(x -> tuple('a' || x, [arrayMap(y -> tuple('b' || y, 'Data'), range(20))::Map(String, String)]), range(1000))::Map(String, Dynamic)) FROM numbers(50) SETTINGS use_variant_as_common_type=1, engine_file_truncate_on_insert=1</fill_query>

    <query>SELECT * FROM file(test_json_parsing_1.txt, JSONAsObject, 'json JSON') FORMAT Null</query>
    <query>SELECT * FROM file(test_json_parsing_1.txt, JSONAsObject, 'json JSON(max_dynamic_paths=0)') FORMAT Null</query>
    <query>SELECT * FROM file(test_json_parsing_2.txt, JSONAsObject, 'json JSON') FORMAT Null</query>
    <query>SELECT * FROM file(test_json_parsing_2.txt, JSONAsObject, 'json JSON(max_dynamic_paths=0)') FORMAT Null</query>

    <drop_query>INSERT INTO FUNCTION file(test_json_parsing_1.txt) SELECT * FROM numbers(0) SETTINGS engine_file_truncate_on_insert=1</drop_query>
    <drop_query>INSERT INTO FUNCTION file(test_json_parsing_2.txt) SELECT * FROM numbers(0) SETTINGS engine_file_truncate_on_insert=1</drop_query>
</test>
