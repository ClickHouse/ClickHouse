<test>
    <settings>
        <optimize_fuse_sum_count_avg>true</optimize_fuse_sum_count_avg>
    </settings>
    <!-- We test rewriting sum(), avg(), count() to a single call of sumCount() here.
         As a reference, we use the same queries with the optimization disabled.
         sum() has a highly optimized algorithm, so alone it will be faster than sumCount(),
         but when we add count() or avg(), the sumCount() should win.-->
    <query>SELECT sum(number), avg(number) FROM numbers(1000000000)</query>
    <query>SELECT sum(number), avg(number), count(number) FROM numbers(1000000000)</query>
    <query>SELECT sum(number), avg(number), count(number) FROM numbers(1000000000) settings optimize_fuse_sum_count_avg = 0</query>
    <query>SELECT sum(number), count(number) FROM numbers(1000000000)</query>
    <query>SELECT sum(number), count(number) FROM numbers(1000000000) settings optimize_fuse_sum_count_avg = 0</query>
    <query>SELECT sum(number) FROM numbers(1000000000)</query>
</test>
