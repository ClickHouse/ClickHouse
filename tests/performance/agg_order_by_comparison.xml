<test>
    <name>agg_order_by_with_state_comparison</name>
    <substitutions>
        <substitution>
            <name>group_scale</name>
            <values>
                <value>1000000</value>
                <value>100000</value>
                <value>10000</value>
                <value>1000</value>
                <value>100</value>
                <value>10</value>
            </values>
        </substitution>
    </substitutions>
    <query>
        <!-- Query with ORDER BY on non-grouping columns -->
        SELECT groupArrayOrderBy('RedirectCount DESC')(URL, RedirectCount) AS URLsByEventTimeCharset
        FROM hits_100m_obfuscated WHERE UserID % 113 = 0 GROUP BY UserID % {group_scale} FORMAT Null
    </query>
    <query>
        <!-- Query without ORDER BY -->
        SELECT groupArray(URL) AS URLs
        FROM hits_100m_obfuscated WHERE UserID % 113 = 0 GROUP BY UserID % {group_scale} FORMAT Null
    </query>
</test>
