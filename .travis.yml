sudo: required
dist: trusty

os: linux

cache:
  ccache: true
  directories:
  - /var/cache/pbuilder

before_cache:
  - rm -rf /var/cache/pbuilder/build

addons:
  apt:
    packages: [ pbuilder, fakeroot, debhelper ]

script:
  # Minimizing compile time.
  - env TEST_RUN=1  PBUILDER_OPT="--timeout 35m" DEB_CC=clang-5.0 DEB_CXX=clang++-5.0 CCACHEDIR=~/.ccache CMAKE_FLAGS="-DCMAKE_BUILD_TYPE=Debug -DUNBUNDLED=1 -DENABLE_CAPNP=0 -DENABLE_RDKAFKA=0 -DUSE_EMBEDDED_COMPILER=0" EXTRAPACKAGES="psmisc clang-5.0 libc++abi-dev libc++-dev libboost-dev zlib1g-dev liblz4-dev libdouble-conversion-dev libzookeeper-mt-dev libsparsehash-dev librdkafka-dev libpoco-dev libsparsehash-dev libgoogle-perftools-dev libzstd-dev libre2-dev libunwind-dev" ./release --pbuilder
