---
sidebar_position: 1
sidebar_label: 2025
---

# 2025 Changelog

### ClickHouse release v25.9.6.117-stable (ff2a1965ca6) FIXME as compared to v25.9.5.21-stable (57cfa8fbbf8)

#### Performance Improvement
* Backported in [#90371](https://github.com/ClickHouse/ClickHouse/issues/90371): Enable saving marks in cache and avoid direct IO for the MergeTreeLazy reader. [#87989](https://github.com/ClickHouse/ClickHouse/pull/87989) ([Nikita Taranov](https://github.com/nickitat)).
* Backported in [#89504](https://github.com/ClickHouse/ClickHouse/issues/89504): Queries can now benefit from optimize_read_in_order and query_plan_optimize_lazy_materialization simultaneously. Resolves [#88767](https://github.com/ClickHouse/ClickHouse/issues/88767). [#88866](https://github.com/ClickHouse/ClickHouse/pull/88866) ([Manuel](https://github.com/raimannma)).

#### Improvement
* Backported in [#87816](https://github.com/ClickHouse/ClickHouse/issues/87816): Make flushing to `system.crash_log` in signal handling synchronous. [#87253](https://github.com/ClickHouse/ClickHouse/pull/87253) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* Backported in [#87934](https://github.com/ClickHouse/ClickHouse/issues/87934): Added a new setting `keeper_hosts` that exposes the list of [Zoo]Keeper hosts ClickHouse can connect to. [#87718](https://github.com/ClickHouse/ClickHouse/pull/87718) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
* Backported in [#89244](https://github.com/ClickHouse/ClickHouse/issues/89244): If a skip index used in a FINAL query is on a column that is part of the primary key, the additional step to check for primary key intersection in other parts is unnecessary and now not performed. Resolves [#85897](https://github.com/ClickHouse/ClickHouse/issues/85897). [#88368](https://github.com/ClickHouse/ClickHouse/pull/88368) ([Shankar Iyer](https://github.com/shankar-iyer)).
* Backported in [#89423](https://github.com/ClickHouse/ClickHouse/issues/89423): Subqueries which take part inside IN expressions when querying Iceberg table will be precomputed in the right way before partition pruning analysis. [#89177](https://github.com/ClickHouse/ClickHouse/pull/89177) ([Daniil Ivanik](https://github.com/divanik)).
* Backported in [#90072](https://github.com/ClickHouse/ClickHouse/issues/90072): Fix wrong `FilesystemCacheBytes` (and others) in `system.asynchronous_metrics`. Run `SYSTEM` queries on filesystem caches only once. Atomic view for caches that points to the same path in `system.filesystem_caches`. [#89640](https://github.com/ClickHouse/ClickHouse/pull/89640) ([Azat Khuzhin](https://github.com/azat)).
* Backported in [#90164](https://github.com/ClickHouse/ClickHouse/issues/90164): Changed default of filesystem cache setting `keep_free_space_remove_batch` from 10 to 100, because it is more optimal. [#90030](https://github.com/ClickHouse/ClickHouse/pull/90030) ([Kseniia Sumarokova](https://github.com/kssenii)).
* Backported in [#90351](https://github.com/ClickHouse/ClickHouse/issues/90351): Use lower node limit for RemoveRecursive Keeper request during S3Queue cleanup. [#90201](https://github.com/ClickHouse/ClickHouse/pull/90201) ([Antonio Andelic](https://github.com/antonio2368)).
* Backported in [#90711](https://github.com/ClickHouse/ClickHouse/issues/90711): Retry network errors when S3 library parses XML response. [#90216](https://github.com/ClickHouse/ClickHouse/pull/90216) ([Sema Checherinda](https://github.com/CheSema)).
* Backported in [#90775](https://github.com/ClickHouse/ClickHouse/issues/90775): Update warning messages when approaching guardrails limits: show current and throw values. [#90438](https://github.com/ClickHouse/ClickHouse/pull/90438) ([Nikita Fomichev](https://github.com/fm4v)).

#### Bug Fix (user-visible misbehavior in an official stable release)
* Backported in [#88850](https://github.com/ClickHouse/ClickHouse/issues/88850): Fix inferring Date/DateTime/DateTime64 on dates that are out of supported range. [#86184](https://github.com/ClickHouse/ClickHouse/pull/86184) ([Pavel Kruglov](https://github.com/Avogar)).
* Backported in [#89993](https://github.com/ClickHouse/ClickHouse/issues/89993): Fix creating an array of empty tuples. [#87520](https://github.com/ClickHouse/ClickHouse/pull/87520) ([Pavel Kruglov](https://github.com/Avogar)).
* Backported in [#89576](https://github.com/ClickHouse/ClickHouse/issues/89576): Fix reading mixed array of Floats and Bools in JSON. Previously inserting such data led to an exception. [#88008](https://github.com/ClickHouse/ClickHouse/pull/88008) ([Pavel Kruglov](https://github.com/Avogar)).
* Backported in [#89278](https://github.com/ClickHouse/ClickHouse/issues/89278): Using shared_ptr for QueryState in TCPHandler to detect if the state is invalid in setProgressCallback, setFileProgressCallback and setBlockMarshallingCallback. [#88201](https://github.com/ClickHouse/ClickHouse/pull/88201) ([Tuan Pham Anh](https://github.com/tuanpach)).
* Backported in [#89239](https://github.com/ClickHouse/ClickHouse/issues/89239): Fix SQL SECURITY DEFINER with *cluster functions. [#88588](https://github.com/ClickHouse/ClickHouse/pull/88588) ([Julian Maicher](https://github.com/jmaicher)).
* Backported in [#89444](https://github.com/ClickHouse/ClickHouse/issues/89444): Fix possible "Context has expired" with new analyzer with subqueries. [#88694](https://github.com/ClickHouse/ClickHouse/pull/88694) ([Azat Khuzhin](https://github.com/azat)).
* Backported in [#89464](https://github.com/ClickHouse/ClickHouse/issues/89464): Fix propagation of size restrictions by settings max_table_size_to_drop and max_partition_size_to_drop on DROP of inner tables. [#88812](https://github.com/ClickHouse/ClickHouse/pull/88812) ([Nikolay Degterinsky](https://github.com/evillique)).
* Backported in [#89293](https://github.com/ClickHouse/ClickHouse/issues/89293): Fix ACCESS_ENTITY_NOT_FOUND error when trying to execute clusterAllReplicas from a user with a non-existing role. Resolves [#87670](https://github.com/ClickHouse/ClickHouse/issues/87670). [#89068](https://github.com/ClickHouse/ClickHouse/pull/89068) ([pufit](https://github.com/pufit)).
* Backported in [#89324](https://github.com/ClickHouse/ClickHouse/issues/89324): Fix calculation of buffer size needed for base32/base58 encoding and decoding operations. [#89133](https://github.com/ClickHouse/ClickHouse/pull/89133) ([Antonio Andelic](https://github.com/antonio2368)).
* Backported in [#89266](https://github.com/ClickHouse/ClickHouse/issues/89266): Refreshable materialized view: fixed rare server crash if source table was fully dropped during a refresh. [#89203](https://github.com/ClickHouse/ClickHouse/pull/89203) ([Michael Kolupaev](https://github.com/al13n321)).
* Backported in [#90147](https://github.com/ClickHouse/ClickHouse/issues/90147): Prevent query masking rules from being incorrectly applied to DDL statements. [#89272](https://github.com/ClickHouse/ClickHouse/pull/89272) ([MikhailBurdukov](https://github.com/MikhailBurdukov)).
* Backported in [#89485](https://github.com/ClickHouse/ClickHouse/issues/89485): Fixed incorrect merge handling of TTL-emptied parts with non-empty projections when using `deduplicate_merge_projection_mode='ignore'`. Resolves [#89430](https://github.com/ClickHouse/ClickHouse/issues/89430). [#89458](https://github.com/ClickHouse/ClickHouse/pull/89458) ([Amos Bird](https://github.com/amosbird)).
* Backported in [#89568](https://github.com/ClickHouse/ClickHouse/issues/89568): Fix reading of changelogs during Keeper startup in cases a changelog was not renamed properly during rotation. [#89496](https://github.com/ClickHouse/ClickHouse/pull/89496) ([Antonio Andelic](https://github.com/antonio2368)).
* Backported in [#89631](https://github.com/ClickHouse/ClickHouse/issues/89631): Fix incorrect JOIN results when using OR conditions with unique right table keys. Resolves [#89391](https://github.com/ClickHouse/ClickHouse/issues/89391). [#89512](https://github.com/ClickHouse/ClickHouse/pull/89512) ([Vladimir Cherkasov](https://github.com/vdimir)).
* Backported in [#89593](https://github.com/ClickHouse/ClickHouse/issues/89593): Fix possible "Context has expired" with analyzer and PK IN (subquery) (v2). Fixes [#89433](https://github.com/ClickHouse/ClickHouse/issues/89433). [#89527](https://github.com/ClickHouse/ClickHouse/pull/89527) ([Azat Khuzhin](https://github.com/azat)).
* Backported in [#89686](https://github.com/ClickHouse/ClickHouse/issues/89686): Fix a crash in case if a state of an aggregate function contains a serialized value of a column of LowCardinality(String). [#89550](https://github.com/ClickHouse/ClickHouse/pull/89550) ([Pavel Kruglov](https://github.com/Avogar)).
* Backported in [#90283](https://github.com/ClickHouse/ClickHouse/issues/90283): Fix logical error with query_plan_convert_join_to_in. Resolves [#89066](https://github.com/ClickHouse/ClickHouse/issues/89066). [#89554](https://github.com/ClickHouse/ClickHouse/pull/89554) ([Vladimir Cherkasov](https://github.com/vdimir)).
* Backported in [#90737](https://github.com/ClickHouse/ClickHouse/issues/90737): Avoid crash due to reading from remote server after disconnect in remote queries during cancellation. Resolves [#89468](https://github.com/ClickHouse/ClickHouse/issues/89468). [#89740](https://github.com/ClickHouse/ClickHouse/pull/89740) ([Azat Khuzhin](https://github.com/azat)).
* Backported in [#89859](https://github.com/ClickHouse/ClickHouse/issues/89859): Fix possible logical error during reading of paths and their subcolumns in advanced JSON shared data serialization. Closes [#89805](https://github.com/ClickHouse/ClickHouse/issues/89805). [#89819](https://github.com/ClickHouse/ClickHouse/pull/89819) ([Pavel Kruglov](https://github.com/Avogar)).
* Backported in [#90191](https://github.com/ClickHouse/ClickHouse/issues/90191): Fix possible stack overflow in data types binary deserialization. Closes [#88710](https://github.com/ClickHouse/ClickHouse/issues/88710). [#89822](https://github.com/ClickHouse/ClickHouse/pull/89822) ([Pavel Kruglov](https://github.com/Avogar)).
* Backported in [#89902](https://github.com/ClickHouse/ClickHouse/issues/89902): Fix logical error with empty tuple inside `IN` function. Closes [#88343](https://github.com/ClickHouse/ClickHouse/issues/88343). [#89850](https://github.com/ClickHouse/ClickHouse/pull/89850) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* Backported in [#89892](https://github.com/ClickHouse/ClickHouse/issues/89892): Remove injective functions from `GROUP BY` regardless `optimize_injective_functions_in_group_by` in old analyzer for compatibility. Resolves [#89854](https://github.com/ClickHouse/ClickHouse/issues/89854). [#89870](https://github.com/ClickHouse/ClickHouse/pull/89870) ([Raufs Dunamalijevs](https://github.com/rienath)).
* Backported in [#89935](https://github.com/ClickHouse/ClickHouse/issues/89935): Fix logical error with empty tuple inside `reverse` and `CAST` function. Closes [#89137](https://github.com/ClickHouse/ClickHouse/issues/89137). [#89908](https://github.com/ClickHouse/ClickHouse/pull/89908) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* Backported in [#89963](https://github.com/ClickHouse/ClickHouse/issues/89963): Fix using native copy on GCS for backups. Because of incorrect client cloning, GCS native copy always failed and used less optimal approach of manual reading and writing the data. [#89923](https://github.com/ClickHouse/ClickHouse/pull/89923) ([Antonio Andelic](https://github.com/antonio2368)).
* Backported in [#90037](https://github.com/ClickHouse/ClickHouse/issues/90037): Fix buffer size calculation for base32Encode. Calculating base32Encode for column of strings of size smaller than 5 could lead to crashes. Resolves [#89911](https://github.com/ClickHouse/ClickHouse/issues/89911). [#89929](https://github.com/ClickHouse/ClickHouse/pull/89929) ([Antonio Andelic](https://github.com/antonio2368)).
* Backported in [#90107](https://github.com/ClickHouse/ClickHouse/issues/90107): Fix wrong escaping for `SHOW COLUMNS` and `SHOW FUNCTIONS` queries. [#89942](https://github.com/ClickHouse/ClickHouse/pull/89942) ([alesapin](https://github.com/alesapin)).
* Backported in [#90356](https://github.com/ClickHouse/ClickHouse/issues/90356): Fix URL validation in MongoDB engine when username contains '@' character. Previously, usernames with '@' would cause an error due to improper encoding. [#89970](https://github.com/ClickHouse/ClickHouse/pull/89970) ([Kai Zhu](https://github.com/nauu)).
* Backported in [#90088](https://github.com/ClickHouse/ClickHouse/issues/90088): Fix logical error caused by empty tuple column in `BSONEachRow` and `MsgPack`. Closes [#89814](https://github.com/ClickHouse/ClickHouse/issues/89814). Closes [#71536](https://github.com/ClickHouse/ClickHouse/issues/71536). [#90018](https://github.com/ClickHouse/ClickHouse/pull/90018) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* Backported in [#90502](https://github.com/ClickHouse/ClickHouse/issues/90502): Do size checks when deserializing data from aggregation states and other sources. [#90031](https://github.com/ClickHouse/ClickHouse/pull/90031) ([Raúl Marín](https://github.com/Algunenano)).
* Backported in [#90183](https://github.com/ClickHouse/ClickHouse/issues/90183): Allow files starting with dots in user_files. Closes [#89662](https://github.com/ClickHouse/ClickHouse/issues/89662). [#90079](https://github.com/ClickHouse/ClickHouse/pull/90079) ([Raúl Marín](https://github.com/Algunenano)).
* Backported in [#90293](https://github.com/ClickHouse/ClickHouse/issues/90293): Fix incorrect formatting of certain skip indexes in the table definition, causing `METADATA_MISMATCH` and breaking creation of new replicas in the Replicated Database. [#90251](https://github.com/ClickHouse/ClickHouse/pull/90251) ([Nikolay Degterinsky](https://github.com/evillique)).
* Backported in [#90621](https://github.com/ClickHouse/ClickHouse/issues/90621): Fix possible logical error in prewhere on non-existing JSON path with index_granularity_bytes=0. Resolves [#86924](https://github.com/ClickHouse/ClickHouse/issues/86924). [#90375](https://github.com/ClickHouse/ClickHouse/pull/90375) ([Pavel Kruglov](https://github.com/Avogar)).

#### Build/Testing/Packaging Improvement
* Backported in [#90332](https://github.com/ClickHouse/ClickHouse/issues/90332): Bump `icu` from `release-75.1` to `release-78.1`. [#90060](https://github.com/ClickHouse/ClickHouse/pull/90060) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* Backported in [#90236](https://github.com/ClickHouse/ClickHouse/issues/90236): Bump curl from 8.15.0 to 8.17.0. [#90061](https://github.com/ClickHouse/ClickHouse/pull/90061) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* Backported in [#90229](https://github.com/ClickHouse/ClickHouse/issues/90229): Bump `libarchive` from 3.8.1 to 3.8.2. [#90062](https://github.com/ClickHouse/ClickHouse/pull/90062) ([Konstantin Bogdanov](https://github.com/thevar1able)).

#### NO CL CATEGORY

* Backported in [#88954](https://github.com/ClickHouse/ClickHouse/issues/88954):. [#88828](https://github.com/ClickHouse/ClickHouse/pull/88828) ([scanhex12](https://github.com/scanhex12)).
* Backported in [#89647](https://github.com/ClickHouse/ClickHouse/issues/89647):. [#89581](https://github.com/ClickHouse/ClickHouse/pull/89581) ([Vladimir Cherkasov](https://github.com/vdimir)).

#### NOT FOR CHANGELOG / INSIGNIFICANT

* Backported in [#90197](https://github.com/ClickHouse/ClickHouse/issues/90197): Backporting function firstNonDefault. [#88441](https://github.com/ClickHouse/ClickHouse/pull/88441) ([Vladimir Cherkasov](https://github.com/vdimir)).
* Backported in [#89520](https://github.com/ClickHouse/ClickHouse/issues/89520): Fix potential heap-use-after-free in projections analysis after [#72102](https://github.com/ClickHouse/ClickHouse/issues/72102). [#89139](https://github.com/ClickHouse/ClickHouse/pull/89139) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* Backported in [#89969](https://github.com/ClickHouse/ClickHouse/issues/89969): Only change S3Queue metadata in Keeper on the initial replica. [#89259](https://github.com/ClickHouse/ClickHouse/pull/89259) ([Nikolay Degterinsky](https://github.com/evillique)).
* Backported in [#89416](https://github.com/ClickHouse/ClickHouse/issues/89416): Revert "Do not perform PrimaryKeyExpand step if skip index is already part of primary key". [#89395](https://github.com/ClickHouse/ClickHouse/pull/89395) ([Shankar Iyer](https://github.com/shankar-iyer)).
* Ci add stateless tests to 25.9. [#89646](https://github.com/ClickHouse/ClickHouse/pull/89646) ([Daniil Ivanik](https://github.com/divanik)).
* Backported in [#90049](https://github.com/ClickHouse/ClickHouse/issues/90049): Prevent false positive error on empty LowCardinality indexes. [#89680](https://github.com/ClickHouse/ClickHouse/pull/89680) ([Max Kainov](https://github.com/maxknv)).
* Backported in [#89787](https://github.com/ClickHouse/ClickHouse/issues/89787): Speed up test_refreshable_mv_skip_old_temp_table_ddls. [#89692](https://github.com/ClickHouse/ClickHouse/pull/89692) ([Tuan Pham Anh](https://github.com/tuanpach)).
* Backported in [#89829](https://github.com/ClickHouse/ClickHouse/issues/89829): Fix Changes History of Iceberg settings in recent versions. [#89804](https://github.com/ClickHouse/ClickHouse/pull/89804) ([Daniil Ivanik](https://github.com/divanik)).
* Backported in [#90533](https://github.com/ClickHouse/ClickHouse/issues/90533): Add more diagnostic to logical error in JSON. [#90286](https://github.com/ClickHouse/ClickHouse/pull/90286) ([Pavel Kruglov](https://github.com/Avogar)).

