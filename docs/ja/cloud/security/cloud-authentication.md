---
sidebar_label: クラウド認証
slug: /ja/cloud/security/cloud-authentication
title: クラウド認証
---
# クラウド認証

ClickHouse Cloudは、認証方法をいくつか提供しています。このガイドでは、認証を構成するための良いプラクティスを説明します。認証方法を選択する際は、必ずセキュリティチームに確認してください。

## パスワード設定

コンソールとサービス（データベース）の最小パスワード設定は、現在 [NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) 認証器保証レベル1に準拠しています。
- 最小12文字
- 次の4項目のうち、3項目を含む:
   - 1つの大文字
   - 1つの小文字
   - 1つの数字
   - 1つの特殊文字

## メール + パスワード

ClickHouse Cloudでは、メールアドレスとパスワードで認証することができます。この方法を使用する際、ClickHouseアカウントを保護する最良の方法は強力なパスワードを使用することです。覚えやすいパスワードを考えるためのオンラインリソースはいくつもあります。また、ランダムなパスワード生成器を使用し、パスワードマネージャーにパスワードを保管することでセキュリティを強化できます。

## GoogleまたはMicrosoftのソーシャル認証を使用したSSO

あなたの会社がGoogle WorkspaceまたはMicrosoft 365を使用している場合、現在のシングルサインオン（SSO）のセットアップをClickHouse Cloud内で利用できます。このためには、単に会社のメールアドレスでサインアップし、そのメールアドレスを使用して他のユーザーを招待します。その結果、ユーザーは、ClickHouse Cloudに認証する前に、会社のログインフロー（IDプロバイダー経由または直接GoogleまたはMicrosoft認証を通じて）を使用してログインする必要があります。

## 多要素認証

メール＋パスワードまたはソーシャル認証を持つユーザーは、多要素認証（MFA）を使用して、アカウントの安全性をさらに高めることができます。MFAを設定するには:
1. console.clickhouse.cloudにログイン
2. ClickHouseロゴの隣にある左上のイニシャルをクリック
3. プロフィールを選択
4. 左側のセキュリティを選択
5. 認証アプリタイルの「セットアップ」をクリック
6. Authy、1Password、またはGoogle Authenticatorなどの認証アプリを使用してQRコードをスキャン
7. コードを入力して確認
8. 次の画面で復旧コードをコピーし、安全な場所に保存
9. `私はこのコードを安全に記録しました`のチェックボックスをオン
10. 続行をクリック
    
## アカウントリカバリー

<details> 
   <summary>復旧コードを取得</summary>

   以前にMFAに登録し、復旧コードを作成していないか紛失した場合は、新しい復旧コードを取得するために以下の手順に従ってください。
   1. https://console.clickhouse.cloudにアクセス
   2. 資格情報とMFAでサインイン
   3. 左上のプロフィールに移動
   4. 左側のセキュリティをクリック
   5. 認証アプリの横にあるゴミ箱をクリック
   6. 認証アプリを削除
   7. コードを入力して続行をクリック
   8. 認証アプリセクションでセットアップをクリック
   9. QRコードをスキャンして新しいコードを入力
   10. 復旧コードをコピーして安全な場所に保存
   11. `私はこのコードを安全に記録しました`のチェックボックスをオン
   12. 続行をクリック
   
</details>
<details>
   <summary>パスワードを忘れた場合</summary>

   パスワードを忘れた場合、自分で回復するための手順は以下の通りです:
   1. https://console.clickhouse.cloudにアクセス
   2. メールアドレスを入力して続行をクリック
   3. パスワードをお忘れですか？をクリック
   4. パスワードリセットリンクを送信をクリック
   5. メールをチェックして、メールからパスワードをリセットをクリック
   6. 新しいパスワードを入力し、パスワードを確認して、パスワードの更新をクリック
   7. サインインに戻るをクリック
   8. 新しいパスワードで通常通りサインイン
   
</details>
<details>
   <summary>MFAデバイスまたはトークンを紛失した場合</summary>

   MFAデバイスを紛失するか、トークンを削除した場合、新しいトークンを作成するための手順は以下の通りです:
   1. https://console.clickhouse.cloudにアクセス
   2. 資格情報を入力して続行をクリック
   3. 多要素認証画面でキャンセルをクリック
   4. 復旧コードをクリック
   5. コードを入力して続行を押す
   6. 新しい復旧コードをコピーして、安全な場所に保管
   7. `私はこのコードを安全に記録しました`のボックスをチェックし、続行をクリック
   8. サインイン後、左上のプロフィールに移動
   9. 左上のセキュリティをクリック
   10. 認証アプリの横にあるゴミ箱アイコンをクリックし、古い認証アプリを削除
   11. 認証アプリを削除をクリック
   12. 多要素認証を求められたらキャンセルをクリック
   13. 復旧コードをクリック
   14. 復旧コード（ステップ7で生成された新しいコード）を入力して続行をクリック
   15. 新しい復旧コードをコピーし、安全な場所に保管 - 削除プロセス中に画面を離れた場合のフェイルセーフです
   16. `私はこのコードを安全に記録しました`のチェックボックスをオンにして続行
   17. 新しいMFAファクターを設定するための上記の手順に従う
       
</details>
<details>
   <summary>MFAと復旧コードを両方とも紛失した場合</summary>

   MFAデバイスと復旧コードを両方とも紛失した、またはMFAデバイスを紛失し、復旧コードを取得したことがない場合、リセットをリクエストするためには以下の手順に従ってください。

   **チケットを提出する**: 他の管理ユーザーがいる組織にいる場合、たとえ一人だけのユーザー組織にアクセスしようとしている場合であっても、組織にログインし、あなたに代わってMFAをリセットするようサポートチケットを提出する役割を持つ組織のメンバーに依頼してください。リクエストが認証されたことを確認後、MFAをリセットし、管理者に通知します。通常通りにMFAなしでサインインし、新しいファクターを登録したい場合はプロフィール設定に移動してください。

   **メールでリセット**: 組織の唯一のユーザーである場合は、アカウントに紐付けられたメールアドレスを使用して、サポートケースをメール（support@clickhouse.com）で提出してください。正しいメールからのリクエストであることを確認後、MFAとパスワードをリセットします。パスワードリセットリンクにアクセスするにはメールを確認してください。新しいパスワードを設定し、新しいファクターを登録したい場合はプロフィール設定に移動します。
   
</details>

## SAML SSO

ClickHouse Cloudは、セキュリティアサーションマークアップ言語（SAML）シングルサインオン（SSO）もサポートしています。詳細については、[SAML SSOの設定](/docs/ja/cloud/security/saml-setup)を参照してください。

## データベースユーザーID + パスワード

パスワードを保護するために、[ユーザーアカウントを作成する](/docs/ja/sql-reference/statements/create/user.md)際にSHA256_hashメソッドを使用してください。

**TIP:** 管理権限のないユーザーは自分でパスワードを設定できないので、ユーザーにパスワードを生成器でハッシュするよう依頼し、[このツール](https://tools.keycdn.com/sha256-online-generator)などを使用してから、それを管理者に提供してアカウントを設定してもらいます。パスワードは上記の[要件](#establish-strong-passwords)に従う必要があります。

```
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
