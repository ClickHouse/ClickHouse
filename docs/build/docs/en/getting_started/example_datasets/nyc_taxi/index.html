



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.2.1">
    
    
      
        <title>New York Taxi data - ClickHouse Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.ac64251e.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/custom.css">
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="white" data-md-color-accent="white">
    
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">

  <!-- Yandex.Metrika counter -->
  <script type="text/javascript">
      (function (d, w, c) {
          (w[c] = w[c] || []).push(function() {
              try {
                  w.yaCounter18343495 = new Ya.Metrika2({
                      id:18343495,
                      clickmap:true,
                      trackLinks:true,
                      accurateTrackBounce:true,
                      webvisor: true
                  });
              } catch(e) { }
          });
          var n = d.getElementsByTagName("script")[0],
              s = d.createElement("script"),
              f = function () { n.parentNode.insertBefore(s, n); };
          s.type = "text/javascript";
          s.async = true;
          s.src = "https://mc.yandex.ru/metrika/tag.js";
          if (w.opera == "[object Opera]") {
              d.addEventListener("DOMContentLoaded", f, false);
          } else { f(); }
      })(document, window, "yandex_metrika_callbacks2");
  </script>
  <noscript>
      <div><img src="https://mc.yandex.ru/watch/18343495" style="position:absolute; left:-9999px;" alt=""/></div>
  </noscript>
  <!-- /Yandex.Metrika counter -->

  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="/" title="ClickHouse Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../../images/logo.svg" width="40" height="40">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                ClickHouse Documentation
              </span>
              <span class="md-header-nav__topic">
                New York Taxi data
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <script type="text/javascript">
                if (window.location.pathname.indexOf('/ru/') >= 0) {
                  url = window.location.pathname.replace('/ru/', '/en/');
                  text = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"30\" viewBox=\"0,0 25,15\" style=\"border:1px solid #eee;margin: .8rem 0 0 -1.25rem;\">\n" +
                      "<rect width=\"25\" height=\"15\" fill=\"#00247d\"></rect>\n" +
                      "<path d=\"M 0,0 L 25,15 M 25,0 L 0,15\" stroke=\"#fff\" stroke-width=\"3\"></path>\n" +
                      "<path d=\"M 12.5,0 V 15 M 0,7.5 H 25\" stroke=\"#fff\" stroke-width=\"5\"></path>\n" +
                      "<path d=\"M 12.5,0 V 15 M 0,7.5 H 25\" stroke=\"#cf142b\" stroke-width=\"3\"></path>\n" +
                      "</svg>";
                  title = "Switch to English"
                }else{
                  url = window.location.pathname.replace('/en/', '/ru/');
                  text = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 10 6\" width=\"50\" height=\"30\" style=\"border: 1px solid #eee;margin: .8rem 0 0 -1.25rem\">\n" +
                      "<rect fill=\"#fff\" width=\"10\" height=\"3\"></rect>\n" +
                      "<rect fill=\"#d52b1e\" y=\"3\" width=\"10\" height=\"3\"></rect>\n" +
                      "<rect fill=\"#0039a6\" y=\"2\" width=\"10\" height=\"2\"></rect>\n" +
                      "</svg>";
                  title = "Переключить на русский язык"
               }
               document.write('<a href="' + url + '" title="' + title + '" class="md-flex__ellipsis md-header-nav__title">' + text + '</a>')
             </script>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    ClickHouse Documentation
  </label>

  <ul class="md-nav__list" data-md-scrollfix>
    <li class="md-nav__item md-nav__item--active">
      <script type="text/javascript">
        if (window.location.pathname.indexOf('/ru/') >= 0) {
          if (window.location.pathname.indexOf('/single/') >= 0) {
            document.write("<a href=\"../../../../\" class=\"md-nav__link md-nav__link--active\">Многостраничная версия</a>")
          } else {
            document.write("<a href=\"../../../single/\" class=\"md-nav__link md-nav__link--active\">Одностраничная версия</a>")
          }
        }else{
          if (window.location.pathname.indexOf('/single/') >= 0) {
            document.write("<a href=\"../../../../\" class=\"md-nav__link md-nav__link--active\">Multi page version</a>")
          }else{
            document.write("<a href=\"../../../single/\" class=\"md-nav__link md-nav__link--active\">Single page version</a>")
          }
        }
     </script>
    </li>
    <li class="md-nav__item md-nav__item--active">
      <a href="https://github.com/yandex/ClickHouse/" rel="external nofollow" target="_blank" class="md-nav__link">
        <script type="text/javascript">
        if (window.location.pathname.indexOf('/ru/') >= 0) {
          document.write('Исходники ClickHouse');
        } else {
          document.write('ClickHouse sources');
        }
     </script>
      </a>
    </li>
  </ul>

  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="ClickHouse" class="md-nav__link">
      ClickHouse
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/distinctive_features/" title="Distinctive features of ClickHouse" class="md-nav__link">
      Distinctive features of ClickHouse
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/features_considered_disadvantages/" title="ClickHouse features that can be considered disadvantages" class="md-nav__link">
      ClickHouse features that can be considered disadvantages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/ya_metrika_task/" title="The Yandex.Metrica task" class="md-nav__link">
      The Yandex.Metrica task
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/possible_silly_questions/" title="Everything you were afraid to ask" class="md-nav__link">
      Everything you were afraid to ask
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../introduction/performance/" title="Performance" class="md-nav__link">
      Performance
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Getting started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="Deploying and running" class="md-nav__link">
      Deploying and running
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Testing data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Testing data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ontime/" title="OnTime" class="md-nav__link">
      OnTime
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        New York Taxi data
      </label>
    
    <a href="./" title="New York Taxi data" class="md-nav__link md-nav__link--active">
      New York Taxi data
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-import-the-raw-data" title="How to import the raw data" class="md-nav__link">
    How to import the raw data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results-on-single-server" title="Results on single server" class="md-nav__link">
    Results on single server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../amplab_benchmark/" title="AMPLab Big Data Benchmark" class="md-nav__link">
      AMPLab Big Data Benchmark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wikistat/" title="WikiStat" class="md-nav__link">
      WikiStat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../criteo/" title="Terabyte click logs from Criteo" class="md-nav__link">
      Terabyte click logs from Criteo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../star_schema/" title="Star Schema Benchmark" class="md-nav__link">
      Star Schema Benchmark
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Interfaces
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Interfaces
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interfaces/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interfaces/cli/" title="Command-line client" class="md-nav__link">
      Command-line client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interfaces/http_interface/" title="HTTP interface" class="md-nav__link">
      HTTP interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interfaces/jdbc/" title="JDBC driver" class="md-nav__link">
      JDBC driver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interfaces/tcp/" title="Native interface (TCP)" class="md-nav__link">
      Native interface (TCP)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interfaces/third-party_client_libraries/" title="Libraries from third-party developers" class="md-nav__link">
      Libraries from third-party developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../interfaces/third-party_gui/" title="Visual interfaces from third-party developers" class="md-nav__link">
      Visual interfaces from third-party developers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Query language
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Query language
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../query_language/queries/" title="Queries" class="md-nav__link">
      Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../query_language/syntax/" title="Syntax" class="md-nav__link">
      Syntax
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Table engines
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Table engines
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/tinylog/" title="TinyLog" class="md-nav__link">
      TinyLog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/log/" title="Log" class="md-nav__link">
      Log
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/memory/" title="Memory" class="md-nav__link">
      Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/mergetree/" title="MergeTree" class="md-nav__link">
      MergeTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/custom_partitioning_key/" title="Custom partitioning key" class="md-nav__link">
      Custom partitioning key
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/replacingmergetree/" title="ReplacingMergeTree" class="md-nav__link">
      ReplacingMergeTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/summingmergetree/" title="SummingMergeTree" class="md-nav__link">
      SummingMergeTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/aggregatingmergetree/" title="AggregatingMergeTree" class="md-nav__link">
      AggregatingMergeTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/collapsingmergetree/" title="CollapsingMergeTree" class="md-nav__link">
      CollapsingMergeTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/graphitemergetree/" title="GraphiteMergeTree" class="md-nav__link">
      GraphiteMergeTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/replication/" title="Data replication" class="md-nav__link">
      Data replication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/distributed/" title="Distributed" class="md-nav__link">
      Distributed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/dictionary/" title="Dictionary" class="md-nav__link">
      Dictionary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/merge/" title="Merge" class="md-nav__link">
      Merge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/buffer/" title="Buffer" class="md-nav__link">
      Buffer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/file/" title="File" class="md-nav__link">
      File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/null/" title="Null" class="md-nav__link">
      Null
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/set/" title="Set" class="md-nav__link">
      Set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/join/" title="Join" class="md-nav__link">
      Join
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/view/" title="View" class="md-nav__link">
      View
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/materializedview/" title="MaterializedView" class="md-nav__link">
      MaterializedView
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/mysql/" title="MySQL" class="md-nav__link">
      MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_engines/external_data/" title="External data for query processing" class="md-nav__link">
      External data for query processing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      System tables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        System tables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.one/" title="system.one" class="md-nav__link">
      system.one
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.numbers/" title="system.numbers" class="md-nav__link">
      system.numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.numbers_mt/" title="system.numbers_mt" class="md-nav__link">
      system.numbers_mt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.databases/" title="system.databases" class="md-nav__link">
      system.databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.tables/" title="system.tables" class="md-nav__link">
      system.tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.columns/" title="system.columns" class="md-nav__link">
      system.columns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.parts/" title="system.parts" class="md-nav__link">
      system.parts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.processes/" title="system.processes" class="md-nav__link">
      system.processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.merges/" title="system.merges" class="md-nav__link">
      system.merges
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.events/" title="system.events" class="md-nav__link">
      system.events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.metrics/" title="system.metrics" class="md-nav__link">
      system.metrics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.asynchronous_metrics/" title="system.asynchronous_metrics" class="md-nav__link">
      system.asynchronous_metrics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.replicas/" title="system.replicas" class="md-nav__link">
      system.replicas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.dictionaries/" title="system.dictionaries" class="md-nav__link">
      system.dictionaries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.clusters/" title="system.clusters" class="md-nav__link">
      system.clusters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.functions/" title="system.functions" class="md-nav__link">
      system.functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.settings/" title="system.settings" class="md-nav__link">
      system.settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../system_tables/system.zookeeper/" title="system.zookeeper" class="md-nav__link">
      system.zookeeper
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Table functions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Table functions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_functions/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_functions/remote/" title="remote" class="md-nav__link">
      remote
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_functions/merge/" title="merge" class="md-nav__link">
      merge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../table_functions/numbers/" title="numbers" class="md-nav__link">
      numbers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Formats
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Formats
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/tabseparated/" title="TabSeparated" class="md-nav__link">
      TabSeparated
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/tabseparatedraw/" title="TabSeparatedRaw" class="md-nav__link">
      TabSeparatedRaw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/tabseparatedwithnames/" title="TabSeparatedWithNames" class="md-nav__link">
      TabSeparatedWithNames
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/tabseparatedwithnamesandtypes/" title="TabSeparatedWithNamesAndTypes" class="md-nav__link">
      TabSeparatedWithNamesAndTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/csv/" title="CSV" class="md-nav__link">
      CSV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/csvwithnames/" title="CSVWithNames" class="md-nav__link">
      CSVWithNames
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/values/" title="Values" class="md-nav__link">
      Values
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/vertical/" title="Vertical" class="md-nav__link">
      Vertical
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/verticalraw/" title="VerticalRaw" class="md-nav__link">
      VerticalRaw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/json/" title="JSON" class="md-nav__link">
      JSON
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/jsoncompact/" title="JSONCompact" class="md-nav__link">
      JSONCompact
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/jsoneachrow/" title="JSONEachRow" class="md-nav__link">
      JSONEachRow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/tskv/" title="TSKV" class="md-nav__link">
      TSKV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/pretty/" title="Pretty" class="md-nav__link">
      Pretty
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/prettycompact/" title="PrettyCompact" class="md-nav__link">
      PrettyCompact
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/prettycompactmonoblock/" title="PrettyCompactMonoBlock" class="md-nav__link">
      PrettyCompactMonoBlock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/prettynoescapes/" title="PrettyNoEscapes" class="md-nav__link">
      PrettyNoEscapes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/prettyspace/" title="PrettySpace" class="md-nav__link">
      PrettySpace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/rowbinary/" title="RowBinary" class="md-nav__link">
      RowBinary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/native/" title="Native" class="md-nav__link">
      Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/null/" title="Null" class="md-nav__link">
      Null
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/xml/" title="XML" class="md-nav__link">
      XML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../formats/capnproto/" title="CapnProto" class="md-nav__link">
      CapnProto
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Data types
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Data types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/int_uint/" title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="md-nav__link">
      UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/float/" title="Float32, Float64" class="md-nav__link">
      Float32, Float64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/boolean/" title="Boolean values" class="md-nav__link">
      Boolean values
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/string/" title="String" class="md-nav__link">
      String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/fixedstring/" title="FixedString(N)" class="md-nav__link">
      FixedString(N)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/date/" title="Date" class="md-nav__link">
      Date
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/datetime/" title="DateTime" class="md-nav__link">
      DateTime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/enum/" title="Enum" class="md-nav__link">
      Enum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/array/" title="Array(T)" class="md-nav__link">
      Array(T)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/nested_data_structures/aggregatefunction/" title="AggregateFunction(name, types_of_arguments...)" class="md-nav__link">
      AggregateFunction(name, types_of_arguments...)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/tuple/" title="Tuple(T1, T2, ...)" class="md-nav__link">
      Tuple(T1, T2, ...)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10-13" type="checkbox" id="nav-10-13">
    
    <label class="md-nav__link" for="nav-10-13">
      Nested data structures
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-10-13">
        Nested data structures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/nested_data_structures/nested/" title="Nested(Name1 Type1, Name2 Type2, ...)" class="md-nav__link">
      Nested(Name1 Type1, Name2 Type2, ...)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10-14" type="checkbox" id="nav-10-14">
    
    <label class="md-nav__link" for="nav-10-14">
      Special data types
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-10-14">
        Special data types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/special_data_types/expression/" title="Expression" class="md-nav__link">
      Expression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../data_types/special_data_types/set/" title="Set" class="md-nav__link">
      Set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../operators/" title="Operators" class="md-nav__link">
      Operators
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Functions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Functions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/arithmetic_functions/" title="Arithmetic functions" class="md-nav__link">
      Arithmetic functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/comparison_functions/" title="Comparison functions" class="md-nav__link">
      Comparison functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/logical_functions/" title="Logical functions" class="md-nav__link">
      Logical functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/type_conversion_functions/" title="Type conversion functions" class="md-nav__link">
      Type conversion functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/date_time_functions/" title="Functions for working with dates and times" class="md-nav__link">
      Functions for working with dates and times
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/string_functions/" title="Functions for working with strings" class="md-nav__link">
      Functions for working with strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/string_search_functions/" title="Functions for searching strings" class="md-nav__link">
      Functions for searching strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/string_replace_functions/" title="Functions for searching and replacing in strings" class="md-nav__link">
      Functions for searching and replacing in strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/conditional_functions/" title="Conditional functions" class="md-nav__link">
      Conditional functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/math_functions/" title="Mathematical functions" class="md-nav__link">
      Mathematical functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/rounding_functions/" title="Rounding functions" class="md-nav__link">
      Rounding functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/array_functions/" title="Functions for working with arrays" class="md-nav__link">
      Functions for working with arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/splitting_merging_functions/" title="Functions for splitting and merging strings and arrays" class="md-nav__link">
      Functions for splitting and merging strings and arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/bit_functions/" title="Bit functions" class="md-nav__link">
      Bit functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/hash_functions/" title="Hash functions" class="md-nav__link">
      Hash functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/random_functions/" title="Functions for generating pseudo-random numbers" class="md-nav__link">
      Functions for generating pseudo-random numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/encoding_functions/" title="Encoding functions" class="md-nav__link">
      Encoding functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/url_functions/" title="Functions for working with URLs" class="md-nav__link">
      Functions for working with URLs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/ip_address_functions/" title="Functions for working with IP addresses" class="md-nav__link">
      Functions for working with IP addresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/json_functions/" title="Functions for working with JSON." class="md-nav__link">
      Functions for working with JSON.
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/higher_order_functions/" title="Higher-order functions" class="md-nav__link">
      Higher-order functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/other_functions/" title="Other functions" class="md-nav__link">
      Other functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/ext_dict_functions/" title="Functions for working with external dictionaries" class="md-nav__link">
      Functions for working with external dictionaries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/ym_dict_functions/" title="Functions for working with Yandex.Metrica dictionaries" class="md-nav__link">
      Functions for working with Yandex.Metrica dictionaries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/in_functions/" title="Functions for implementing the IN operator" class="md-nav__link">
      Functions for implementing the IN operator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../functions/array_join/" title="arrayJoin function" class="md-nav__link">
      arrayJoin function
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Aggregate functions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Aggregate functions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../agg_functions/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../agg_functions/reference/" title="Function reference" class="md-nav__link">
      Function reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../agg_functions/combinators/" title="Aggregate function combinators" class="md-nav__link">
      Aggregate function combinators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../agg_functions/parametric_functions/" title="Parametric aggregate functions" class="md-nav__link">
      Parametric aggregate functions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Dictionaries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        Dictionaries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14-2" type="checkbox" id="nav-14-2">
    
    <label class="md-nav__link" for="nav-14-2">
      External dictionaries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-14-2">
        External dictionaries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/external_dicts/" title="General desription" class="md-nav__link">
      General desription
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/external_dicts_dict/" title="Configuring an external dictionary" class="md-nav__link">
      Configuring an external dictionary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/external_dicts_dict_layout/" title="Storing dictionaries in memory" class="md-nav__link">
      Storing dictionaries in memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/external_dicts_dict_lifetime/" title="Dictionary updates" class="md-nav__link">
      Dictionary updates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/external_dicts_dict_sources/" title="Sources of external dictionaries" class="md-nav__link">
      Sources of external dictionaries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/external_dicts_dict_structure/" title="Dictionary key and fields" class="md-nav__link">
      Dictionary key and fields
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dicts/internal_dicts/" title="Internal dictionaries" class="md-nav__link">
      Internal dictionaries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      Operation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        Operation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/access_rights/" title="Access rights" class="md-nav__link">
      Access rights
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/configuration_files/" title="Configuration files" class="md-nav__link">
      Configuration files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/quotas/" title="Quotas" class="md-nav__link">
      Quotas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/tips/" title="Usage recommendations" class="md-nav__link">
      Usage recommendations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15-5" type="checkbox" id="nav-15-5">
    
    <label class="md-nav__link" for="nav-15-5">
      Server configuration parameters
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-15-5">
        Server configuration parameters
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/server_settings/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/server_settings/settings/" title="Server settings" class="md-nav__link">
      Server settings
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15-6" type="checkbox" id="nav-15-6">
    
    <label class="md-nav__link" for="nav-15-6">
      Settings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-15-6">
        Settings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/settings/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/settings/query_complexity/" title="Restrictions on query complexity" class="md-nav__link">
      Restrictions on query complexity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/settings/settings/" title="Settings" class="md-nav__link">
      Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../operations/settings/settings_profiles/" title="Settings profiles" class="md-nav__link">
      Settings profiles
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-16" type="checkbox" id="nav-16">
    
    <label class="md-nav__link" for="nav-16">
      Utilites
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-16">
        Utilites
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../utils/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../utils/clickhouse-copier/" title="clickhouse-copier" class="md-nav__link">
      clickhouse-copier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../utils/clickhouse-local/" title="clickhouse-local" class="md-nav__link">
      clickhouse-local
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      ClickHouse Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        ClickHouse Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/architecture/" title="Overview of ClickHouse architecture" class="md-nav__link">
      Overview of ClickHouse architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/build/" title="How to build ClickHouse on Linux" class="md-nav__link">
      How to build ClickHouse on Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/build_osx/" title="How to build ClickHouse on Mac OS X" class="md-nav__link">
      How to build ClickHouse on Mac OS X
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/style/" title="How to write  C++ code" class="md-nav__link">
      How to write  C++ code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/tests/" title="How to run ClickHouse tests" class="md-nav__link">
      How to run ClickHouse tests
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

    
  </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-import-the-raw-data" title="How to import the raw data" class="md-nav__link">
    How to import the raw data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results-on-single-server" title="Results on single server" class="md-nav__link">
    Results on single server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  
                    <a href="https://github.com/yandex/ClickHouse/edit/master/docs/en/getting_started/example_datasets/nyc_taxi.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                  
                
                
                <h1 id="new-york-taxi-data">New York Taxi data</h1>
<h2 id="how-to-import-the-raw-data">How to import the raw data</h2>
<p>See <a href="https://github.com/toddwschneider/nyc-taxi-data">https://github.com/toddwschneider/nyc-taxi-data</a> and <a href="http://tech.marksblogg.com/billion-nyc-taxi-rides-redshift.html">http://tech.marksblogg.com/billion-nyc-taxi-rides-redshift.html</a> for the description of the dataset and instructions for downloading.</p>
<p>Downloading will result in about 227 GB of uncompressed data in CSV files. The download takes about an hour over a 1 Gbit connection (parallel downloading from s3.amazonaws.com recovers at least half of a 1 Gbit channel).
Some of the files might not download fully. Check the file sizes and re-download any that seem doubtful.</p>
<p>Some of the files might contain invalid rows. You can fix them as follows:</p>
<div class="codehilite"><pre><span></span>sed -E <span class="s1">&#39;/(.*,){18,}/d&#39;</span> data/yellow_tripdata_2010-02.csv &gt; data/yellow_tripdata_2010-02.csv_
sed -E <span class="s1">&#39;/(.*,){18,}/d&#39;</span> data/yellow_tripdata_2010-03.csv &gt; data/yellow_tripdata_2010-03.csv_
mv data/yellow_tripdata_2010-02.csv_ data/yellow_tripdata_2010-02.csv
mv data/yellow_tripdata_2010-03.csv_ data/yellow_tripdata_2010-03.csv
</pre></div>


<p>Then the data must be pre-processed in PostgreSQL. This will create selections of points in the polygons (to match points on the map with the boroughs of New York City) and combine all the data into a single denormalized flat table by using a JOIN. To do this, you will need to install PostgreSQL with PostGIS support.</p>
<p>Be careful when running <code>initialize_database.sh</code> and manually re-check that all the tables were created correctly.</p>
<p>It takes about 20-30 minutes to process each month's worth of data in PostgreSQL, for a total of about 48 hours.</p>
<p>You can check the number of downloaded rows as follows:</p>
<div class="codehilite"><pre><span></span>time psql nyc-taxi-data -c &quot;SELECT count(*) FROM trips;&quot;
##    count
 1298979494
(1 row)

real    7m9.164s
</pre></div>


<p>(This is slightly more than 1.1 billion rows reported by Mark Litwintschik in a series of blog posts.)</p>
<p>The data in PostgreSQL uses 370 GB of space.</p>
<p>Exporting the data from PostgreSQL:</p>
<div class="codehilite"><pre><span></span><span class="k">COPY</span>
<span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">trips</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">vendor_id</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">pickup_datetime</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">dropoff_datetime</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">store_and_fwd_flag</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">rate_code_id</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">pickup_longitude</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">pickup_latitude</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">dropoff_longitude</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">dropoff_latitude</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">passenger_count</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">trip_distance</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">fare_amount</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">extra</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">mta_tax</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">tip_amount</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">tolls_amount</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">ehail_fee</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">improvement_surcharge</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">total_amount</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">payment_type</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">trip_type</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">pickup</span><span class="p">,</span>
           <span class="n">trips</span><span class="p">.</span><span class="n">dropoff</span><span class="p">,</span>

           <span class="n">cab_types</span><span class="p">.</span><span class="k">type</span> <span class="n">cab_type</span><span class="p">,</span>

           <span class="n">weather</span><span class="p">.</span><span class="n">precipitation_tenths_of_mm</span> <span class="n">rain</span><span class="p">,</span>
           <span class="n">weather</span><span class="p">.</span><span class="n">snow_depth_mm</span><span class="p">,</span>
           <span class="n">weather</span><span class="p">.</span><span class="n">snowfall_mm</span><span class="p">,</span>
           <span class="n">weather</span><span class="p">.</span><span class="n">max_temperature_tenths_degrees_celsius</span> <span class="n">max_temp</span><span class="p">,</span>
           <span class="n">weather</span><span class="p">.</span><span class="n">min_temperature_tenths_degrees_celsius</span> <span class="n">min_temp</span><span class="p">,</span>
           <span class="n">weather</span><span class="p">.</span><span class="n">average_wind_speed_tenths_of_meters_per_second</span> <span class="n">wind</span><span class="p">,</span>

           <span class="n">pick_up</span><span class="p">.</span><span class="n">gid</span> <span class="n">pickup_nyct2010_gid</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">ctlabel</span> <span class="n">pickup_ctlabel</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">borocode</span> <span class="n">pickup_borocode</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">boroname</span> <span class="n">pickup_boroname</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">ct2010</span> <span class="n">pickup_ct2010</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">boroct2010</span> <span class="n">pickup_boroct2010</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">cdeligibil</span> <span class="n">pickup_cdeligibil</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">ntacode</span> <span class="n">pickup_ntacode</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">ntaname</span> <span class="n">pickup_ntaname</span><span class="p">,</span>
           <span class="n">pick_up</span><span class="p">.</span><span class="n">puma</span> <span class="n">pickup_puma</span><span class="p">,</span>

           <span class="n">drop_off</span><span class="p">.</span><span class="n">gid</span> <span class="n">dropoff_nyct2010_gid</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">ctlabel</span> <span class="n">dropoff_ctlabel</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">borocode</span> <span class="n">dropoff_borocode</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">boroname</span> <span class="n">dropoff_boroname</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">ct2010</span> <span class="n">dropoff_ct2010</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">boroct2010</span> <span class="n">dropoff_boroct2010</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">cdeligibil</span> <span class="n">dropoff_cdeligibil</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">ntacode</span> <span class="n">dropoff_ntacode</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">ntaname</span> <span class="n">dropoff_ntaname</span><span class="p">,</span>
           <span class="n">drop_off</span><span class="p">.</span><span class="n">puma</span> <span class="n">dropoff_puma</span>
    <span class="k">FROM</span> <span class="n">trips</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">cab_types</span>
        <span class="k">ON</span> <span class="n">trips</span><span class="p">.</span><span class="n">cab_type_id</span> <span class="o">=</span> <span class="n">cab_types</span><span class="p">.</span><span class="n">id</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">central_park_weather_observations_raw</span> <span class="n">weather</span>
        <span class="k">ON</span> <span class="n">weather</span><span class="p">.</span><span class="nb">date</span> <span class="o">=</span> <span class="n">trips</span><span class="p">.</span><span class="n">pickup_datetime</span><span class="p">::</span><span class="nb">date</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">nyct2010</span> <span class="n">pick_up</span>
        <span class="k">ON</span> <span class="n">pick_up</span><span class="p">.</span><span class="n">gid</span> <span class="o">=</span> <span class="n">trips</span><span class="p">.</span><span class="n">pickup_nyct2010_gid</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">nyct2010</span> <span class="n">drop_off</span>
        <span class="k">ON</span> <span class="n">drop_off</span><span class="p">.</span><span class="n">gid</span> <span class="o">=</span> <span class="n">trips</span><span class="p">.</span><span class="n">dropoff_nyct2010_gid</span>
<span class="p">)</span> <span class="k">TO</span> <span class="s1">&#39;/opt/milovidov/nyc-taxi-data/trips.tsv&#39;</span><span class="p">;</span>
</pre></div>


<p>The data snapshot is created at a speed of about 50 MB per second. While creating the snapshot, PostgreSQL reads from the disk at a speed of about 28 MB per second.
This takes about 5 hours. The resulting TSV file is 590612904969 bytes.</p>
<p>Create a temporary table in ClickHouse:</p>
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">trips</span>
<span class="p">(</span>
<span class="n">trip_id</span>                 <span class="n">UInt32</span><span class="p">,</span>
<span class="n">vendor_id</span>               <span class="n">String</span><span class="p">,</span>
<span class="n">pickup_datetime</span>         <span class="n">DateTime</span><span class="p">,</span>
<span class="n">dropoff_datetime</span>        <span class="k">Nullable</span><span class="p">(</span><span class="n">DateTime</span><span class="p">),</span>
<span class="n">store_and_fwd_flag</span>      <span class="k">Nullable</span><span class="p">(</span><span class="n">FixedString</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
<span class="n">rate_code_id</span>            <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">pickup_longitude</span>        <span class="k">Nullable</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span>
<span class="n">pickup_latitude</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span>
<span class="n">dropoff_longitude</span>       <span class="k">Nullable</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span>
<span class="n">dropoff_latitude</span>        <span class="k">Nullable</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span>
<span class="n">passenger_count</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">trip_distance</span>           <span class="k">Nullable</span><span class="p">(</span><span class="n">Float64</span><span class="p">),</span>
<span class="n">fare_amount</span>             <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">extra</span>                   <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">mta_tax</span>                 <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">tip_amount</span>              <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">tolls_amount</span>            <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">ehail_fee</span>               <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">improvement_surcharge</span>   <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">total_amount</span>            <span class="k">Nullable</span><span class="p">(</span><span class="n">Float32</span><span class="p">),</span>
<span class="n">payment_type</span>            <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">trip_type</span>               <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">pickup</span>                  <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff</span>                 <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">cab_type</span>                <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">precipitation</span>           <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">snow_depth</span>              <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">snowfall</span>                <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">max_temperature</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">min_temperature</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">average_wind_speed</span>      <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">pickup_nyct2010_gid</span>     <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">pickup_ctlabel</span>          <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">pickup_borocode</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">pickup_boroname</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">pickup_ct2010</span>           <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">pickup_boroct2010</span>       <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">pickup_cdeligibil</span>       <span class="k">Nullable</span><span class="p">(</span><span class="n">FixedString</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
<span class="n">pickup_ntacode</span>          <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">pickup_ntaname</span>          <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">pickup_puma</span>             <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_nyct2010_gid</span>    <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">dropoff_ctlabel</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_borocode</span>        <span class="k">Nullable</span><span class="p">(</span><span class="n">UInt8</span><span class="p">),</span>
<span class="n">dropoff_boroname</span>        <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_ct2010</span>          <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_boroct2010</span>      <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_cdeligibil</span>      <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_ntacode</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_ntaname</span>         <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">),</span>
<span class="n">dropoff_puma</span>            <span class="k">Nullable</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Log</span><span class="p">;</span>
</pre></div>


<p>It is needed for converting fields to more correct data types and, if possible, to eliminate NULLs.</p>
<div class="codehilite"><pre><span></span>time clickhouse-client --query=&quot;INSERT INTO trips FORMAT TabSeparated&quot; &lt; trips.tsv

real    75m56.214s
</pre></div>


<p>Data is read at a speed of 112-140 Mb/second.
Loading data into a Log type table in one stream took 76 minutes.
The data in this table uses 142 GB.</p>
<p>(Importing data directly from Postgres is also possible using <code>COPY ... TO PROGRAM</code>.)</p>
<p>Unfortunately, all the fields associated with the weather (precipitation...average_wind_speed) were filled with NULL. Because of this, we will remove them from the final data set.</p>
<p>To start, we'll create a table on a single server. Later we will make the table distributed.</p>
<p>Create and populate a summary table:</p>
<div class="codehilite"><pre><span></span>CREATE TABLE trips_mergetree
ENGINE = MergeTree(pickup_date, pickup_datetime, 8192)
AS SELECT

trip_id,
CAST(vendor_id AS Enum8(&#39;1&#39; = 1, &#39;2&#39; = 2, &#39;CMT&#39; = 3, &#39;VTS&#39; = 4, &#39;DDS&#39; = 5, &#39;B02512&#39; = 10, &#39;B02598&#39; = 11, &#39;B02617&#39; = 12, &#39;B02682&#39; = 13, &#39;B02764&#39; = 14)) AS vendor_id,
toDate(pickup_datetime) AS pickup_date,
ifNull(pickup_datetime, toDateTime(0)) AS pickup_datetime,
toDate(dropoff_datetime) AS dropoff_date,
ifNull(dropoff_datetime, toDateTime(0)) AS dropoff_datetime,
assumeNotNull(store_and_fwd_flag) IN (&#39;Y&#39;, &#39;1&#39;, &#39;2&#39;) AS store_and_fwd_flag,
assumeNotNull(rate_code_id) AS rate_code_id,
assumeNotNull(pickup_longitude) AS pickup_longitude,
assumeNotNull(pickup_latitude) AS pickup_latitude,
assumeNotNull(dropoff_longitude) AS dropoff_longitude,
assumeNotNull(dropoff_latitude) AS dropoff_latitude,
assumeNotNull(passenger_count) AS passenger_count,
assumeNotNull(trip_distance) AS trip_distance,
assumeNotNull(fare_amount) AS fare_amount,
assumeNotNull(extra) AS extra,
assumeNotNull(mta_tax) AS mta_tax,
assumeNotNull(tip_amount) AS tip_amount,
assumeNotNull(tolls_amount) AS tolls_amount,
assumeNotNull(ehail_fee) AS ehail_fee,
assumeNotNull(improvement_surcharge) AS improvement_surcharge,
assumeNotNull(total_amount) AS total_amount,
CAST((assumeNotNull(payment_type) AS pt) IN (&#39;CSH&#39;, &#39;CASH&#39;, &#39;Cash&#39;, &#39;CAS&#39;, &#39;Cas&#39;, &#39;1&#39;) ? &#39;CSH&#39; : (pt IN (&#39;CRD&#39;, &#39;Credit&#39;, &#39;Cre&#39;, &#39;CRE&#39;, &#39;CREDIT&#39;, &#39;2&#39;) ? &#39;CRE&#39; : (pt IN (&#39;NOC&#39;, &#39;No Charge&#39;, &#39;No&#39;, &#39;3&#39;) ? &#39;NOC&#39; : (pt IN (&#39;DIS&#39;, &#39;Dispute&#39;, &#39;Dis&#39;, &#39;4&#39;) ? &#39;DIS&#39; : &#39;UNK&#39;))) AS Enum8(&#39;CSH&#39; = 1, &#39;CRE&#39; = 2, &#39;UNK&#39; = 0, &#39;NOC&#39; = 3, &#39;DIS&#39; = 4)) AS payment_type_,
assumeNotNull(trip_type) AS trip_type,
ifNull(toFixedString(unhex(pickup), 25), toFixedString(&#39;&#39;, 25)) AS pickup,
ifNull(toFixedString(unhex(dropoff), 25), toFixedString(&#39;&#39;, 25)) AS dropoff,
CAST(assumeNotNull(cab_type) AS Enum8(&#39;yellow&#39; = 1, &#39;green&#39; = 2, &#39;uber&#39; = 3)) AS cab_type,

assumeNotNull(pickup_nyct2010_gid) AS pickup_nyct2010_gid,
toFloat32(ifNull(pickup_ctlabel, &#39;0&#39;)) AS pickup_ctlabel,
assumeNotNull(pickup_borocode) AS pickup_borocode,
CAST(assumeNotNull(pickup_boroname) AS Enum8(&#39;Manhattan&#39; = 1, &#39;Queens&#39; = 4, &#39;Brooklyn&#39; = 3, &#39;&#39; = 0, &#39;Bronx&#39; = 2, &#39;Staten Island&#39; = 5)) AS pickup_boroname,
toFixedString(ifNull(pickup_ct2010, &#39;000000&#39;), 6) AS pickup_ct2010,
toFixedString(ifNull(pickup_boroct2010, &#39;0000000&#39;), 7) AS pickup_boroct2010,
CAST(assumeNotNull(ifNull(pickup_cdeligibil, &#39; &#39;)) AS Enum8(&#39; &#39; = 0, &#39;E&#39; = 1, &#39;I&#39; = 2)) AS pickup_cdeligibil,
toFixedString(ifNull(pickup_ntacode, &#39;0000&#39;), 4) AS pickup_ntacode,

CAST(assumeNotNull(pickup_ntaname) AS Enum16(&#39;&#39; = 0, &#39;Airport&#39; = 1, &#39;Allerton-Pelham Gardens&#39; = 2, &#39;Annadale-Huguenot-Prince\&#39;s Bay-Eltingville&#39; = 3, &#39;Arden Heights&#39; = 4, &#39;Astoria&#39; = 5, &#39;Auburndale&#39; = 6, &#39;Baisley Park&#39; = 7, &#39;Bath Beach&#39; = 8, &#39;Battery Park City-Lower Manhattan&#39; = 9, &#39;Bay Ridge&#39; = 10, &#39;Bayside-Bayside Hills&#39; = 11, &#39;Bedford&#39; = 12, &#39;Bedford Park-Fordham North&#39; = 13, &#39;Bellerose&#39; = 14, &#39;Belmont&#39; = 15, &#39;Bensonhurst East&#39; = 16, &#39;Bensonhurst West&#39; = 17, &#39;Borough Park&#39; = 18, &#39;Breezy Point-Belle Harbor-Rockaway Park-Broad Channel&#39; = 19, &#39;Briarwood-Jamaica Hills&#39; = 20, &#39;Brighton Beach&#39; = 21, &#39;Bronxdale&#39; = 22, &#39;Brooklyn Heights-Cobble Hill&#39; = 23, &#39;Brownsville&#39; = 24, &#39;Bushwick North&#39; = 25, &#39;Bushwick South&#39; = 26, &#39;Cambria Heights&#39; = 27, &#39;Canarsie&#39; = 28, &#39;Carroll Gardens-Columbia Street-Red Hook&#39; = 29, &#39;Central Harlem North-Polo Grounds&#39; = 30, &#39;Central Harlem South&#39; = 31, &#39;Charleston-Richmond Valley-Tottenville&#39; = 32, &#39;Chinatown&#39; = 33, &#39;Claremont-Bathgate&#39; = 34, &#39;Clinton&#39; = 35, &#39;Clinton Hill&#39; = 36, &#39;Co-op City&#39; = 37, &#39;College Point&#39; = 38, &#39;Corona&#39; = 39, &#39;Crotona Park East&#39; = 40, &#39;Crown Heights North&#39; = 41, &#39;Crown Heights South&#39; = 42, &#39;Cypress Hills-City Line&#39; = 43, &#39;DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum Hill&#39; = 44, &#39;Douglas Manor-Douglaston-Little Neck&#39; = 45, &#39;Dyker Heights&#39; = 46, &#39;East Concourse-Concourse Village&#39; = 47, &#39;East Elmhurst&#39; = 48, &#39;East Flatbush-Farragut&#39; = 49, &#39;East Flushing&#39; = 50, &#39;East Harlem North&#39; = 51, &#39;East Harlem South&#39; = 52, &#39;East New York&#39; = 53, &#39;East New York (Pennsylvania Ave)&#39; = 54, &#39;East Tremont&#39; = 55, &#39;East Village&#39; = 56, &#39;East Williamsburg&#39; = 57, &#39;Eastchester-Edenwald-Baychester&#39; = 58, &#39;Elmhurst&#39; = 59, &#39;Elmhurst-Maspeth&#39; = 60, &#39;Erasmus&#39; = 61, &#39;Far Rockaway-Bayswater&#39; = 62, &#39;Flatbush&#39; = 63, &#39;Flatlands&#39; = 64, &#39;Flushing&#39; = 65, &#39;Fordham South&#39; = 66, &#39;Forest Hills&#39; = 67, &#39;Fort Greene&#39; = 68, &#39;Fresh Meadows-Utopia&#39; = 69, &#39;Ft. Totten-Bay Terrace-Clearview&#39; = 70, &#39;Georgetown-Marine Park-Bergen Beach-Mill Basin&#39; = 71, &#39;Glen Oaks-Floral Park-New Hyde Park&#39; = 72, &#39;Glendale&#39; = 73, &#39;Gramercy&#39; = 74, &#39;Grasmere-Arrochar-Ft. Wadsworth&#39; = 75, &#39;Gravesend&#39; = 76, &#39;Great Kills&#39; = 77, &#39;Greenpoint&#39; = 78, &#39;Grymes Hill-Clifton-Fox Hills&#39; = 79, &#39;Hamilton Heights&#39; = 80, &#39;Hammels-Arverne-Edgemere&#39; = 81, &#39;Highbridge&#39; = 82, &#39;Hollis&#39; = 83, &#39;Homecrest&#39; = 84, &#39;Hudson Yards-Chelsea-Flatiron-Union Square&#39; = 85, &#39;Hunters Point-Sunnyside-West Maspeth&#39; = 86, &#39;Hunts Point&#39; = 87, &#39;Jackson Heights&#39; = 88, &#39;Jamaica&#39; = 89, &#39;Jamaica Estates-Holliswood&#39; = 90, &#39;Kensington-Ocean Parkway&#39; = 91, &#39;Kew Gardens&#39; = 92, &#39;Kew Gardens Hills&#39; = 93, &#39;Kingsbridge Heights&#39; = 94, &#39;Laurelton&#39; = 95, &#39;Lenox Hill-Roosevelt Island&#39; = 96, &#39;Lincoln Square&#39; = 97, &#39;Lindenwood-Howard Beach&#39; = 98, &#39;Longwood&#39; = 99, &#39;Lower East Side&#39; = 100, &#39;Madison&#39; = 101, &#39;Manhattanville&#39; = 102, &#39;Marble Hill-Inwood&#39; = 103, &#39;Mariner\&#39;s Harbor-Arlington-Port Ivory-Graniteville&#39; = 104, &#39;Maspeth&#39; = 105, &#39;Melrose South-Mott Haven North&#39; = 106, &#39;Middle Village&#39; = 107, &#39;Midtown-Midtown South&#39; = 108, &#39;Midwood&#39; = 109, &#39;Morningside Heights&#39; = 110, &#39;Morrisania-Melrose&#39; = 111, &#39;Mott Haven-Port Morris&#39; = 112, &#39;Mount Hope&#39; = 113, &#39;Murray Hill&#39; = 114, &#39;Murray Hill-Kips Bay&#39; = 115, &#39;New Brighton-Silver Lake&#39; = 116, &#39;New Dorp-Midland Beach&#39; = 117, &#39;New Springville-Bloomfield-Travis&#39; = 118, &#39;North Corona&#39; = 119, &#39;North Riverdale-Fieldston-Riverdale&#39; = 120, &#39;North Side-South Side&#39; = 121, &#39;Norwood&#39; = 122, &#39;Oakland Gardens&#39; = 123, &#39;Oakwood-Oakwood Beach&#39; = 124, &#39;Ocean Hill&#39; = 125, &#39;Ocean Parkway South&#39; = 126, &#39;Old Astoria&#39; = 127, &#39;Old Town-Dongan Hills-South Beach&#39; = 128, &#39;Ozone Park&#39; = 129, &#39;Park Slope-Gowanus&#39; = 130, &#39;Parkchester&#39; = 131, &#39;Pelham Bay-Country Club-City Island&#39; = 132, &#39;Pelham Parkway&#39; = 133, &#39;Pomonok-Flushing Heights-Hillcrest&#39; = 134, &#39;Port Richmond&#39; = 135, &#39;Prospect Heights&#39; = 136, &#39;Prospect Lefferts Gardens-Wingate&#39; = 137, &#39;Queens Village&#39; = 138, &#39;Queensboro Hill&#39; = 139, &#39;Queensbridge-Ravenswood-Long Island City&#39; = 140, &#39;Rego Park&#39; = 141, &#39;Richmond Hill&#39; = 142, &#39;Ridgewood&#39; = 143, &#39;Rikers Island&#39; = 144, &#39;Rosedale&#39; = 145, &#39;Rossville-Woodrow&#39; = 146, &#39;Rugby-Remsen Village&#39; = 147, &#39;Schuylerville-Throgs Neck-Edgewater Park&#39; = 148, &#39;Seagate-Coney Island&#39; = 149, &#39;Sheepshead Bay-Gerritsen Beach-Manhattan Beach&#39; = 150, &#39;SoHo-TriBeCa-Civic Center-Little Italy&#39; = 151, &#39;Soundview-Bruckner&#39; = 152, &#39;Soundview-Castle Hill-Clason Point-Harding Park&#39; = 153, &#39;South Jamaica&#39; = 154, &#39;South Ozone Park&#39; = 155, &#39;Springfield Gardens North&#39; = 156, &#39;Springfield Gardens South-Brookville&#39; = 157, &#39;Spuyten Duyvil-Kingsbridge&#39; = 158, &#39;St. Albans&#39; = 159, &#39;Stapleton-Rosebank&#39; = 160, &#39;Starrett City&#39; = 161, &#39;Steinway&#39; = 162, &#39;Stuyvesant Heights&#39; = 163, &#39;Stuyvesant Town-Cooper Village&#39; = 164, &#39;Sunset Park East&#39; = 165, &#39;Sunset Park West&#39; = 166, &#39;Todt Hill-Emerson Hill-Heartland Village-Lighthouse Hill&#39; = 167, &#39;Turtle Bay-East Midtown&#39; = 168, &#39;University Heights-Morris Heights&#39; = 169, &#39;Upper East Side-Carnegie Hill&#39; = 170, &#39;Upper West Side&#39; = 171, &#39;Van Cortlandt Village&#39; = 172, &#39;Van Nest-Morris Park-Westchester Square&#39; = 173, &#39;Washington Heights North&#39; = 174, &#39;Washington Heights South&#39; = 175, &#39;West Brighton&#39; = 176, &#39;West Concourse&#39; = 177, &#39;West Farms-Bronx River&#39; = 178, &#39;West New Brighton-New Brighton-St. George&#39; = 179, &#39;West Village&#39; = 180, &#39;Westchester-Unionport&#39; = 181, &#39;Westerleigh&#39; = 182, &#39;Whitestone&#39; = 183, &#39;Williamsbridge-Olinville&#39; = 184, &#39;Williamsburg&#39; = 185, &#39;Windsor Terrace&#39; = 186, &#39;Woodhaven&#39; = 187, &#39;Woodlawn-Wakefield&#39; = 188, &#39;Woodside&#39; = 189, &#39;Yorkville&#39; = 190, &#39;park-cemetery-etc-Bronx&#39; = 191, &#39;park-cemetery-etc-Brooklyn&#39; = 192, &#39;park-cemetery-etc-Manhattan&#39; = 193, &#39;park-cemetery-etc-Queens&#39; = 194, &#39;park-cemetery-etc-Staten Island&#39; = 195)) AS pickup_ntaname,

toUInt16(ifNull(pickup_puma, &#39;0&#39;)) AS pickup_puma,

assumeNotNull(dropoff_nyct2010_gid) AS dropoff_nyct2010_gid,
toFloat32(ifNull(dropoff_ctlabel, &#39;0&#39;)) AS dropoff_ctlabel,
assumeNotNull(dropoff_borocode) AS dropoff_borocode,
CAST(assumeNotNull(dropoff_boroname) AS Enum8(&#39;Manhattan&#39; = 1, &#39;Queens&#39; = 4, &#39;Brooklyn&#39; = 3, &#39;&#39; = 0, &#39;Bronx&#39; = 2, &#39;Staten Island&#39; = 5)) AS dropoff_boroname,
toFixedString(ifNull(dropoff_ct2010, &#39;000000&#39;), 6) AS dropoff_ct2010,
toFixedString(ifNull(dropoff_boroct2010, &#39;0000000&#39;), 7) AS dropoff_boroct2010,
CAST(assumeNotNull(ifNull(dropoff_cdeligibil, &#39; &#39;)) AS Enum8(&#39; &#39; = 0, &#39;E&#39; = 1, &#39;I&#39; = 2)) AS dropoff_cdeligibil,
toFixedString(ifNull(dropoff_ntacode, &#39;0000&#39;), 4) AS dropoff_ntacode,

CAST(assumeNotNull(dropoff_ntaname) AS Enum16(&#39;&#39; = 0, &#39;Airport&#39; = 1, &#39;Allerton-Pelham Gardens&#39; = 2, &#39;Annadale-Huguenot-Prince\&#39;s Bay-Eltingville&#39; = 3, &#39;Arden Heights&#39; = 4, &#39;Astoria&#39; = 5, &#39;Auburndale&#39; = 6, &#39;Baisley Park&#39; = 7, &#39;Bath Beach&#39; = 8, &#39;Battery Park City-Lower Manhattan&#39; = 9, &#39;Bay Ridge&#39; = 10, &#39;Bayside-Bayside Hills&#39; = 11, &#39;Bedford&#39; = 12, &#39;Bedford Park-Fordham North&#39; = 13, &#39;Bellerose&#39; = 14, &#39;Belmont&#39; = 15, &#39;Bensonhurst East&#39; = 16, &#39;Bensonhurst West&#39; = 17, &#39;Borough Park&#39; = 18, &#39;Breezy Point-Belle Harbor-Rockaway Park-Broad Channel&#39; = 19, &#39;Briarwood-Jamaica Hills&#39; = 20, &#39;Brighton Beach&#39; = 21, &#39;Bronxdale&#39; = 22, &#39;Brooklyn Heights-Cobble Hill&#39; = 23, &#39;Brownsville&#39; = 24, &#39;Bushwick North&#39; = 25, &#39;Bushwick South&#39; = 26, &#39;Cambria Heights&#39; = 27, &#39;Canarsie&#39; = 28, &#39;Carroll Gardens-Columbia Street-Red Hook&#39; = 29, &#39;Central Harlem North-Polo Grounds&#39; = 30, &#39;Central Harlem South&#39; = 31, &#39;Charleston-Richmond Valley-Tottenville&#39; = 32, &#39;Chinatown&#39; = 33, &#39;Claremont-Bathgate&#39; = 34, &#39;Clinton&#39; = 35, &#39;Clinton Hill&#39; = 36, &#39;Co-op City&#39; = 37, &#39;College Point&#39; = 38, &#39;Corona&#39; = 39, &#39;Crotona Park East&#39; = 40, &#39;Crown Heights North&#39; = 41, &#39;Crown Heights South&#39; = 42, &#39;Cypress Hills-City Line&#39; = 43, &#39;DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum Hill&#39; = 44, &#39;Douglas Manor-Douglaston-Little Neck&#39; = 45, &#39;Dyker Heights&#39; = 46, &#39;East Concourse-Concourse Village&#39; = 47, &#39;East Elmhurst&#39; = 48, &#39;East Flatbush-Farragut&#39; = 49, &#39;East Flushing&#39; = 50, &#39;East Harlem North&#39; = 51, &#39;East Harlem South&#39; = 52, &#39;East New York&#39; = 53, &#39;East New York (Pennsylvania Ave)&#39; = 54, &#39;East Tremont&#39; = 55, &#39;East Village&#39; = 56, &#39;East Williamsburg&#39; = 57, &#39;Eastchester-Edenwald-Baychester&#39; = 58, &#39;Elmhurst&#39; = 59, &#39;Elmhurst-Maspeth&#39; = 60, &#39;Erasmus&#39; = 61, &#39;Far Rockaway-Bayswater&#39; = 62, &#39;Flatbush&#39; = 63, &#39;Flatlands&#39; = 64, &#39;Flushing&#39; = 65, &#39;Fordham South&#39; = 66, &#39;Forest Hills&#39; = 67, &#39;Fort Greene&#39; = 68, &#39;Fresh Meadows-Utopia&#39; = 69, &#39;Ft. Totten-Bay Terrace-Clearview&#39; = 70, &#39;Georgetown-Marine Park-Bergen Beach-Mill Basin&#39; = 71, &#39;Glen Oaks-Floral Park-New Hyde Park&#39; = 72, &#39;Glendale&#39; = 73, &#39;Gramercy&#39; = 74, &#39;Grasmere-Arrochar-Ft. Wadsworth&#39; = 75, &#39;Gravesend&#39; = 76, &#39;Great Kills&#39; = 77, &#39;Greenpoint&#39; = 78, &#39;Grymes Hill-Clifton-Fox Hills&#39; = 79, &#39;Hamilton Heights&#39; = 80, &#39;Hammels-Arverne-Edgemere&#39; = 81, &#39;Highbridge&#39; = 82, &#39;Hollis&#39; = 83, &#39;Homecrest&#39; = 84, &#39;Hudson Yards-Chelsea-Flatiron-Union Square&#39; = 85, &#39;Hunters Point-Sunnyside-West Maspeth&#39; = 86, &#39;Hunts Point&#39; = 87, &#39;Jackson Heights&#39; = 88, &#39;Jamaica&#39; = 89, &#39;Jamaica Estates-Holliswood&#39; = 90, &#39;Kensington-Ocean Parkway&#39; = 91, &#39;Kew Gardens&#39; = 92, &#39;Kew Gardens Hills&#39; = 93, &#39;Kingsbridge Heights&#39; = 94, &#39;Laurelton&#39; = 95, &#39;Lenox Hill-Roosevelt Island&#39; = 96, &#39;Lincoln Square&#39; = 97, &#39;Lindenwood-Howard Beach&#39; = 98, &#39;Longwood&#39; = 99, &#39;Lower East Side&#39; = 100, &#39;Madison&#39; = 101, &#39;Manhattanville&#39; = 102, &#39;Marble Hill-Inwood&#39; = 103, &#39;Mariner\&#39;s Harbor-Arlington-Port Ivory-Graniteville&#39; = 104, &#39;Maspeth&#39; = 105, &#39;Melrose South-Mott Haven North&#39; = 106, &#39;Middle Village&#39; = 107, &#39;Midtown-Midtown South&#39; = 108, &#39;Midwood&#39; = 109, &#39;Morningside Heights&#39; = 110, &#39;Morrisania-Melrose&#39; = 111, &#39;Mott Haven-Port Morris&#39; = 112, &#39;Mount Hope&#39; = 113, &#39;Murray Hill&#39; = 114, &#39;Murray Hill-Kips Bay&#39; = 115, &#39;New Brighton-Silver Lake&#39; = 116, &#39;New Dorp-Midland Beach&#39; = 117, &#39;New Springville-Bloomfield-Travis&#39; = 118, &#39;North Corona&#39; = 119, &#39;North Riverdale-Fieldston-Riverdale&#39; = 120, &#39;North Side-South Side&#39; = 121, &#39;Norwood&#39; = 122, &#39;Oakland Gardens&#39; = 123, &#39;Oakwood-Oakwood Beach&#39; = 124, &#39;Ocean Hill&#39; = 125, &#39;Ocean Parkway South&#39; = 126, &#39;Old Astoria&#39; = 127, &#39;Old Town-Dongan Hills-South Beach&#39; = 128, &#39;Ozone Park&#39; = 129, &#39;Park Slope-Gowanus&#39; = 130, &#39;Parkchester&#39; = 131, &#39;Pelham Bay-Country Club-City Island&#39; = 132, &#39;Pelham Parkway&#39; = 133, &#39;Pomonok-Flushing Heights-Hillcrest&#39; = 134, &#39;Port Richmond&#39; = 135, &#39;Prospect Heights&#39; = 136, &#39;Prospect Lefferts Gardens-Wingate&#39; = 137, &#39;Queens Village&#39; = 138, &#39;Queensboro Hill&#39; = 139, &#39;Queensbridge-Ravenswood-Long Island City&#39; = 140, &#39;Rego Park&#39; = 141, &#39;Richmond Hill&#39; = 142, &#39;Ridgewood&#39; = 143, &#39;Rikers Island&#39; = 144, &#39;Rosedale&#39; = 145, &#39;Rossville-Woodrow&#39; = 146, &#39;Rugby-Remsen Village&#39; = 147, &#39;Schuylerville-Throgs Neck-Edgewater Park&#39; = 148, &#39;Seagate-Coney Island&#39; = 149, &#39;Sheepshead Bay-Gerritsen Beach-Manhattan Beach&#39; = 150, &#39;SoHo-TriBeCa-Civic Center-Little Italy&#39; = 151, &#39;Soundview-Bruckner&#39; = 152, &#39;Soundview-Castle Hill-Clason Point-Harding Park&#39; = 153, &#39;South Jamaica&#39; = 154, &#39;South Ozone Park&#39; = 155, &#39;Springfield Gardens North&#39; = 156, &#39;Springfield Gardens South-Brookville&#39; = 157, &#39;Spuyten Duyvil-Kingsbridge&#39; = 158, &#39;St. Albans&#39; = 159, &#39;Stapleton-Rosebank&#39; = 160, &#39;Starrett City&#39; = 161, &#39;Steinway&#39; = 162, &#39;Stuyvesant Heights&#39; = 163, &#39;Stuyvesant Town-Cooper Village&#39; = 164, &#39;Sunset Park East&#39; = 165, &#39;Sunset Park West&#39; = 166, &#39;Todt Hill-Emerson Hill-Heartland Village-Lighthouse Hill&#39; = 167, &#39;Turtle Bay-East Midtown&#39; = 168, &#39;University Heights-Morris Heights&#39; = 169, &#39;Upper East Side-Carnegie Hill&#39; = 170, &#39;Upper West Side&#39; = 171, &#39;Van Cortlandt Village&#39; = 172, &#39;Van Nest-Morris Park-Westchester Square&#39; = 173, &#39;Washington Heights North&#39; = 174, &#39;Washington Heights South&#39; = 175, &#39;West Brighton&#39; = 176, &#39;West Concourse&#39; = 177, &#39;West Farms-Bronx River&#39; = 178, &#39;West New Brighton-New Brighton-St. George&#39; = 179, &#39;West Village&#39; = 180, &#39;Westchester-Unionport&#39; = 181, &#39;Westerleigh&#39; = 182, &#39;Whitestone&#39; = 183, &#39;Williamsbridge-Olinville&#39; = 184, &#39;Williamsburg&#39; = 185, &#39;Windsor Terrace&#39; = 186, &#39;Woodhaven&#39; = 187, &#39;Woodlawn-Wakefield&#39; = 188, &#39;Woodside&#39; = 189, &#39;Yorkville&#39; = 190, &#39;park-cemetery-etc-Bronx&#39; = 191, &#39;park-cemetery-etc-Brooklyn&#39; = 192, &#39;park-cemetery-etc-Manhattan&#39; = 193, &#39;park-cemetery-etc-Queens&#39; = 194, &#39;park-cemetery-etc-Staten Island&#39; = 195)) AS dropoff_ntaname,

toUInt16(ifNull(dropoff_puma, &#39;0&#39;)) AS dropoff_puma

FROM trips
</pre></div>


<p>This takes 3030 seconds at a speed of about 428,000 rows per second.
To load it faster, you can create the table with the <code>Log</code> engine instead of <code>MergeTree</code>. In this case, the download works faster than 200 seconds.</p>
<p>The table uses 126 GB of disk space.</p>
<div class="codehilite"><pre><span></span>:) SELECT formatReadableSize(sum(bytes)) FROM system.parts WHERE table = &#39;trips_mergetree&#39; AND active

SELECT formatReadableSize(sum(bytes))
FROM system.parts
WHERE (table = &#39;trips_mergetree&#39;) AND active

┌─formatReadableSize(sum(bytes))─┐
│ 126.18 GiB                     │
└────────────────────────────────┘
</pre></div>


<p>Among other things, you can run the OPTIMIZE query on MergeTree. But it's not required, since everything will be fine without it.</p>
<h2 id="results-on-single-server">Results on single server</h2>
<p>Q1:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">cab_type</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">trips_mergetree</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">cab_type</span>
</pre></div>


<p>0.490 seconds.</p>
<p>Q2:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">passenger_count</span><span class="p">,</span> <span class="k">avg</span><span class="p">(</span><span class="n">total_amount</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">trips_mergetree</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">passenger_count</span>
</pre></div>


<p>1.224 seconds.</p>
<p>Q3:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">passenger_count</span><span class="p">,</span> <span class="n">toYear</span><span class="p">(</span><span class="n">pickup_date</span><span class="p">)</span> <span class="k">AS</span> <span class="k">year</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">trips_mergetree</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">passenger_count</span><span class="p">,</span> <span class="k">year</span>
</pre></div>


<p>2.104 seconds.</p>
<p>Q4:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">passenger_count</span><span class="p">,</span> <span class="n">toYear</span><span class="p">(</span><span class="n">pickup_date</span><span class="p">)</span> <span class="k">AS</span> <span class="k">year</span><span class="p">,</span> <span class="n">round</span><span class="p">(</span><span class="n">trip_distance</span><span class="p">)</span> <span class="k">AS</span> <span class="n">distance</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">trips_mergetree</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">passenger_count</span><span class="p">,</span> <span class="k">year</span><span class="p">,</span> <span class="n">distance</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">year</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">DESC</span>
</pre></div>


<p>3.593 seconds.</p>
<p>The following server was used:</p>
<p>Two Intel(R) Xeon(R) CPU E5-2650 v2 @ 2.60GHz, 16 physical kernels total,
128 GiB RAM,
8x6 TB HD on hardware RAID-5</p>
<p>Execution time is the best of three runsBut starting from the second run, queries read data from the file system cache. No further caching occurs: the data is read out and processed in each run.</p>
<p>Creating a table on three servers:</p>
<p>On each server:</p>
<div class="codehilite"><pre><span></span>CREATE TABLE default.trips_mergetree_third ( trip_id UInt32,  vendor_id Enum8(&#39;1&#39; = 1, &#39;2&#39; = 2, &#39;CMT&#39; = 3, &#39;VTS&#39; = 4, &#39;DDS&#39; = 5, &#39;B02512&#39; = 10, &#39;B02598&#39; = 11, &#39;B02617&#39; = 12, &#39;B02682&#39; = 13, &#39;B02764&#39; = 14),  pickup_date Date,  pickup_datetime DateTime,  dropoff_date Date,  dropoff_datetime DateTime,  store_and_fwd_flag UInt8,  rate_code_id UInt8,  pickup_longitude Float64,  pickup_latitude Float64,  dropoff_longitude Float64,  dropoff_latitude Float64,  passenger_count UInt8,  trip_distance Float64,  fare_amount Float32,  extra Float32,  mta_tax Float32,  tip_amount Float32,  tolls_amount Float32,  ehail_fee Float32,  improvement_surcharge Float32,  total_amount Float32,  payment_type_ Enum8(&#39;UNK&#39; = 0, &#39;CSH&#39; = 1, &#39;CRE&#39; = 2, &#39;NOC&#39; = 3, &#39;DIS&#39; = 4),  trip_type UInt8,  pickup FixedString(25),  dropoff FixedString(25),  cab_type Enum8(&#39;yellow&#39; = 1, &#39;green&#39; = 2, &#39;uber&#39; = 3),  pickup_nyct2010_gid UInt8,  pickup_ctlabel Float32,  pickup_borocode UInt8,  pickup_boroname Enum8(&#39;&#39; = 0, &#39;Manhattan&#39; = 1, &#39;Bronx&#39; = 2, &#39;Brooklyn&#39; = 3, &#39;Queens&#39; = 4, &#39;Staten Island&#39; = 5),  pickup_ct2010 FixedString(6),  pickup_boroct2010 FixedString(7),  pickup_cdeligibil Enum8(&#39; &#39; = 0, &#39;E&#39; = 1, &#39;I&#39; = 2),  pickup_ntacode FixedString(4),  pickup_ntaname Enum16(&#39;&#39; = 0, &#39;Airport&#39; = 1, &#39;Allerton-Pelham Gardens&#39; = 2, &#39;Annadale-Huguenot-Prince\&#39;s Bay-Eltingville&#39; = 3, &#39;Arden Heights&#39; = 4, &#39;Astoria&#39; = 5, &#39;Auburndale&#39; = 6, &#39;Baisley Park&#39; = 7, &#39;Bath Beach&#39; = 8, &#39;Battery Park City-Lower Manhattan&#39; = 9, &#39;Bay Ridge&#39; = 10, &#39;Bayside-Bayside Hills&#39; = 11, &#39;Bedford&#39; = 12, &#39;Bedford Park-Fordham North&#39; = 13, &#39;Bellerose&#39; = 14, &#39;Belmont&#39; = 15, &#39;Bensonhurst East&#39; = 16, &#39;Bensonhurst West&#39; = 17, &#39;Borough Park&#39; = 18, &#39;Breezy Point-Belle Harbor-Rockaway Park-Broad Channel&#39; = 19, &#39;Briarwood-Jamaica Hills&#39; = 20, &#39;Brighton Beach&#39; = 21, &#39;Bronxdale&#39; = 22, &#39;Brooklyn Heights-Cobble Hill&#39; = 23, &#39;Brownsville&#39; = 24, &#39;Bushwick North&#39; = 25, &#39;Bushwick South&#39; = 26, &#39;Cambria Heights&#39; = 27, &#39;Canarsie&#39; = 28, &#39;Carroll Gardens-Columbia Street-Red Hook&#39; = 29, &#39;Central Harlem North-Polo Grounds&#39; = 30, &#39;Central Harlem South&#39; = 31, &#39;Charleston-Richmond Valley-Tottenville&#39; = 32, &#39;Chinatown&#39; = 33, &#39;Claremont-Bathgate&#39; = 34, &#39;Clinton&#39; = 35, &#39;Clinton Hill&#39; = 36, &#39;Co-op City&#39; = 37, &#39;College Point&#39; = 38, &#39;Corona&#39; = 39, &#39;Crotona Park East&#39; = 40, &#39;Crown Heights North&#39; = 41, &#39;Crown Heights South&#39; = 42, &#39;Cypress Hills-City Line&#39; = 43, &#39;DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum Hill&#39; = 44, &#39;Douglas Manor-Douglaston-Little Neck&#39; = 45, &#39;Dyker Heights&#39; = 46, &#39;East Concourse-Concourse Village&#39; = 47, &#39;East Elmhurst&#39; = 48, &#39;East Flatbush-Farragut&#39; = 49, &#39;East Flushing&#39; = 50, &#39;East Harlem North&#39; = 51, &#39;East Harlem South&#39; = 52, &#39;East New York&#39; = 53, &#39;East New York (Pennsylvania Ave)&#39; = 54, &#39;East Tremont&#39; = 55, &#39;East Village&#39; = 56, &#39;East Williamsburg&#39; = 57, &#39;Eastchester-Edenwald-Baychester&#39; = 58, &#39;Elmhurst&#39; = 59, &#39;Elmhurst-Maspeth&#39; = 60, &#39;Erasmus&#39; = 61, &#39;Far Rockaway-Bayswater&#39; = 62, &#39;Flatbush&#39; = 63, &#39;Flatlands&#39; = 64, &#39;Flushing&#39; = 65, &#39;Fordham South&#39; = 66, &#39;Forest Hills&#39; = 67, &#39;Fort Greene&#39; = 68, &#39;Fresh Meadows-Utopia&#39; = 69, &#39;Ft. Totten-Bay Terrace-Clearview&#39; = 70, &#39;Georgetown-Marine Park-Bergen Beach-Mill Basin&#39; = 71, &#39;Glen Oaks-Floral Park-New Hyde Park&#39; = 72, &#39;Glendale&#39; = 73, &#39;Gramercy&#39; = 74, &#39;Grasmere-Arrochar-Ft. Wadsworth&#39; = 75, &#39;Gravesend&#39; = 76, &#39;Great Kills&#39; = 77, &#39;Greenpoint&#39; = 78, &#39;Grymes Hill-Clifton-Fox Hills&#39; = 79, &#39;Hamilton Heights&#39; = 80, &#39;Hammels-Arverne-Edgemere&#39; = 81, &#39;Highbridge&#39; = 82, &#39;Hollis&#39; = 83, &#39;Homecrest&#39; = 84, &#39;Hudson Yards-Chelsea-Flatiron-Union Square&#39; = 85, &#39;Hunters Point-Sunnyside-West Maspeth&#39; = 86, &#39;Hunts Point&#39; = 87, &#39;Jackson Heights&#39; = 88, &#39;Jamaica&#39; = 89, &#39;Jamaica Estates-Holliswood&#39; = 90, &#39;Kensington-Ocean Parkway&#39; = 91, &#39;Kew Gardens&#39; = 92, &#39;Kew Gardens Hills&#39; = 93, &#39;Kingsbridge Heights&#39; = 94, &#39;Laurelton&#39; = 95, &#39;Lenox Hill-Roosevelt Island&#39; = 96, &#39;Lincoln Square&#39; = 97, &#39;Lindenwood-Howard Beach&#39; = 98, &#39;Longwood&#39; = 99, &#39;Lower East Side&#39; = 100, &#39;Madison&#39; = 101, &#39;Manhattanville&#39; = 102, &#39;Marble Hill-Inwood&#39; = 103, &#39;Mariner\&#39;s Harbor-Arlington-Port Ivory-Graniteville&#39; = 104, &#39;Maspeth&#39; = 105, &#39;Melrose South-Mott Haven North&#39; = 106, &#39;Middle Village&#39; = 107, &#39;Midtown-Midtown South&#39; = 108, &#39;Midwood&#39; = 109, &#39;Morningside Heights&#39; = 110, &#39;Morrisania-Melrose&#39; = 111, &#39;Mott Haven-Port Morris&#39; = 112, &#39;Mount Hope&#39; = 113, &#39;Murray Hill&#39; = 114, &#39;Murray Hill-Kips Bay&#39; = 115, &#39;New Brighton-Silver Lake&#39; = 116, &#39;New Dorp-Midland Beach&#39; = 117, &#39;New Springville-Bloomfield-Travis&#39; = 118, &#39;North Corona&#39; = 119, &#39;North Riverdale-Fieldston-Riverdale&#39; = 120, &#39;North Side-South Side&#39; = 121, &#39;Norwood&#39; = 122, &#39;Oakland Gardens&#39; = 123, &#39;Oakwood-Oakwood Beach&#39; = 124, &#39;Ocean Hill&#39; = 125, &#39;Ocean Parkway South&#39; = 126, &#39;Old Astoria&#39; = 127, &#39;Old Town-Dongan Hills-South Beach&#39; = 128, &#39;Ozone Park&#39; = 129, &#39;Park Slope-Gowanus&#39; = 130, &#39;Parkchester&#39; = 131, &#39;Pelham Bay-Country Club-City Island&#39; = 132, &#39;Pelham Parkway&#39; = 133, &#39;Pomonok-Flushing Heights-Hillcrest&#39; = 134, &#39;Port Richmond&#39; = 135, &#39;Prospect Heights&#39; = 136, &#39;Prospect Lefferts Gardens-Wingate&#39; = 137, &#39;Queens Village&#39; = 138, &#39;Queensboro Hill&#39; = 139, &#39;Queensbridge-Ravenswood-Long Island City&#39; = 140, &#39;Rego Park&#39; = 141, &#39;Richmond Hill&#39; = 142, &#39;Ridgewood&#39; = 143, &#39;Rikers Island&#39; = 144, &#39;Rosedale&#39; = 145, &#39;Rossville-Woodrow&#39; = 146, &#39;Rugby-Remsen Village&#39; = 147, &#39;Schuylerville-Throgs Neck-Edgewater Park&#39; = 148, &#39;Seagate-Coney Island&#39; = 149, &#39;Sheepshead Bay-Gerritsen Beach-Manhattan Beach&#39; = 150, &#39;SoHo-TriBeCa-Civic Center-Little Italy&#39; = 151, &#39;Soundview-Bruckner&#39; = 152, &#39;Soundview-Castle Hill-Clason Point-Harding Park&#39; = 153, &#39;South Jamaica&#39; = 154, &#39;South Ozone Park&#39; = 155, &#39;Springfield Gardens North&#39; = 156, &#39;Springfield Gardens South-Brookville&#39; = 157, &#39;Spuyten Duyvil-Kingsbridge&#39; = 158, &#39;St. Albans&#39; = 159, &#39;Stapleton-Rosebank&#39; = 160, &#39;Starrett City&#39; = 161, &#39;Steinway&#39; = 162, &#39;Stuyvesant Heights&#39; = 163, &#39;Stuyvesant Town-Cooper Village&#39; = 164, &#39;Sunset Park East&#39; = 165, &#39;Sunset Park West&#39; = 166, &#39;Todt Hill-Emerson Hill-Heartland Village-Lighthouse Hill&#39; = 167, &#39;Turtle Bay-East Midtown&#39; = 168, &#39;University Heights-Morris Heights&#39; = 169, &#39;Upper East Side-Carnegie Hill&#39; = 170, &#39;Upper West Side&#39; = 171, &#39;Van Cortlandt Village&#39; = 172, &#39;Van Nest-Morris Park-Westchester Square&#39; = 173, &#39;Washington Heights North&#39; = 174, &#39;Washington Heights South&#39; = 175, &#39;West Brighton&#39; = 176, &#39;West Concourse&#39; = 177, &#39;West Farms-Bronx River&#39; = 178, &#39;West New Brighton-New Brighton-St. George&#39; = 179, &#39;West Village&#39; = 180, &#39;Westchester-Unionport&#39; = 181, &#39;Westerleigh&#39; = 182, &#39;Whitestone&#39; = 183, &#39;Williamsbridge-Olinville&#39; = 184, &#39;Williamsburg&#39; = 185, &#39;Windsor Terrace&#39; = 186, &#39;Woodhaven&#39; = 187, &#39;Woodlawn-Wakefield&#39; = 188, &#39;Woodside&#39; = 189, &#39;Yorkville&#39; = 190, &#39;park-cemetery-etc-Bronx&#39; = 191, &#39;park-cemetery-etc-Brooklyn&#39; = 192, &#39;park-cemetery-etc-Manhattan&#39; = 193, &#39;park-cemetery-etc-Queens&#39; = 194, &#39;park-cemetery-etc-Staten Island&#39; = 195),  pickup_puma UInt16,  dropoff_nyct2010_gid UInt8,  dropoff_ctlabel Float32,  dropoff_borocode UInt8,  dropoff_boroname Enum8(&#39;&#39; = 0, &#39;Manhattan&#39; = 1, &#39;Bronx&#39; = 2, &#39;Brooklyn&#39; = 3, &#39;Queens&#39; = 4, &#39;Staten Island&#39; = 5),  dropoff_ct2010 FixedString(6),  dropoff_boroct2010 FixedString(7),  dropoff_cdeligibil Enum8(&#39; &#39; = 0, &#39;E&#39; = 1, &#39;I&#39; = 2),  dropoff_ntacode FixedString(4),  dropoff_ntaname Enum16(&#39;&#39; = 0, &#39;Airport&#39; = 1, &#39;Allerton-Pelham Gardens&#39; = 2, &#39;Annadale-Huguenot-Prince\&#39;s Bay-Eltingville&#39; = 3, &#39;Arden Heights&#39; = 4, &#39;Astoria&#39; = 5, &#39;Auburndale&#39; = 6, &#39;Baisley Park&#39; = 7, &#39;Bath Beach&#39; = 8, &#39;Battery Park City-Lower Manhattan&#39; = 9, &#39;Bay Ridge&#39; = 10, &#39;Bayside-Bayside Hills&#39; = 11, &#39;Bedford&#39; = 12, &#39;Bedford Park-Fordham North&#39; = 13, &#39;Bellerose&#39; = 14, &#39;Belmont&#39; = 15, &#39;Bensonhurst East&#39; = 16, &#39;Bensonhurst West&#39; = 17, &#39;Borough Park&#39; = 18, &#39;Breezy Point-Belle Harbor-Rockaway Park-Broad Channel&#39; = 19, &#39;Briarwood-Jamaica Hills&#39; = 20, &#39;Brighton Beach&#39; = 21, &#39;Bronxdale&#39; = 22, &#39;Brooklyn Heights-Cobble Hill&#39; = 23, &#39;Brownsville&#39; = 24, &#39;Bushwick North&#39; = 25, &#39;Bushwick South&#39; = 26, &#39;Cambria Heights&#39; = 27, &#39;Canarsie&#39; = 28, &#39;Carroll Gardens-Columbia Street-Red Hook&#39; = 29, &#39;Central Harlem North-Polo Grounds&#39; = 30, &#39;Central Harlem South&#39; = 31, &#39;Charleston-Richmond Valley-Tottenville&#39; = 32, &#39;Chinatown&#39; = 33, &#39;Claremont-Bathgate&#39; = 34, &#39;Clinton&#39; = 35, &#39;Clinton Hill&#39; = 36, &#39;Co-op City&#39; = 37, &#39;College Point&#39; = 38, &#39;Corona&#39; = 39, &#39;Crotona Park East&#39; = 40, &#39;Crown Heights North&#39; = 41, &#39;Crown Heights South&#39; = 42, &#39;Cypress Hills-City Line&#39; = 43, &#39;DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum Hill&#39; = 44, &#39;Douglas Manor-Douglaston-Little Neck&#39; = 45, &#39;Dyker Heights&#39; = 46, &#39;East Concourse-Concourse Village&#39; = 47, &#39;East Elmhurst&#39; = 48, &#39;East Flatbush-Farragut&#39; = 49, &#39;East Flushing&#39; = 50, &#39;East Harlem North&#39; = 51, &#39;East Harlem South&#39; = 52, &#39;East New York&#39; = 53, &#39;East New York (Pennsylvania Ave)&#39; = 54, &#39;East Tremont&#39; = 55, &#39;East Village&#39; = 56, &#39;East Williamsburg&#39; = 57, &#39;Eastchester-Edenwald-Baychester&#39; = 58, &#39;Elmhurst&#39; = 59, &#39;Elmhurst-Maspeth&#39; = 60, &#39;Erasmus&#39; = 61, &#39;Far Rockaway-Bayswater&#39; = 62, &#39;Flatbush&#39; = 63, &#39;Flatlands&#39; = 64, &#39;Flushing&#39; = 65, &#39;Fordham South&#39; = 66, &#39;Forest Hills&#39; = 67, &#39;Fort Greene&#39; = 68, &#39;Fresh Meadows-Utopia&#39; = 69, &#39;Ft. Totten-Bay Terrace-Clearview&#39; = 70, &#39;Georgetown-Marine Park-Bergen Beach-Mill Basin&#39; = 71, &#39;Glen Oaks-Floral Park-New Hyde Park&#39; = 72, &#39;Glendale&#39; = 73, &#39;Gramercy&#39; = 74, &#39;Grasmere-Arrochar-Ft. Wadsworth&#39; = 75, &#39;Gravesend&#39; = 76, &#39;Great Kills&#39; = 77, &#39;Greenpoint&#39; = 78, &#39;Grymes Hill-Clifton-Fox Hills&#39; = 79, &#39;Hamilton Heights&#39; = 80, &#39;Hammels-Arverne-Edgemere&#39; = 81, &#39;Highbridge&#39; = 82, &#39;Hollis&#39; = 83, &#39;Homecrest&#39; = 84, &#39;Hudson Yards-Chelsea-Flatiron-Union Square&#39; = 85, &#39;Hunters Point-Sunnyside-West Maspeth&#39; = 86, &#39;Hunts Point&#39; = 87, &#39;Jackson Heights&#39; = 88, &#39;Jamaica&#39; = 89, &#39;Jamaica Estates-Holliswood&#39; = 90, &#39;Kensington-Ocean Parkway&#39; = 91, &#39;Kew Gardens&#39; = 92, &#39;Kew Gardens Hills&#39; = 93, &#39;Kingsbridge Heights&#39; = 94, &#39;Laurelton&#39; = 95, &#39;Lenox Hill-Roosevelt Island&#39; = 96, &#39;Lincoln Square&#39; = 97, &#39;Lindenwood-Howard Beach&#39; = 98, &#39;Longwood&#39; = 99, &#39;Lower East Side&#39; = 100, &#39;Madison&#39; = 101, &#39;Manhattanville&#39; = 102, &#39;Marble Hill-Inwood&#39; = 103, &#39;Mariner\&#39;s Harbor-Arlington-Port Ivory-Graniteville&#39; = 104, &#39;Maspeth&#39; = 105, &#39;Melrose South-Mott Haven North&#39; = 106, &#39;Middle Village&#39; = 107, &#39;Midtown-Midtown South&#39; = 108, &#39;Midwood&#39; = 109, &#39;Morningside Heights&#39; = 110, &#39;Morrisania-Melrose&#39; = 111, &#39;Mott Haven-Port Morris&#39; = 112, &#39;Mount Hope&#39; = 113, &#39;Murray Hill&#39; = 114, &#39;Murray Hill-Kips Bay&#39; = 115, &#39;New Brighton-Silver Lake&#39; = 116, &#39;New Dorp-Midland Beach&#39; = 117, &#39;New Springville-Bloomfield-Travis&#39; = 118, &#39;North Corona&#39; = 119, &#39;North Riverdale-Fieldston-Riverdale&#39; = 120, &#39;North Side-South Side&#39; = 121, &#39;Norwood&#39; = 122, &#39;Oakland Gardens&#39; = 123, &#39;Oakwood-Oakwood Beach&#39; = 124, &#39;Ocean Hill&#39; = 125, &#39;Ocean Parkway South&#39; = 126, &#39;Old Astoria&#39; = 127, &#39;Old Town-Dongan Hills-South Beach&#39; = 128, &#39;Ozone Park&#39; = 129, &#39;Park Slope-Gowanus&#39; = 130, &#39;Parkchester&#39; = 131, &#39;Pelham Bay-Country Club-City Island&#39; = 132, &#39;Pelham Parkway&#39; = 133, &#39;Pomonok-Flushing Heights-Hillcrest&#39; = 134, &#39;Port Richmond&#39; = 135, &#39;Prospect Heights&#39; = 136, &#39;Prospect Lefferts Gardens-Wingate&#39; = 137, &#39;Queens Village&#39; = 138, &#39;Queensboro Hill&#39; = 139, &#39;Queensbridge-Ravenswood-Long Island City&#39; = 140, &#39;Rego Park&#39; = 141, &#39;Richmond Hill&#39; = 142, &#39;Ridgewood&#39; = 143, &#39;Rikers Island&#39; = 144, &#39;Rosedale&#39; = 145, &#39;Rossville-Woodrow&#39; = 146, &#39;Rugby-Remsen Village&#39; = 147, &#39;Schuylerville-Throgs Neck-Edgewater Park&#39; = 148, &#39;Seagate-Coney Island&#39; = 149, &#39;Sheepshead Bay-Gerritsen Beach-Manhattan Beach&#39; = 150, &#39;SoHo-TriBeCa-Civic Center-Little Italy&#39; = 151, &#39;Soundview-Bruckner&#39; = 152, &#39;Soundview-Castle Hill-Clason Point-Harding Park&#39; = 153, &#39;South Jamaica&#39; = 154, &#39;South Ozone Park&#39; = 155, &#39;Springfield Gardens North&#39; = 156, &#39;Springfield Gardens South-Brookville&#39; = 157, &#39;Spuyten Duyvil-Kingsbridge&#39; = 158, &#39;St. Albans&#39; = 159, &#39;Stapleton-Rosebank&#39; = 160, &#39;Starrett City&#39; = 161, &#39;Steinway&#39; = 162, &#39;Stuyvesant Heights&#39; = 163, &#39;Stuyvesant Town-Cooper Village&#39; = 164, &#39;Sunset Park East&#39; = 165, &#39;Sunset Park West&#39; = 166, &#39;Todt Hill-Emerson Hill-Heartland Village-Lighthouse Hill&#39; = 167, &#39;Turtle Bay-East Midtown&#39; = 168, &#39;University Heights-Morris Heights&#39; = 169, &#39;Upper East Side-Carnegie Hill&#39; = 170, &#39;Upper West Side&#39; = 171, &#39;Van Cortlandt Village&#39; = 172, &#39;Van Nest-Morris Park-Westchester Square&#39; = 173, &#39;Washington Heights North&#39; = 174, &#39;Washington Heights South&#39; = 175, &#39;West Brighton&#39; = 176, &#39;West Concourse&#39; = 177, &#39;West Farms-Bronx River&#39; = 178, &#39;West New Brighton-New Brighton-St. George&#39; = 179, &#39;West Village&#39; = 180, &#39;Westchester-Unionport&#39; = 181, &#39;Westerleigh&#39; = 182, &#39;Whitestone&#39; = 183, &#39;Williamsbridge-Olinville&#39; = 184, &#39;Williamsburg&#39; = 185, &#39;Windsor Terrace&#39; = 186, &#39;Woodhaven&#39; = 187, &#39;Woodlawn-Wakefield&#39; = 188, &#39;Woodside&#39; = 189, &#39;Yorkville&#39; = 190, &#39;park-cemetery-etc-Bronx&#39; = 191, &#39;park-cemetery-etc-Brooklyn&#39; = 192, &#39;park-cemetery-etc-Manhattan&#39; = 193, &#39;park-cemetery-etc-Queens&#39; = 194, &#39;park-cemetery-etc-Staten Island&#39; = 195),  dropoff_puma UInt16) ENGINE = MergeTree(pickup_date, pickup_datetime, 8192)
</pre></div>


<p>On the source server:</p>
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">trips_mergetree_x3</span> <span class="k">AS</span> <span class="n">trips_mergetree_third</span> <span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Distributed</span><span class="p">(</span><span class="n">perftest</span><span class="p">,</span> <span class="k">default</span><span class="p">,</span> <span class="n">trips_mergetree_third</span><span class="p">,</span> <span class="n">rand</span><span class="p">())</span>
</pre></div>


<p>The following query redistributes data:</p>
<div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">trips_mergetree_x3</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">trips_mergetree</span>
</pre></div>


<p>This takes 2454 seconds.</p>
<p>On three servers:</p>
<p>Q1: 0.212 seconds.
Q2: 0.438 seconds.
Q3: 0.733 seconds.
Q4: 1.241 seconds.</p>
<p>No surprises here, since the queries are scaled linearly.</p>
<p>We also have results from a cluster of 140 servers:</p>
<p>Q1: 0.028 sec.
Q2: 0.043 sec.
Q3: 0.051 sec.
Q4: 0.072 sec.</p>
<p>In this case, the query processing time is determined above all by network latency.
We ran queries using a client located in a Yandex datacenter in Finland on a cluster in Russia, which added about 20 ms of latency.</p>
<h2 id="summary">Summary</h2>
<div class="codehilite"><pre><span></span>nodes   Q1     Q2     Q3     Q4
  1  0.490  1.224  2.104  3.593
  3  0.212  0.438  0.733  1.241
140  0.028  0.043  0.051  0.072
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ontime/" title="OnTime" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                OnTime
              </span>
            </div>
          </a>
        
        
          <a href="../amplab_benchmark/" title="AMPLab Big Data Benchmark" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                AMPLab Big Data Benchmark
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            ©2016–2018 Yandex LLC
          </div>
        
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.5165553b.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../../.."}})</script>
      
    
    
      
    
  </body>
</html>