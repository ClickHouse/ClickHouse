<test>
    <type>once</type>

    <stop_conditions>
        <all_of>
            <total_time_ms>30000</total_time_ms>
        </all_of>
    </stop_conditions>

    <settings>
        <max_threads>1</max_threads>
    </settings>

    <substitutions>
        <substitution>
           <name>aggregationscale</name>
           <values>
               <value>11111111</value>
               <value>11111</value>
           </values>
       </substitution>
       <substitution>
          <name>tableorder</name>
          <values>
              <value>tuple()</value>
              <value>(key,value)</value>
          </values>
      </substitution>
    </substitutions>

    <create_query>
        create table mingroupby_orderbylimit1_{aggregationscale}_{tableorder}
        Engine=MergeTree order by {tableorder} AS
        select toUInt64( number % {aggregationscale} ) key, toUInt64(1) value
        from numbers(10000000);
    </create_query>

    <query tag='UsingGroupbyMin'>
         SELECT key, min(value)
         FROM mingroupby_orderbylimit1_{aggregationscale}_{tableorder}
         group by key format Null;
    </query>

    <query tag='UsingOrderbyLimit1'>
         SELECT key, value
         FROM mingroupby_orderbylimit1_{aggregationscale}_{tableorder}
         order by key, value limit 1 by key format Null;
     </query>

     <drop_query> DROP TABLE IF EXISTS mingroupby_orderbylimit1_{aggregationscale}_{tableorder} </drop_query>
</test>
