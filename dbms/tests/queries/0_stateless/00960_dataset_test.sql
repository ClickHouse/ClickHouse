-- CREATE DATABASE IF NOT EXISTS test;
-- DROP TABLE IF EXISTS test.trainset;
-- CREATE TABLE IF NOT EXISTS test.trainset
-- (
--     param1 Float64, param2 Float64, param3 Float64, param4 Float64, param5 Float64, param6 Float64, param7 Float64, param8 Float64, param9 Float64, param10 Float64, param11 Float64, param12 Float64, param13 Float64, param14 Float64, param15 Float64, param16 Float64, param17 Float64, param18 Float64, param19 Float64, param20 Float64, param21 Float64, param22 Float64, param23 Float64, param24 Float64, param25 Float64, param26 Float64, param27 Float64, param28 Float64, param29 Float64, param30 Float64, param31 Float64, param32 Float64, param33 Float64, param34 Float64, param35 Float64, param36 Float64, param37 Float64, param38 Float64, param39 Float64, param40 Float64, param41 Float64, param42 Float64, param43 Float64, param44 Float64, param45 Float64, param46 Float64, param47 Float64, param48 Float64, param49 Float64, param50 Float64, param51 Float64, param52 Float64, param53 Float64, param54 Float64, param55 Float64, param56 Float64, param57 Float64, param58 Float64, param59 Float64, param60 Float64, param61 Float64, param62 Float64, param63 Float64, param64 Float64, param65 Float64, param66 Float64, param67 Float64, param68 Float64, param69 Float64, param70 Float64, param71 Float64, param72 Float64, param73 Float64, param74 Float64, param75 Float64, param76 Float64, param77 Float64, param78 Float64, param79 Float64, param80 Float64, param81 Float64, param82 Float64, param83 Float64, param84 Float64, param85 Float64, param86 Float64, param87 Float64, param88 Float64, param89 Float64, param90 Float64, param91 Float64, param92 Float64, param93 Float64, param94 Float64, param95 Float64, param96 Float64, param97 Float64, param98 Float64, param99 Float64, param100 Float64, param101 Float64, param102 Float64, param103 Float64, param104 Float64, param105 Float64, param106 Float64, param107 Float64, param108 Float64, param109 Float64, param110 Float64, param111 Float64, param112 Float64, param113 Float64, param114 Float64, param115 Float64, param116 Float64, param117 Float64, param118 Float64, param119 Float64, param120 Float64, param121 Float64, param122 Float64, param123 Float64, param124 Float64, param125 Float64, param126 Float64, param127 Float64, param128 Float64, param129 Float64, param130 Float64, param131 Float64, param132 Float64, param133 Float64, param134 Float64, param135 Float64, param136 Float64, param137 Float64, param138 Float64, param139 Float64, param140 Float64, param141 Float64, param142 Float64, param143 Float64, param144 Float64, param145 Float64, param146 Float64, param147 Float64, param148 Float64, param149 Float64, param150 Float64, param151 Float64, param152 Float64, param153 Float64, param154 Float64, param155 Float64, param156 Float64, param157 Float64, param158 Float64, param159 Float64, param160 Float64, param161 Float64, param162 Float64, param163 Float64, param164 Float64, param165 Float64, param166 Float64, param167 Float64, param168 Float64, param169 Float64, param170 Float64, param171 Float64, param172 Float64, param173 Float64, param174 Float64, param175 Float64, param176 Float64, param177 Float64, param178 Float64, param179 Float64, param180 Float64, param181 Float64, param182 Float64, param183 Float64, target Float64
-- ) ENGINE = Memory;
-- DROP TABLE IF EXISTS test.testset;
-- CREATE TABLE IF NOT EXISTS test.testset
-- (
--     param1 Float64, param2 Float64, param3 Float64, param4 Float64, param5 Float64, param6 Float64, param7 Float64, param8 Float64, param9 Float64, param10 Float64, param11 Float64, param12 Float64, param13 Float64, param14 Float64, param15 Float64, param16 Float64, param17 Float64, param18 Float64, param19 Float64, param20 Float64, param21 Float64, param22 Float64, param23 Float64, param24 Float64, param25 Float64, param26 Float64, param27 Float64, param28 Float64, param29 Float64, param30 Float64, param31 Float64, param32 Float64, param33 Float64, param34 Float64, param35 Float64, param36 Float64, param37 Float64, param38 Float64, param39 Float64, param40 Float64, param41 Float64, param42 Float64, param43 Float64, param44 Float64, param45 Float64, param46 Float64, param47 Float64, param48 Float64, param49 Float64, param50 Float64, param51 Float64, param52 Float64, param53 Float64, param54 Float64, param55 Float64, param56 Float64, param57 Float64, param58 Float64, param59 Float64, param60 Float64, param61 Float64, param62 Float64, param63 Float64, param64 Float64, param65 Float64, param66 Float64, param67 Float64, param68 Float64, param69 Float64, param70 Float64, param71 Float64, param72 Float64, param73 Float64, param74 Float64, param75 Float64, param76 Float64, param77 Float64, param78 Float64, param79 Float64, param80 Float64, param81 Float64, param82 Float64, param83 Float64, param84 Float64, param85 Float64, param86 Float64, param87 Float64, param88 Float64, param89 Float64, param90 Float64, param91 Float64, param92 Float64, param93 Float64, param94 Float64, param95 Float64, param96 Float64, param97 Float64, param98 Float64, param99 Float64, param100 Float64, param101 Float64, param102 Float64, param103 Float64, param104 Float64, param105 Float64, param106 Float64, param107 Float64, param108 Float64, param109 Float64, param110 Float64, param111 Float64, param112 Float64, param113 Float64, param114 Float64, param115 Float64, param116 Float64, param117 Float64, param118 Float64, param119 Float64, param120 Float64, param121 Float64, param122 Float64, param123 Float64, param124 Float64, param125 Float64, param126 Float64, param127 Float64, param128 Float64, param129 Float64, param130 Float64, param131 Float64, param132 Float64, param133 Float64, param134 Float64, param135 Float64, param136 Float64, param137 Float64, param138 Float64, param139 Float64, param140 Float64, param141 Float64, param142 Float64, param143 Float64, param144 Float64, param145 Float64, param146 Float64, param147 Float64, param148 Float64, param149 Float64, param150 Float64, param151 Float64, param152 Float64, param153 Float64, param154 Float64, param155 Float64, param156 Float64, param157 Float64, param158 Float64, param159 Float64, param160 Float64, param161 Float64, param162 Float64, param163 Float64, param164 Float64, param165 Float64, param166 Float64, param167 Float64, param168 Float64, param169 Float64, param170 Float64, param171 Float64, param172 Float64, param173 Float64, param174 Float64, param175 Float64, param176 Float64, param177 Float64, param178 Float64, param179 Float64, param180 Float64, param181 Float64, param182 Float64, param183 Float64
-- ) ENGINE = Memory;

SET send_logs_level = 'trace';
-- SET log_queries = 1;
-- SET max_threads = 4;

-- drop table if exists test.model;
-- create table if not exists test.model engine = Memory as select LinearRegressionState(0.0000001, 4, 2.0)(target, param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13, param14, param15, param16, param17, param18, param19, param20, param21, param22, param23, param24, param25, param26, param27, param28, param29, param30, param31, param32, param33, param34, param35, param36, param37, param38, param39, param40, param41, param42, param43, param44, param45, param46, param47, param48, param49, param50, param51, param52, param53, param54, param55, param56, param57, param58, param59, param60, param61, param62, param63, param64, param65, param66, param67, param68, param69, param70, param71, param72, param73, param74, param75, param76, param77, param78, param79, param80, param81, param82, param83, param84, param85, param86, param87, param88, param89, param90, param91, param92, param93, param94, param95, param96, param97, param98, param99, param100, param101, param102, param103, param104, param105, param106, param107, param108, param109, param110, param111, param112, param113, param114, param115, param116, param117, param118, param119, param120, param121, param122, param123, param124, param125, param126, param127, param128, param129, param130, param131, param132, param133, param134, param135, param136, param137, param138, param139, param140, param141, param142, param143, param144, param145, param146, param147, param148, param149, param150, param151, param152, param153, param154, param155, param156, param157, param158, param159, param160, param161, param162, param163, param164, param165, param166, param167, param168, param169, param170, param171, param172, param173, param174, param175, param176, param177, param178, param179, param180, param181, param182, param183) as state from test.trainset;

select LinearRegressionState(0.0000001, 4, 2.0)(target, param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13, param14, param15, param16, param17, param18, param19, param20, param21, param22, param23, param24, param25, param26, param27, param28, param29, param30, param31, param32, param33, param34, param35, param36, param37, param38, param39, param40, param41, param42, param43, param44, param45, param46, param47, param48, param49, param50, param51, param52, param53, param54, param55, param56, param57, param58, param59, param60, param61, param62, param63, param64, param65, param66, param67, param68, param69, param70, param71, param72, param73, param74, param75, param76, param77, param78, param79, param80, param81, param82, param83, param84, param85, param86, param87, param88, param89, param90, param91, param92, param93, param94, param95, param96, param97, param98, param99, param100, param101, param102, param103, param104, param105, param106, param107, param108, param109, param110, param111, param112, param113, param114, param115, param116, param117, param118, param119, param120, param121, param122, param123, param124, param125, param126, param127, param128, param129, param130, param131, param132, param133, param134, param135, param136, param137, param138, param139, param140, param141, param142, param143, param144, param145, param146, param147, param148, param149, param150, param151, param152, param153, param154, param155, param156, param157, param158, param159, param160, param161, param162, param163, param164, param165, param166, param167, param168, param169, param170, param171, param172, param173, param174, param175, param176, param177, param178, param179, param180, param181, param182, param183) from test.trainset;

-- with (select state from test.model) as model select evalMLMethod(model, param1, param2, param3, param4, param5, param6, param7, param8, param9, param10, param11, param12, param13, param14, param15, param16, param17, param18, param19, param20, param21, param22, param23, param24, param25, param26, param27, param28, param29, param30, param31, param32, param33, param34, param35, param36, param37, param38, param39, param40, param41, param42, param43, param44, param45, param46, param47, param48, param49, param50, param51, param52, param53, param54, param55, param56, param57, param58, param59, param60, param61, param62, param63, param64, param65, param66, param67, param68, param69, param70, param71, param72, param73, param74, param75, param76, param77, param78, param79, param80, param81, param82, param83, param84, param85, param86, param87, param88, param89, param90, param91, param92, param93, param94, param95, param96, param97, param98, param99, param100, param101, param102, param103, param104, param105, param106, param107, param108, param109, param110, param111, param112, param113, param114, param115, param116, param117, param118, param119, param120, param121, param122, param123, param124, param125, param126, param127, param128, param129, param130, param131, param132, param133, param134, param135, param136, param137, param138, param139, param140, param141, param142, param143, param144, param145, param146, param147, param148, param149, param150, param151, param152, param153, param154, param155, param156, param157, param158, param159, param160, param161, param162, param163, param164, param165, param166, param167, param168, param169, param170, param171, param172, param173, param174, param175, param176, param177, param178, param179, param180, param181, param182, param183) from test.testset;