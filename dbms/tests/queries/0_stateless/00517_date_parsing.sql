SELECT toDate(s) FROM (SELECT arrayJoin(['2017-01-02', '2017-1-02', '2017-01-2', '2017-1-2', '2017/01/02', '2017/1/02', '2017/01/2', '2017/1/2', '2017-11-12']) AS s);

DROP TABLE IF EXISTS test.date;
CREATE TABLE test.date (d Date) ENGINE = Memory;

INSERT INTO test.date VALUES ('2017-01-02'), ('2017-1-02'), ('2017-01-2'), ('2017-1-2'), ('2017/01/02'), ('2017/1/02'), ('2017/01/2'), ('2017/1/2'), ('2017-11-12');
SELECT * FROM test.date;

INSERT INTO test.date FORMAT JSONEachRow {"d": "2017-01-02"}, {"d": "2017-1-02"}, {"d": "2017-01-2"}, {"d": "2017-1-2"}, {"d": "2017/01/02"}, {"d": "2017/1/02"}, {"d": "2017/01/2"}, {"d": "2017/1/2"}, {"d": "2017-11-12"};
SELECT * FROM test.date ORDER BY d;

DROP TABLE test.date;

WITH toDate('2000-01-01') + rand() % (30000) AS EventDate SELECT * FROM numbers(1000000) WHERE EventDate != toDate(concat(toString(toYear(EventDate)), '-', toString(toMonth(EventDate)), '-', toString(toDayOfMonth(EventDate))));

SELECT toDateTime(s) FROM (SELECT arrayJoin(['2017-01-02 03:04:05', '2017-1-02 03:04:05', '2017-01-2 03:04:05', '2017-1-2 03:04:05', '2017-01-02 3:04:05', '2017-1-02 3:04:05', '2017-01-2 3:04:05', '2017-1-2 3:04:05', '2017-01-02 03:4:05', '2017-1-02 03:4:05', '2017-01-2 03:4:05', '2017-1-2 03:4:05', '2017-01-02 03:04:5', '2017-1-02 03:04:5', '2017-01-2 03:04:5', '2017-1-2 03:04:5', '2017-01-02 3:4:05', '2017-1-02 3:4:05', '2017-01-2 3:4:05', '2017-1-2 3:4:05', '2017-01-02 3:04:5', '2017-1-02 3:04:5', '2017-01-2 3:04:5', '2017-1-2 3:04:5', '2017-01-02 03:4:5', '2017-1-02 03:4:5', '2017-01-2 03:4:5', '2017-1-2 03:4:5', '2017-01-02 3:4:5', '2017-1-02 3:4:5', '2017-01-2 3:4:5', '2017-1-2 3:4:5']) AS s);

DROP TABLE IF EXISTS test.datetime;
CREATE TABLE test.datetime (d DateTime) ENGINE = Memory;

INSERT INTO test.datetime VALUES ('2017-01-02 03:04:05'), ('2017-1-02 03:04:05'), ('2017-01-2 03:04:05'), ('2017-1-2 03:04:05'), ('2017-01-02 3:04:05'), ('2017-1-02 3:04:05'), ('2017-01-2 3:04:05'), ('2017-1-2 3:04:05'), ('2017-01-02 03:4:05'), ('2017-1-02 03:4:05'), ('2017-01-2 03:4:05'), ('2017-1-2 03:4:05'), ('2017-01-02 03:04:5'), ('2017-1-02 03:04:5'), ('2017-01-2 03:04:5'), ('2017-1-2 03:04:5'), ('2017-01-02 3:4:05'), ('2017-1-02 3:4:05'), ('2017-01-2 3:4:05'), ('2017-1-2 3:4:05'), ('2017-01-02 3:04:5'), ('2017-1-02 3:04:5'), ('2017-01-2 3:04:5'), ('2017-1-2 3:04:5'), ('2017-01-02 03:4:5'), ('2017-1-02 03:4:5'), ('2017-01-2 03:4:5'), ('2017-1-2 03:4:5'), ('2017-01-02 3:4:5'), ('2017-1-02 3:4:5'), ('2017-01-2 3:4:5'), ('2017-1-2 3:4:5');
SELECT * FROM test.datetime;

INSERT INTO test.datetime FORMAT JSONEachRow {"d": "2017-01-02 03:04:05"}, {"d": "2017-1-02 03:04:05"}, {"d": "2017-01-2 03:04:05"}, {"d": "2017-1-2 03:04:05"}, {"d": "2017-01-02 3:04:05"}, {"d": "2017-1-02 3:04:05"}, {"d": "2017-01-2 3:04:05"}, {"d": "2017-1-2 3:04:05"}, {"d": "2017-01-02 03:4:05"}, {"d": "2017-1-02 03:4:05"}, {"d": "2017-01-2 03:4:05"}, {"d": "2017-1-2 03:4:05"}, {"d": "2017-01-02 03:04:5"}, {"d": "2017-1-02 03:04:5"}, {"d": "2017-01-2 03:04:5"}, {"d": "2017-1-2 03:04:5"}, {"d": "2017-01-02 3:4:05"}, {"d": "2017-1-02 3:4:05"}, {"d": "2017-01-2 3:4:05"}, {"d": "2017-1-2 3:4:05"}, {"d": "2017-01-02 3:04:5"}, {"d": "2017-1-02 3:04:5"}, {"d": "2017-01-2 3:04:5"}, {"d": "2017-1-2 3:04:5"}, {"d": "2017-01-02 03:4:5"}, {"d": "2017-1-02 03:4:5"}, {"d": "2017-01-2 03:4:5"}, {"d": "2017-1-2 03:4:5"}, {"d": "2017-01-02 3:4:5"}, {"d": "2017-1-02 3:4:5"}, {"d": "2017-01-2 3:4:5"}, {"d": "2017-1-2 3:4:5"};
SELECT * FROM test.datetime ORDER BY d;

DROP TABLE test.datetime;

WITH toDateTime('2000-01-02 03:04:05') + rand() % (100000000) AS EventDateTime SELECT * FROM numbers(1000000) WHERE EventDateTime != toDateTime(concat(toString(toYear(EventDateTime)), '-', toString(toMonth(EventDateTime)), '-', toString(toDayOfMonth(EventDateTime)), ' ', toString(toHour(EventDateTime)), ':', toString(toMinute(EventDateTime)),  ':', toString(toSecond(EventDateTime))));
