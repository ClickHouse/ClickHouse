version: '2.3'
services:
    mysql80:
        image: mysql:8.0
        restart: always
        environment:
            MYSQL_ROOT_PASSWORD: clickhouse
            MYSQL_ROOT_HOST: ${MYSQL_ROOT_HOST}
            DATADIR: /mysql/
        expose:
            - ${MYSQL8_PORT}
        command: --server_id=100 --log-bin='mysql-bin-1.log' 
            --default_authentication_plugin='mysql_native_password' 
            --default-time-zone='+3:00' --gtid-mode="ON" 
            --enforce-gtid-consistency
            --log-error-verbosity=3
            --log-error=/mysql/error.log
            --general-log=ON
            --general-log-file=/mysql/general.log
        volumes:
            - type: ${MYSQL8_LOGS_FS:-tmpfs}
              source: ${MYSQL8_LOGS:-}
              target: /mysql/