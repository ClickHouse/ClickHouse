<?xml version="1.0"?>
<!-- Config for test server -->
<yandex>
    <query_masking_rules>
        <!-- An example of query masking rule to remove profanity.
             This is an example for developers. Practical examples will include something like masking of SSN or credit card numbers.
          -->
        <rule>
            <name>profanity</name>
            <regexp>(?i:shit)</regexp>
            <replace>substance</replace>
        </rule>
        <!-- This rule is used in tests. -->
        <rule>
            <regexp>TOPSECRET.TOPSECRET</regexp>
            <replace>[hidden]</replace>
        </rule>

        <rule>
            <name>hide encrypt/decrypt arguments</name>
            <regexp>((?:aes_)?(?:encrypt|decrypt)(?:_mysql)?)\s*\(\s*(?:'(?:\\'|.)+'|.*?)\s*\)</regexp>
            <!-- or more secure, but also more invasive:
                (aes_\w+)\s*\(.*\)
            -->
            <replace>\1(???)</replace>
        </rule>
    </query_masking_rules>
</yandex>
